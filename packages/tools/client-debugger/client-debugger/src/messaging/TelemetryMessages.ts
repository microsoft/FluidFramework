/*!
 * Copyright (c) Microsoft Corporation and contributors. All rights reserved.
 * Licensed under the MIT License.
 */

import { ITelemetryBaseEvent } from "@fluidframework/common-definitions";
import { IDebuggerMessage } from "./Messages";

// #region Outbound messages

/**
 * Interface for telemetry events with a timestamp. Specific to the Fluid Debugger.
 *
 * @public
 */
export interface ITimestampedTelemetryEvent {
	/**
	 * The contents of the telemetry event.
	 */
	logContent: ITelemetryBaseEvent;

	/**
	 * The timestamp at which the event was logged. {@link Date#now}. i.e. MM/DD/YYYY, HH:MM:SS AM/PM.
	 */
	timestamp: number;
}

/**
 * {@link TelemetryEventMessage} {@link IDebuggerMessage."type"}.
 *
 * @public
 */
export const TelemetryEventMessageType = "TELEMETRY_EVENT";

/**
 * Message data format used by {@link TelemetryEventMessage}.
 *
 * @public
 */
export interface TelemetryEventMessageData {
	/**
	 * Contents of the telemetry event. This can be a single latest event or all the history events.
	 */
	contents: ITimestampedTelemetryEvent[];
}

/**
 * {@link TelemetryHistoryMessage} {@link IDebuggerMessage."type"}.
 *
 * @public
 */
export const TelemetryHistoryMessageType = "TELEMETRY_HISTORY";

/**
 * Outbound event indicating that a telemetry event has been generated by the application.
 * Includes the contents of the telemetry event.
 *
 * @public
 */
export interface TelemetryEventMessage extends IDebuggerMessage<TelemetryEventMessageData> {
	/**
	 * {@inheritDoc IDebuggerMessage."type"}
	 */
	type: typeof TelemetryEventMessageType;
}

/**
 * Outbound message including the entire history of telemetry events.
 *
 * @public
 */
export interface TelemetryHistoryMessage extends IDebuggerMessage<TelemetryEventMessageData> {
	/**
	 * {@inheritDoc IDebuggerMessage."type"}
	 */
	type: typeof TelemetryHistoryMessageType;
}

/**
 * {@link GetTelemetryHistoryMessage} {@link IDebuggerMessage."type"}.
 *
 * @public
 */
export const GetTelemetryHistoryMessageType = "GET_TELEMETRY_HISTORY";

/**
 * Inbound message requesting a complete history of telemetry events.
 *
 * @public
 */
export interface GetTelemetryHistoryMessage extends IDebuggerMessage {
	/**
	 * {@inheritDoc IDebuggerMessage."type"}
	 */
	type: typeof GetTelemetryHistoryMessageType;
}
// #endregion
