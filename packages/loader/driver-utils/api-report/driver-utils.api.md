## API Report File for "@fluidframework/driver-utils"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { FetchSource } from '@fluidframework/driver-definitions';
import { IAttachment } from '@fluidframework/protocol-definitions';
import { IAuthorizationError } from '@fluidframework/driver-definitions';
import { IBlob } from '@fluidframework/protocol-definitions';
import { ICommittedProposal } from '@fluidframework/protocol-definitions';
import { ICreateBlobResponse } from '@fluidframework/protocol-definitions';
import { IDeltasFetchResult } from '@fluidframework/driver-definitions';
import { IDocumentAttributes } from '@fluidframework/protocol-definitions';
import { IDocumentMessage } from '@fluidframework/protocol-definitions';
import { IDocumentServiceFactory } from '@fluidframework/driver-definitions';
import { IDocumentStorageService } from '@fluidframework/driver-definitions';
import { IDocumentStorageServicePolicies } from '@fluidframework/driver-definitions';
import { IDriverErrorBase } from '@fluidframework/driver-definitions';
import { IFluidErrorBase } from '@fluidframework/telemetry-utils';
import { ILocationRedirectionError } from '@fluidframework/driver-definitions';
import { IRequest } from '@fluidframework/core-interfaces';
import { IResolvedUrl } from '@fluidframework/driver-definitions';
import { ISequencedDocumentMessage } from '@fluidframework/protocol-definitions';
import { ISnapshotTree } from '@fluidframework/protocol-definitions';
import { IStream } from '@fluidframework/driver-definitions';
import { IStreamResult } from '@fluidframework/driver-definitions';
import { ISummaryContext } from '@fluidframework/driver-definitions';
import { ISummaryHandle } from '@fluidframework/protocol-definitions';
import { ISummaryTree } from '@fluidframework/protocol-definitions';
import { ITelemetryErrorEvent } from '@fluidframework/core-interfaces';
import { ITelemetryLoggerExt } from '@fluidframework/telemetry-utils';
import { ITelemetryProperties } from '@fluidframework/core-interfaces';
import { IThrottlingWarning } from '@fluidframework/driver-definitions';
import { ITree } from '@fluidframework/protocol-definitions';
import { ITreeEntry } from '@fluidframework/protocol-definitions';
import { IUrlResolver } from '@fluidframework/driver-definitions';
import { IVersion } from '@fluidframework/protocol-definitions';
import { LoaderCachingPolicy } from '@fluidframework/driver-definitions';
import { LoggingError } from '@fluidframework/telemetry-utils';

// @public
export function applyStorageCompression(documentServiceFactory: IDocumentServiceFactory, config?: ICompressionStorageConfig | boolean): IDocumentServiceFactory;

// @public
export class AttachmentTreeEntry {
    constructor(path: string, id: string);
    // (undocumented)
    readonly id: string;
    // (undocumented)
    readonly mode = FileMode.File;
    // (undocumented)
    readonly path: string;
    // (undocumented)
    readonly type = TreeEntry.Attachment;
    // (undocumented)
    readonly value: IAttachment;
}

// @public (undocumented)
export class AuthorizationError extends LoggingError implements IAuthorizationError, IFluidErrorBase {
    constructor(message: string, claims: string | undefined, tenantId: string | undefined, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry = false;
    // (undocumented)
    readonly claims: string | undefined;
    // (undocumented)
    readonly errorType = DriverErrorType.authorizationError;
    // (undocumented)
    readonly tenantId: string | undefined;
}

// @public (undocumented)
export const blobHeadersBlobName = ".metadata.blobHeaders";

// @public
export class BlobTreeEntry {
    constructor(path: string, contents: string, encoding?: "utf-8" | "base64");
    // (undocumented)
    readonly mode = FileMode.File;
    // (undocumented)
    readonly path: string;
    // (undocumented)
    readonly type = TreeEntry.Blob;
    // (undocumented)
    readonly value: IBlob;
}

// @public
export function buildSnapshotTree(entries: ITreeEntry[], blobMap: Map<string, ArrayBufferLike>): ISnapshotTree;

// @public
export function calculateMaxWaitTime(delayMs: number, error: unknown): number;

// @public (undocumented)
export function canBeCoalescedByService(message: ISequencedDocumentMessage | IDocumentMessage): boolean;

// @public
export const canRetryOnError: (error: any) => boolean;

// @internal
export interface CombinedAppAndProtocolSummary extends ISummaryTree {
    // (undocumented)
    tree: {
        [".app"]: ISummaryTree;
        [".protocol"]: ISummaryTree;
    };
}

// @public
export function convertSummaryTreeToSnapshotITree(summaryTree: ISummaryTree): ITree;

// @public (undocumented)
export function createGenericNetworkError(message: string, retryInfo: {
    canRetry: boolean;
    retryAfterMs?: number;
}, props: DriverErrorTelemetryProps): ThrottlingError | GenericNetworkError;

// @public (undocumented)
export const createWriteError: (message: string, props: DriverErrorTelemetryProps) => NonRetryableError<"writeError">;

// @public (undocumented)
export class DeltaStreamConnectionForbiddenError extends LoggingError implements IDriverErrorBase, IFluidErrorBase {
    constructor(message: string, props: DriverErrorTelemetryProps, storageOnlyReason?: string);
    // (undocumented)
    readonly canRetry = false;
    // (undocumented)
    static readonly errorType = DriverErrorType.deltaStreamConnectionForbidden;
    // (undocumented)
    readonly errorType = DriverErrorType.deltaStreamConnectionForbidden;
    // (undocumented)
    readonly storageOnlyReason: string | undefined;
}

// @public (undocumented)
export class DocumentStorageServiceProxy implements IDocumentStorageService {
    constructor(internalStorageService: IDocumentStorageService);
    // (undocumented)
    createBlob(file: ArrayBufferLike): Promise<ICreateBlobResponse>;
    // (undocumented)
    downloadSummary(handle: ISummaryHandle): Promise<ISummaryTree>;
    // (undocumented)
    getSnapshotTree(version?: IVersion, scenarioName?: string): Promise<ISnapshotTree | null>;
    // (undocumented)
    getVersions(versionId: string | null, count: number, scenarioName?: string, fetchSource?: FetchSource): Promise<IVersion[]>;
    // (undocumented)
    protected readonly internalStorageService: IDocumentStorageService;
    set policies(policies: IDocumentStorageServicePolicies | undefined);
    // (undocumented)
    get policies(): IDocumentStorageServicePolicies | undefined;
    // (undocumented)
    readBlob(blobId: string): Promise<ArrayBufferLike>;
    // (undocumented)
    get repositoryUrl(): string;
    // (undocumented)
    uploadSummaryWithContext(summary: ISummaryTree, context: ISummaryContext): Promise<string>;
}

// @public
export type DriverErrorTelemetryProps = ITelemetryProperties & {
    driverVersion: string | undefined;
};

// @public (undocumented)
export const emptyMessageStream: IStream<ISequencedDocumentMessage[]>;

// @public
export class FluidInvalidSchemaError extends LoggingError implements IDriverErrorBase, IFluidErrorBase {
    constructor(message: string, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry = false;
    // (undocumented)
    readonly errorType = DriverErrorType.fluidInvalidSchema;
}

// @public
export class GenericNetworkError extends LoggingError implements IDriverErrorBase, IFluidErrorBase {
    constructor(message: string, canRetry: boolean, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry: boolean;
    // (undocumented)
    readonly errorType = DriverErrorType.genericNetworkError;
}

// @public
export function getDocAttributesFromProtocolSummary(protocolSummary: ISummaryTree): IDocumentAttributes;

// @public
export function getQuorumValuesFromProtocolSummary(protocolSummary: ISummaryTree): [string, ICommittedProposal][];

// @public
export const getRetryDelayFromError: (error: any) => number | undefined;

// @public
export const getRetryDelaySecondsFromError: (error: any) => number | undefined;

// @public (undocumented)
export interface ICompressionStorageConfig {
    // (undocumented)
    algorithm: SummaryCompressionAlgorithm;
    // (undocumented)
    minSizeToCompress: number;
}

// @public
export class InsecureUrlResolver implements IUrlResolver {
    constructor(hostUrl: string, ordererUrl: string, storageUrl: string, tenantId: string, bearer: string, isForNodeTest?: boolean);
    // (undocumented)
    createCreateNewRequest(fileName?: string): IRequest;
    // (undocumented)
    getAbsoluteUrl(resolvedUrl: IResolvedUrl, relativeUrl: string): Promise<string>;
    // (undocumented)
    resolve(request: IRequest): Promise<IResolvedUrl | undefined>;
}

// @public
export interface IProgress {
    cancel?: AbortSignal;
    onRetry?(delayInMs: number, error: any): void;
}

// @internal
export function isCombinedAppAndProtocolSummary(summary: ISummaryTree | undefined, ...optionalRootTrees: string[]): summary is CombinedAppAndProtocolSummary;

// @public
export function isOnline(): OnlineStatus;

// @public
export function isRuntimeMessage(message: {
    type: string;
}): boolean;

// @public (undocumented)
export class LocationRedirectionError extends LoggingError implements ILocationRedirectionError, IFluidErrorBase {
    constructor(message: string, redirectUrl: IResolvedUrl, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry = false;
    // (undocumented)
    readonly errorType = DriverErrorType.locationRedirection;
    // (undocumented)
    readonly redirectUrl: IResolvedUrl;
}

// @public (undocumented)
export function logNetworkFailure(logger: ITelemetryLoggerExt, event: ITelemetryErrorEvent, error?: any): void;

// @public (undocumented)
export enum MessageType2 {
    // (undocumented)
    Accept = "accept"
}

// @public (undocumented)
export class NetworkErrorBasic<T extends string> extends LoggingError implements IFluidErrorBase {
    constructor(message: string, errorType: T, canRetry: boolean, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry: boolean;
    // (undocumented)
    readonly errorType: T;
}

// @public (undocumented)
export class NonRetryableError<T extends string> extends NetworkErrorBasic<T> {
    constructor(message: string, errorType: T, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly errorType: T;
}

// @public (undocumented)
export enum OnlineStatus {
    // (undocumented)
    Offline = 0,
    // (undocumented)
    Online = 1,
    // (undocumented)
    Unknown = 2
}

// @public
export class ParallelRequests<T> {
    constructor(from: number, to: number | undefined, payloadSize: number, logger: ITelemetryLoggerExt, requestCallback: (request: number, from: number, to: number, strongTo: boolean, props: ITelemetryProperties) => Promise<{
        partial: boolean;
        cancel: boolean;
        payload: T[];
    }>, responseCallback: (payload: T[]) => void);
    // (undocumented)
    cancel(): void;
    // (undocumented)
    get canceled(): boolean;
    // (undocumented)
    run(concurrency: number): Promise<void>;
}

// @public (undocumented)
export class PrefetchDocumentStorageService extends DocumentStorageServiceProxy {
    // (undocumented)
    getSnapshotTree(version?: IVersion): Promise<ISnapshotTree | null>;
    // (undocumented)
    get policies(): {
        caching: LoaderCachingPolicy;
        maximumCacheDurationMs?: 432000000 | undefined;
    } | undefined;
    // (undocumented)
    readBlob(blobId: string): Promise<ArrayBufferLike>;
    // (undocumented)
    stopPrefetch(): void;
}

// @public
export class Queue<T> implements IStream<T> {
    // (undocumented)
    protected pushCore(value: Promise<IStreamResult<T>>): void;
    // (undocumented)
    pushDone(): void;
    // (undocumented)
    pushError(error: any): void;
    // (undocumented)
    pushValue(value: T): void;
    // (undocumented)
    read(): Promise<IStreamResult<T>>;
}

// @public (undocumented)
export class RateLimiter {
    constructor(maxRequests: number);
    // (undocumented)
    protected acquire(): Promise<void>;
    // (undocumented)
    protected readonly release: () => void;
    // (undocumented)
    schedule<T>(work: () => Promise<T>): Promise<T>;
    // (undocumented)
    get waitQueueLength(): number;
}

// @public
export function readAndParse<T>(storage: Pick<IDocumentStorageService, "readBlob">, id: string): Promise<T>;

// @public
export function requestOps(get: (from: number, to: number, telemetryProps: ITelemetryProperties) => Promise<IDeltasFetchResult>, concurrency: number, fromTotal: number, toTotal: number | undefined, payloadSize: number, logger: ITelemetryLoggerExt, signal?: AbortSignal, scenarioName?: string): IStream<ISequencedDocumentMessage[]>;

// @public (undocumented)
export class RetryableError<T extends string> extends NetworkErrorBasic<T> {
    constructor(message: string, errorType: T, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly errorType: T;
}

// @public (undocumented)
export function runWithRetry<T>(api: (cancel?: AbortSignal) => Promise<T>, fetchCallName: string, logger: ITelemetryLoggerExt, progress: IProgress): Promise<T>;

// @public (undocumented)
export function streamFromMessages(messagesArg: Promise<ISequencedDocumentMessage[]>): IStream<ISequencedDocumentMessage[]>;

// @public (undocumented)
export function streamObserver<T>(stream: IStream<T>, handler: (value: IStreamResult<T>) => void): IStream<T>;

// @public (undocumented)
export enum SummaryCompressionAlgorithm {
    // (undocumented)
    LZ4 = 1,
    // (undocumented)
    None = 0
}

// @public
export class ThrottlingError extends LoggingError implements IThrottlingWarning, IFluidErrorBase {
    constructor(message: string, retryAfterSeconds: number, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry = true;
    // (undocumented)
    readonly errorType = DriverErrorType.throttlingError;
    // (undocumented)
    readonly retryAfterSeconds: number;
}

// @public
export class TreeTreeEntry {
    constructor(path: string, value: ITree);
    // (undocumented)
    readonly mode = FileMode.Directory;
    // (undocumented)
    readonly path: string;
    // (undocumented)
    readonly type = TreeEntry.Tree;
    // (undocumented)
    readonly value: ITree;
}

// @public
export class UsageError extends LoggingError implements IDriverErrorBase, IFluidErrorBase {
    constructor(message: string);
    // (undocumented)
    readonly canRetry = false;
    // (undocumented)
    readonly errorType = DriverErrorType.usageError;
}

// Warnings were encountered during analysis:
//
// src/adapters/compression/compressionTypes.ts:9:1 - (ae-undocumented) Missing documentation for "SummaryCompressionAlgorithm".
// src/adapters/compression/compressionTypes.ts:10:2 - (ae-undocumented) Missing documentation for "None".
// src/adapters/compression/compressionTypes.ts:11:2 - (ae-undocumented) Missing documentation for "LZ4".
// src/adapters/compression/compressionTypes.ts:17:1 - (ae-undocumented) Missing documentation for "ICompressionStorageConfig".
// src/adapters/compression/compressionTypes.ts:18:2 - (ae-undocumented) Missing documentation for "algorithm".
// src/adapters/compression/compressionTypes.ts:19:2 - (ae-undocumented) Missing documentation for "minSizeToCompress".
// src/adapters/compression/summaryblob/documentStorageServiceSummaryBlobCompressionAdapter.ts:25:14 - (ae-undocumented) Missing documentation for "blobHeadersBlobName".
// src/blob.ts:18:27 - (ae-undocumented) Missing documentation for "path".
// src/blob.ts:19:2 - (ae-undocumented) Missing documentation for "mode".
// src/blob.ts:20:2 - (ae-undocumented) Missing documentation for "type".
// src/blob.ts:21:2 - (ae-undocumented) Missing documentation for "value".
// src/blob.ts:42:27 - (ae-undocumented) Missing documentation for "path".
// src/blob.ts:43:2 - (ae-undocumented) Missing documentation for "mode".
// src/blob.ts:44:2 - (ae-undocumented) Missing documentation for "type".
// src/blob.ts:53:10 - (ae-undocumented) Missing documentation for "value".
// src/blob.ts:61:33 - (ae-undocumented) Missing documentation for "path".
// src/blob.ts:62:2 - (ae-undocumented) Missing documentation for "mode".
// src/blob.ts:63:2 - (ae-undocumented) Missing documentation for "type".
// src/blob.ts:64:2 - (ae-undocumented) Missing documentation for "value".
// src/blob.ts:73:10 - (ae-undocumented) Missing documentation for "id".
// src/documentStorageServiceProxy.ts:23:1 - (ae-undocumented) Missing documentation for "DocumentStorageServiceProxy".
// src/documentStorageServiceProxy.ts:30:2 - (ae-undocumented) Missing documentation for "policies".
// src/documentStorageServiceProxy.ts:34:2 - (ae-undocumented) Missing documentation for "repositoryUrl".
// src/documentStorageServiceProxy.ts:38:14 - (ae-undocumented) Missing documentation for "internalStorageService".
// src/documentStorageServiceProxy.ts:40:15 - (ae-undocumented) Missing documentation for "getSnapshotTree".
// src/documentStorageServiceProxy.ts:47:15 - (ae-undocumented) Missing documentation for "getVersions".
// src/documentStorageServiceProxy.ts:56:15 - (ae-undocumented) Missing documentation for "uploadSummaryWithContext".
// src/documentStorageServiceProxy.ts:63:15 - (ae-undocumented) Missing documentation for "downloadSummary".
// src/documentStorageServiceProxy.ts:67:15 - (ae-undocumented) Missing documentation for "createBlob".
// src/documentStorageServiceProxy.ts:71:15 - (ae-undocumented) Missing documentation for "readBlob".
// src/error.ts:16:2 - (ae-undocumented) Missing documentation for "errorType".
// src/error.ts:17:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/insecureUrlResolver.ts:39:15 - (ae-undocumented) Missing documentation for "resolve".
// src/insecureUrlResolver.ts:135:15 - (ae-undocumented) Missing documentation for "getAbsoluteUrl".
// src/insecureUrlResolver.ts:151:9 - (ae-undocumented) Missing documentation for "createCreateNewRequest".
// src/messageRecognition.ts:26:1 - (ae-undocumented) Missing documentation for "MessageType2".
// src/messageRecognition.ts:27:2 - (ae-undocumented) Missing documentation for "Accept".
// src/messageRecognition.ts:34:1 - (ae-undocumented) Missing documentation for "canBeCoalescedByService".
// src/network.ts:22:1 - (ae-undocumented) Missing documentation for "OnlineStatus".
// src/network.ts:23:2 - (ae-undocumented) Missing documentation for "Offline".
// src/network.ts:24:2 - (ae-undocumented) Missing documentation for "Online".
// src/network.ts:25:2 - (ae-undocumented) Missing documentation for "Unknown".
// src/network.ts:59:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:63:3 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:79:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:80:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:90:1 - (ae-undocumented) Missing documentation for "DeltaStreamConnectionForbiddenError".
// src/network.ts:95:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:96:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:97:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:98:2 - (ae-undocumented) Missing documentation for "storageOnlyReason".
// src/network.ts:109:1 - (ae-undocumented) Missing documentation for "AuthorizationError".
// src/network.ts:114:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:115:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:119:3 - (ae-undocumented) Missing documentation for "claims".
// src/network.ts:120:3 - (ae-undocumented) Missing documentation for "tenantId".
// src/network.ts:131:1 - (ae-undocumented) Missing documentation for "LocationRedirectionError".
// src/network.ts:136:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:137:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:141:3 - (ae-undocumented) Missing documentation for "redirectUrl".
// src/network.ts:152:1 - (ae-undocumented) Missing documentation for "NetworkErrorBasic".
// src/network.ts:155:3 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:156:3 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:166:1 - (ae-undocumented) Missing documentation for "NonRetryableError".
// src/network.ts:169:3 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:179:1 - (ae-undocumented) Missing documentation for "RetryableError".
// src/network.ts:182:3 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:195:2 - (ae-undocumented) Missing documentation for "errorType".
// src/network.ts:196:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/network.ts:200:3 - (ae-undocumented) Missing documentation for "retryAfterSeconds".
// src/network.ts:210:14 - (ae-undocumented) Missing documentation for "createWriteError".
// src/network.ts:216:1 - (ae-undocumented) Missing documentation for "createGenericNetworkError".
// src/networkUtils.ts:13:1 - (ae-undocumented) Missing documentation for "logNetworkFailure".
// src/parallelRequests.ts:48:2 - (ae-undocumented) Missing documentation for "canceled".
// src/parallelRequests.ts:71:9 - (ae-undocumented) Missing documentation for "cancel".
// src/parallelRequests.ts:78:15 - (ae-undocumented) Missing documentation for "run".
// src/parallelRequests.ts:350:9 - (ae-undocumented) Missing documentation for "pushValue".
// src/parallelRequests.ts:354:9 - (ae-undocumented) Missing documentation for "pushError".
// src/parallelRequests.ts:359:9 - (ae-undocumented) Missing documentation for "pushDone".
// src/parallelRequests.ts:364:2 - (ae-undocumented) Missing documentation for "pushCore".
// src/parallelRequests.ts:375:15 - (ae-undocumented) Missing documentation for "read".
// src/parallelRequests.ts:660:14 - (ae-undocumented) Missing documentation for "emptyMessageStream".
// src/parallelRequests.ts:669:1 - (ae-undocumented) Missing documentation for "streamFromMessages".
// src/parallelRequests.ts:688:1 - (ae-undocumented) Missing documentation for "streamObserver".
// src/prefetchDocumentStorageService.ts:13:1 - (ae-undocumented) Missing documentation for "PrefetchDocumentStorageService".
// src/prefetchDocumentStorageService.ts:18:2 - (ae-undocumented) Missing documentation for "policies".
// src/prefetchDocumentStorageService.ts:25:15 - (ae-undocumented) Missing documentation for "getSnapshotTree".
// src/prefetchDocumentStorageService.ts:39:15 - (ae-undocumented) Missing documentation for "readBlob".
// src/prefetchDocumentStorageService.ts:42:9 - (ae-undocumented) Missing documentation for "stopPrefetch".
// src/rateLimiter.ts:11:1 - (ae-undocumented) Missing documentation for "RateLimiter".
// src/rateLimiter.ts:17:2 - (ae-undocumented) Missing documentation for "waitQueueLength".
// src/rateLimiter.ts:23:2 - (ae-undocumented) Missing documentation for "release".
// src/rateLimiter.ts:29:4 - (ae-undocumented) Missing documentation for "acquire".
// src/rateLimiter.ts:42:15 - (ae-undocumented) Missing documentation for "schedule".
// src/runWithRetry.ts:50:1 - (ae-undocumented) Missing documentation for "runWithRetry".
// src/summaryForCreateNew.ts:20:2 - (ae-undocumented) Missing documentation for "tree".

// (No @packageDocumentation comment for this package)

```
