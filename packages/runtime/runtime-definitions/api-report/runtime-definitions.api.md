## API Report File for "@fluidframework/runtime-definitions"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { AttachState } from '@fluidframework/container-definitions';
import { FluidObject } from '@fluidframework/core-interfaces';
import { IAudience } from '@fluidframework/container-definitions';
import { IClientDetails } from '@fluidframework/protocol-definitions';
import { IDeltaManager } from '@fluidframework/container-definitions';
import { IDisposable } from '@fluidframework/core-interfaces';
import { IDocumentMessage } from '@fluidframework/protocol-definitions';
import { IDocumentStorageService } from '@fluidframework/driver-definitions';
import { IEvent } from '@fluidframework/core-interfaces';
import { IEventProvider } from '@fluidframework/core-interfaces';
import { IFluidHandle } from '@fluidframework/core-interfaces';
import { ILoaderOptions } from '@fluidframework/container-definitions';
import { IProvideFluidHandleContext } from '@fluidframework/core-interfaces';
import { IQuorumClients } from '@fluidframework/protocol-definitions';
import { IRequest } from '@fluidframework/core-interfaces';
import { IResponse } from '@fluidframework/core-interfaces';
import { ISequencedDocumentMessage } from '@fluidframework/protocol-definitions';
import { ISignalMessage } from '@fluidframework/protocol-definitions';
import { ISnapshotTree } from '@fluidframework/protocol-definitions';
import { ISummaryTree } from '@fluidframework/protocol-definitions';
import { ITelemetryBaseLogger } from '@fluidframework/core-interfaces';
import { ITree } from '@fluidframework/protocol-definitions';
import type { IUser } from '@fluidframework/protocol-definitions';
import { SummaryTree } from '@fluidframework/protocol-definitions';
import { TelemetryEventPropertyType } from '@fluidframework/core-interfaces';

// @internal
export type AliasResult = "Success" | "Conflict" | "AlreadyAliased";

// @internal
export interface AttributionInfo {
    timestamp: number;
    user: IUser;
}

// @internal
export type AttributionKey = OpAttributionKey | DetachedAttributionKey | LocalAttributionKey;

// @internal (undocumented)
export const blobCountPropertyName = "BlobCount";

// @internal (undocumented)
export const channelsTreeName = ".channels";

// @internal (undocumented)
export type CreateChildSummarizerNodeFn = (summarizeInternal: SummarizeInternalFn, getGCDataFn: (fullGC?: boolean) => Promise<IGarbageCollectionData>,
getBaseGCDetailsFn?: () => Promise<IGarbageCollectionDetailsBase>) => ISummarizerNodeWithGC;

// @internal (undocumented)
export type CreateChildSummarizerNodeParam = {
    type: CreateSummarizerNodeSource.FromSummary;
} | {
    type: CreateSummarizerNodeSource.FromAttach;
    sequenceNumber: number;
    snapshot: ITree;
} | {
    type: CreateSummarizerNodeSource.Local;
};

// @internal (undocumented)
export enum CreateSummarizerNodeSource {
    // (undocumented)
    FromAttach = 1,
    // (undocumented)
    FromSummary = 0,
    // (undocumented)
    Local = 2
}

// @internal
export interface DetachedAttributionKey {
    id: 0;
    // (undocumented)
    type: "detached";
}

// @internal
export type FluidDataStoreRegistryEntry = Readonly<Partial<IProvideFluidDataStoreRegistry & IProvideFluidDataStoreFactory>>;

// @internal
export enum FlushMode {
    Immediate = 0,
    TurnBased = 1
}

// @internal (undocumented)
export enum FlushModeExperimental {
    Async = 2
}

// @internal
export const gcBlobPrefix = "__gc";

// @internal
export const gcDeletedBlobKey = "__deletedNodes";

// @internal
export const gcTombstoneBlobKey = "__tombstones";

// @internal
export const gcTreeKey = "gc";

// @internal
export interface IAttachMessage {
    id: string;
    snapshot: ITree;
    type: string;
}

// @internal
export interface IContainerRuntimeBase extends IEventProvider<IContainerRuntimeBaseEvents> {
    // (undocumented)
    readonly clientDetails: IClientDetails;
    createDataStore(pkg: string | string[]): Promise<IDataStore>;
    // @deprecated (undocumented)
    _createDataStoreWithProps(pkg: string | string[], props?: any, id?: string): Promise<IDataStore>;
    createDetachedDataStore(pkg: Readonly<string[]>): IFluidDataStoreContextDetached;
    getAbsoluteUrl(relativeUrl: string): Promise<string | undefined>;
    getAudience(): IAudience;
    getQuorum(): IQuorumClients;
    // (undocumented)
    readonly logger: ITelemetryBaseLogger;
    orderSequentially(callback: () => void): void;
    submitSignal(type: string, content: any): void;
    // (undocumented)
    uploadBlob(blob: ArrayBufferLike, signal?: AbortSignal): Promise<IFluidHandle<ArrayBufferLike>>;
}

// @internal (undocumented)
export interface IContainerRuntimeBaseEvents extends IEvent {
    // (undocumented)
    (event: "batchBegin", listener: (op: ISequencedDocumentMessage) => void): any;
    // (undocumented)
    (event: "op", listener: (op: ISequencedDocumentMessage, runtimeMessage?: boolean) => void): any;
    // (undocumented)
    (event: "batchEnd", listener: (error: any, op: ISequencedDocumentMessage) => void): any;
    // (undocumented)
    (event: "signal", listener: (message: IInboundSignalMessage, local: boolean) => void): any;
}

// @internal
export interface IDataStore {
    readonly entryPoint: IFluidHandle<FluidObject>;
    trySetAlias(alias: string): Promise<AliasResult>;
}

// @internal
export interface IdCreationRange {
    // (undocumented)
    readonly ids?: {
        readonly firstGenCount: number;
        readonly count: number;
        readonly requestedClusterSize: number;
    };
    // (undocumented)
    readonly sessionId: SessionId;
}

// @internal
export interface IEnvelope {
    address: string;
    contents: any;
}

// @internal
export interface IExperimentalIncrementalSummaryContext {
    latestSummarySequenceNumber: number;
    summaryPath: string;
    summarySequenceNumber: number;
}

// @internal
export interface IFluidDataStoreChannel extends IDisposable {
    // (undocumented)
    applyStashedOp(content: any): Promise<unknown>;
    // @deprecated
    attachGraph(): void;
    readonly attachState: AttachState;
    readonly entryPoint: IFluidHandle<FluidObject>;
    getAttachSummary(telemetryContext?: ITelemetryContext): ISummaryTreeWithStats;
    getGCData(fullGC?: boolean): Promise<IGarbageCollectionData>;
    // (undocumented)
    readonly id: string;
    makeVisibleAndAttachGraph(): void;
    process(message: ISequencedDocumentMessage, local: boolean, localOpMetadata: unknown): void;
    processSignal(message: any, local: boolean): void;
    // (undocumented)
    request(request: IRequest): Promise<IResponse>;
    reSubmit(type: string, content: any, localOpMetadata: unknown): any;
    rollback?(type: string, content: any, localOpMetadata: unknown): void;
    setConnectionState(connected: boolean, clientId?: string): any;
    summarize(fullTree?: boolean, trackState?: boolean, telemetryContext?: ITelemetryContext): Promise<ISummaryTreeWithStats>;
    updateUsedRoutes(usedRoutes: string[]): void;
    // (undocumented)
    readonly visibilityState: VisibilityState;
}

// @internal
export interface IFluidDataStoreContext extends IEventProvider<IFluidDataStoreContextEvents>, Partial<IProvideFluidDataStoreRegistry>, IProvideFluidHandleContext {
    addedGCOutboundReference?(srcHandle: IFluidHandle, outboundHandle: IFluidHandle): void;
    readonly attachState: AttachState;
    // (undocumented)
    readonly baseSnapshot: ISnapshotTree | undefined;
    // (undocumented)
    readonly clientDetails: IClientDetails;
    // (undocumented)
    readonly clientId: string | undefined;
    // (undocumented)
    readonly connected: boolean;
    // (undocumented)
    readonly containerRuntime: IContainerRuntimeBase;
    // @deprecated (undocumented)
    readonly createProps?: any;
    // (undocumented)
    readonly deltaManager: IDeltaManager<ISequencedDocumentMessage, IDocumentMessage>;
    ensureNoDataModelChanges<T>(callback: () => T): T;
    getAbsoluteUrl(relativeUrl: string): Promise<string | undefined>;
    getAudience(): IAudience;
    // @deprecated (undocumented)
    getBaseGCDetails(): Promise<IGarbageCollectionDetailsBase>;
    // (undocumented)
    getCreateChildSummarizerNodeFn(
    id: string,
    createParam: CreateChildSummarizerNodeParam): CreateChildSummarizerNodeFn;
    getQuorum(): IQuorumClients;
    // (undocumented)
    readonly id: string;
    // (undocumented)
    readonly idCompressor?: IIdCompressor;
    readonly isLocalDataStore: boolean;
    // (undocumented)
    readonly logger: ITelemetryBaseLogger;
    makeLocallyVisible(): void;
    // (undocumented)
    readonly options: ILoaderOptions;
    readonly packagePath: readonly string[];
    readonly scope: FluidObject;
    setChannelDirty(address: string): void;
    // (undocumented)
    readonly storage: IDocumentStorageService;
    submitMessage(type: string, content: any, localOpMetadata: unknown): void;
    submitSignal(type: string, content: any, targetClientId?: string): void;
    // (undocumented)
    uploadBlob(blob: ArrayBufferLike, signal?: AbortSignal): Promise<IFluidHandle<ArrayBufferLike>>;
}

// @internal (undocumented)
export interface IFluidDataStoreContextDetached extends IFluidDataStoreContext {
    attachRuntime(factory: IProvideFluidDataStoreFactory, dataStoreRuntime: IFluidDataStoreChannel): Promise<void>;
}

// @internal (undocumented)
export interface IFluidDataStoreContextEvents extends IEvent {
    // (undocumented)
    (event: "attaching" | "attached", listener: () => void): any;
}

// @internal (undocumented)
export const IFluidDataStoreFactory: keyof IProvideFluidDataStoreFactory;

// @internal
export interface IFluidDataStoreFactory extends IProvideFluidDataStoreFactory {
    instantiateDataStore(context: IFluidDataStoreContext, existing: boolean): Promise<IFluidDataStoreChannel>;
    type: string;
}

// @internal (undocumented)
export const IFluidDataStoreRegistry: keyof IProvideFluidDataStoreRegistry;

// @internal
export interface IFluidDataStoreRegistry extends IProvideFluidDataStoreRegistry {
    // (undocumented)
    get(name: string): Promise<FluidDataStoreRegistryEntry | undefined>;
}

// @internal
export interface IGarbageCollectionData {
    gcNodes: {
        [id: string]: string[];
    };
}

// @internal
export interface IGarbageCollectionDetailsBase {
    gcData?: IGarbageCollectionData;
    usedRoutes?: string[];
}

// @internal
export interface IIdCompressor {
    decompress(id: SessionSpaceCompressedId): StableId;
    generateCompressedId(): SessionSpaceCompressedId;
    // (undocumented)
    localSessionId: SessionId;
    normalizeToOpSpace(id: SessionSpaceCompressedId): OpSpaceCompressedId;
    normalizeToSessionSpace(id: OpSpaceCompressedId, originSessionId: SessionId): SessionSpaceCompressedId;
    recompress(uncompressed: StableId): SessionSpaceCompressedId;
    tryRecompress(uncompressed: StableId): SessionSpaceCompressedId | undefined;
}

// @internal (undocumented)
export interface IIdCompressorCore {
    finalizeCreationRange(range: IdCreationRange): void;
    serialize(withSession: true): SerializedIdCompressorWithOngoingSession;
    serialize(withSession: false): SerializedIdCompressorWithNoSession;
    takeNextCreationRange(): IdCreationRange;
}

// @internal
export interface IInboundSignalMessage extends ISignalMessage {
    // (undocumented)
    type: string;
}

// @internal
export type InboundAttachMessage = Omit<IAttachMessage, "snapshot"> & {
    snapshot: IAttachMessage["snapshot"] | null;
};

// @internal (undocumented)
export interface IProvideFluidDataStoreFactory {
    // (undocumented)
    readonly IFluidDataStoreFactory: IFluidDataStoreFactory;
}

// @internal (undocumented)
export interface IProvideFluidDataStoreRegistry {
    // (undocumented)
    readonly IFluidDataStoreRegistry: IFluidDataStoreRegistry;
}

// @internal (undocumented)
export interface ISignalEnvelope {
    address?: string;
    clientSignalSequenceNumber: number;
    contents: {
        type: string;
        content: any;
    };
}

// @internal
export interface ISummarizeInternalResult extends ISummarizeResult {
    // (undocumented)
    id: string;
    pathPartsForChildren?: string[];
}

// @internal
export interface ISummarizeResult {
    // (undocumented)
    stats: ISummaryStats;
    // (undocumented)
    summary: SummaryTree;
}

// @internal (undocumented)
export interface ISummarizerNode {
    // (undocumented)
    createChild(
    summarizeInternalFn: SummarizeInternalFn,
    id: string,
    createParam: CreateChildSummarizerNodeParam,
    config?: ISummarizerNodeConfig): ISummarizerNode;
    // (undocumented)
    getChild(id: string): ISummarizerNode | undefined;
    invalidate(sequenceNumber: number): void;
    isSummaryInProgress?(): boolean;
    recordChange(op: ISequencedDocumentMessage): void;
    readonly referenceSequenceNumber: number;
    summarize(fullTree: boolean, trackState?: boolean, telemetryContext?: ITelemetryContext): Promise<ISummarizeResult>;
    updateBaseSummaryState(snapshot: ISnapshotTree): void;
}

// @internal (undocumented)
export interface ISummarizerNodeConfig {
    readonly canReuseHandle?: boolean;
    readonly throwOnFailure?: true;
}

// @internal (undocumented)
export interface ISummarizerNodeConfigWithGC extends ISummarizerNodeConfig {
    readonly gcDisabled?: boolean;
}

// @internal
export interface ISummarizerNodeWithGC extends ISummarizerNode {
    // (undocumented)
    createChild(
    summarizeInternalFn: SummarizeInternalFn,
    id: string,
    createParam: CreateChildSummarizerNodeParam,
    config?: ISummarizerNodeConfigWithGC, getGCDataFn?: (fullGC?: boolean) => Promise<IGarbageCollectionData>,
    getBaseGCDetailsFn?: () => Promise<IGarbageCollectionDetailsBase>): ISummarizerNodeWithGC;
    deleteChild(id: string): void;
    // (undocumented)
    getChild(id: string): ISummarizerNodeWithGC | undefined;
    getGCData(fullGC?: boolean): Promise<IGarbageCollectionData>;
    isReferenced(): boolean;
    updateUsedRoutes(usedRoutes: string[]): void;
}

// @internal
export interface ISummaryStats {
    // (undocumented)
    blobNodeCount: number;
    // (undocumented)
    handleNodeCount: number;
    // (undocumented)
    totalBlobSize: number;
    // (undocumented)
    treeNodeCount: number;
    // (undocumented)
    unreferencedBlobSize: number;
}

// @internal
export interface ISummaryTreeWithStats {
    stats: ISummaryStats;
    summary: ISummaryTree;
}

// @internal
export interface ITelemetryContext {
    get(prefix: string, property: string): TelemetryEventPropertyType;
    serialize(): string;
    set(prefix: string, property: string, value: TelemetryEventPropertyType): void;
    setMultiple(prefix: string, property: string, values: Record<string, TelemetryEventPropertyType>): void;
}

// @internal
export interface LocalAttributionKey {
    // (undocumented)
    type: "local";
}

// @internal
export type NamedFluidDataStoreRegistryEntries = Iterable<NamedFluidDataStoreRegistryEntry>;

// @internal
export type NamedFluidDataStoreRegistryEntry = [string, Promise<FluidDataStoreRegistryEntry>];

// @internal
export interface OpAttributionKey {
    seq: number;
    type: "op";
}

// @internal
export type OpSpaceCompressedId = number & {
    readonly OpNormalized: "9209432d-a959-4df7-b2ad-767ead4dbcae";
};

// @internal
export type SerializedIdCompressor = string & {
    readonly _serializedIdCompressor: "8c73c57c-1cf4-4278-8915-6444cb4f6af5";
};

// @internal
export type SerializedIdCompressorWithNoSession = SerializedIdCompressor & {
    readonly _noLocalState: "3aa2e1e8-cc28-4ea7-bc1a-a11dc3f26dfb";
};

// @internal
export type SerializedIdCompressorWithOngoingSession = SerializedIdCompressor & {
    readonly _hasLocalState: "1281acae-6d14-47e7-bc92-71c8ee0819cb";
};

// @internal
export type SessionId = StableId & {
    readonly SessionId: "4498f850-e14e-4be9-8db0-89ec00997e58";
};

// @internal
export type SessionSpaceCompressedId = number & {
    readonly SessionUnique: "cea55054-6b82-4cbf-ad19-1fa645ea3b3e";
};

// @internal
export type StableId = string & {
    readonly StableId: "53172b0d-a3d5-41ea-bd75-b43839c97f5a";
};

// @internal (undocumented)
export type SummarizeInternalFn = (fullTree: boolean, trackState: boolean, telemetryContext?: ITelemetryContext, incrementalSummaryContext?: IExperimentalIncrementalSummaryContext) => Promise<ISummarizeInternalResult>;

// @internal (undocumented)
export const totalBlobSizePropertyName = "TotalBlobSize";

// @internal
export const VisibilityState: {
    NotVisible: string;
    LocallyVisible: string;
    GloballyVisible: string;
};

// @internal (undocumented)
export type VisibilityState = (typeof VisibilityState)[keyof typeof VisibilityState];

// (No @packageDocumentation comment for this package)

```
