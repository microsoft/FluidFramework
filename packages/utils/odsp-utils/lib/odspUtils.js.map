{"version":3,"file":"odspUtils.js","sourceRoot":"","sources":["../src/odspUtils.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,MAAM,WAAW,GAAG,IAAI,GAAG,CAAiB;IACxC,CAAC,KAAK,EAAE,6BAA6B,CAAC;IACtC,CAAC,QAAQ,EAAE,gCAAgC,CAAC;CAC/C,CAAC,CAAC;AAEH,MAAM,UAAU,eAAe,CAAC,MAAc;IAC1C,OAAO,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;AACrF,CAAC;AAED,MAAM,UAAU,mBAAmB,CAAC,MAAc;IAC9C,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;IACnD,IAAI,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;QACxB,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;KAChD;IACD,OAAO,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,GAAG,MAAM,kBAAkB,CAAC;AAClF,CAAC;AAED,MAAM,UAAU,SAAS,CAAC,QAAgB;IACtC,MAAM,MAAM,GAAG,WAAW,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACzC,IAAI,CAAC,MAAM,EAAE;QACT,MAAM,KAAK,CAAC,wBAAwB,QAAQ,GAAG,CAAC,CAAC;KACpD;IACD,OAAO,MAAM,CAAC;AAClB,CAAC","sourcesContent":["/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nconst odspTenants = new Map<string, string>([\n    [\"spo\", \"microsoft-my.sharepoint.com\"],\n    [\"spo-df\", \"microsoft-my.sharepoint-df.com\"],\n]);\n\nexport function isSharepointURL(server: string) {\n    return server.endsWith(\"sharepoint.com\") || server.endsWith(\"sharepoint-df.com\");\n}\n\nexport function getSharepointTenant(server: string) {\n    let tenant = server.substr(0, server.indexOf(\".\"));\n    if (tenant.endsWith(\"-my\")) {\n        tenant = tenant.substr(0, tenant.length - 3);\n    }\n    return tenant === \"microsoft\" ? \"organizations\" : `${tenant}.onmicrosoft.com`;\n}\n\nexport function getServer(tenantId: string): string {\n    const server = odspTenants.get(tenantId);\n    if (!server) {\n        throw Error(`Invalid SPO tenantId ${tenantId}.`);\n    }\n    return server;\n}\n"]}