## API Report File for "@fluidframework/odsp-doclib-utils"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { DriverErrorTelemetryProps } from '@fluidframework/driver-utils';
import { IFluidErrorBase } from '@fluidframework/telemetry-utils';
import { IOdspErrorAugmentations } from '@fluidframework/odsp-driver-definitions';
import { ITelemetryProperties } from '@fluidframework/core-interfaces';
import { LoggingError } from '@fluidframework/telemetry-utils';
import { OdspError } from '@fluidframework/odsp-driver-definitions';

// @public
export function authRequestWithRetry(authRequestInfo: IOdspAuthRequestInfo, requestCallback: (config: RequestInit) => Promise<Response>): Promise<Response>;

// @public (undocumented)
export function createOdspNetworkError(errorMessage: string, statusCode: number, retryAfterSeconds?: number, response?: Response, responseText?: string, props?: ITelemetryProperties): IFluidErrorBase & OdspError;

// @public (undocumented)
export function enrichOdspError(error: IFluidErrorBase & OdspError, response?: Response, facetCodes?: string[], props?: ITelemetryProperties): IFluidErrorBase & OdspError;

// @public (undocumented)
export const fetchIncorrectResponse = 712;

// @public
export function fetchTokens(server: string, scope: string, clientConfig: IClientConfig, credentials: TokenRequestCredentials): Promise<IOdspTokens>;

// @public (undocumented)
export function getAadTenant(server: string): string;

// @public (undocumented)
export function getAadUrl(server: string): string;

// @public (undocumented)
export function getAsync(url: string, authRequestInfo: IOdspAuthRequestInfo): Promise<Response>;

// @public (undocumented)
export function getChildrenByDriveItem(driveItem: IOdspDriveItem, server: string, authRequestInfo: IOdspAuthRequestInfo): Promise<IOdspDriveItem[]>;

// @public (undocumented)
export function getDriveId(server: string, account: string, library: string | undefined, authRequestInfo: IOdspAuthRequestInfo): Promise<string>;

// @public (undocumented)
export function getDriveItemByRootFileName(server: string, account: string | undefined, path: string, authRequestInfo: IOdspAuthRequestInfo, create: boolean, driveId?: string): Promise<IOdspDriveItem>;

// @public (undocumented)
export function getDriveItemByServerRelativePath(server: string, serverRelativePath: string, authRequestInfo: IOdspAuthRequestInfo, create: boolean): Promise<IOdspDriveItem>;

// @public (undocumented)
export function getDriveItemFromDriveAndItem(server: string, drive: string, item: string, authRequestInfo: IOdspAuthRequestInfo): Promise<IOdspDriveItem>;

// @public (undocumented)
export function getFetchTokenUrl(server: string): string;

// @public (undocumented)
export function getLoginPageUrl(server: string, clientConfig: IClientConfig, scope: string, odspAuthRedirectUri: string): string;

// @public (undocumented)
export const getOdspRefreshTokenFn: (server: string, clientConfig: IClientConfig, tokens: IOdspTokens) => () => Promise<string>;

// @public (undocumented)
export const getOdspScope: (server: string) => string;

// @public (undocumented)
export const getPushRefreshTokenFn: (server: string, clientConfig: IClientConfig, tokens: IOdspTokens) => () => Promise<string>;

// @public (undocumented)
export const getRefreshTokenFn: (scope: string, server: string, clientConfig: IClientConfig, tokens: IOdspTokens) => () => Promise<string>;

// @public (undocumented)
export function getServer(tenantId: string): string;

// @public (undocumented)
export function getSiteUrl(server: string): string;

// @public (undocumented)
export function getSPOAndGraphRequestIdsFromResponse(headers: {
    get: (id: string) => string | undefined | null;
}): ITelemetryProperties;

// @public (undocumented)
export function hasFacetCodes(x: any): x is Pick<IOdspErrorAugmentations, "facetCodes">;

// @public (undocumented)
export interface IClientConfig {
    // (undocumented)
    clientId: string;
    // (undocumented)
    clientSecret: string;
}

// @public (undocumented)
export interface IOdspAuthRequestInfo {
    // (undocumented)
    accessToken: string;
    // (undocumented)
    refreshTokenFn?: () => Promise<string>;
}

// @public (undocumented)
export interface IOdspDriveItem {
    // (undocumented)
    driveId: string;
    // (undocumented)
    isFolder: boolean;
    // (undocumented)
    itemId: string;
    // (undocumented)
    name: string;
    // (undocumented)
    path: string;
}

// @public (undocumented)
export interface IOdspTokens {
    // (undocumented)
    readonly accessToken: string;
    // (undocumented)
    readonly refreshToken: string;
}

// @public (undocumented)
export function isOdspHostname(server: string): boolean;

// @public (undocumented)
export function isPushChannelHostname(server: string): boolean;

// @public
export interface OdspErrorResponse {
    // (undocumented)
    error: OdspErrorResponseInnerError & {
        message: string;
    };
}

// @public
export interface OdspErrorResponseInnerError {
    // (undocumented)
    code?: string;
    // (undocumented)
    innerError?: OdspErrorResponseInnerError;
}

// @public
export class OdspRedirectError extends LoggingError implements IFluidErrorBase {
    constructor(message: string, redirectLocation: string | undefined, props: DriverErrorTelemetryProps);
    // (undocumented)
    readonly canRetry = false;
    // (undocumented)
    readonly errorType = DriverErrorType.fileNotFoundOrAccessDeniedError;
    // (undocumented)
    readonly redirectLocation: string | undefined;
}

// @public (undocumented)
export const OdspServiceReadOnlyErrorCode = "serviceReadOnly";

// @public (undocumented)
export function parseFacetCodes(errorResponse: OdspErrorResponse): string[];

// @public (undocumented)
export function postAsync(url: string, body: any, authRequestInfo: IOdspAuthRequestInfo): Promise<Response>;

// @public (undocumented)
export const pushScope = "offline_access https://pushchannel.1drv.ms/PushChannel.ReadWrite.All";

// @public (undocumented)
export function putAsync(url: string, authRequestInfo: IOdspAuthRequestInfo): Promise<Response>;

// @public
export function refreshTokens(server: string, scope: string, clientConfig: IClientConfig, tokens: IOdspTokens): Promise<IOdspTokens>;

// @public
export function throwOdspNetworkError(errorMessage: string, statusCode: number, response: Response, responseText?: string, props?: ITelemetryProperties): never;

// @public (undocumented)
export type TokenRequestCredentials = {
    grant_type: "authorization_code";
    code: string;
    redirect_uri: string;
} | {
    grant_type: "refresh_token";
    refresh_token: string;
} | {
    grant_type: "password";
    username: string;
    password: string;
};

// @public (undocumented)
export function tryParseErrorResponse(response: string | undefined): {
    success: true;
    errorResponse: OdspErrorResponse;
} | {
    success: false;
};

// @public (undocumented)
export function unauthPostAsync(url: string, body: any): Promise<Response>;

// Warnings were encountered during analysis:
//
// src/odspAuth.ts:12:1 - (ae-undocumented) Missing documentation for "IOdspTokens".
// src/odspAuth.ts:13:2 - (ae-undocumented) Missing documentation for "accessToken".
// src/odspAuth.ts:14:2 - (ae-undocumented) Missing documentation for "refreshToken".
// src/odspAuth.ts:17:1 - (ae-undocumented) Missing documentation for "IClientConfig".
// src/odspAuth.ts:18:2 - (ae-undocumented) Missing documentation for "clientId".
// src/odspAuth.ts:19:2 - (ae-undocumented) Missing documentation for "clientSecret".
// src/odspAuth.ts:22:1 - (ae-undocumented) Missing documentation for "IOdspAuthRequestInfo".
// src/odspAuth.ts:23:2 - (ae-undocumented) Missing documentation for "accessToken".
// src/odspAuth.ts:24:2 - (ae-undocumented) Missing documentation for "refreshTokenFn".
// src/odspAuth.ts:27:1 - (ae-undocumented) Missing documentation for "TokenRequestCredentials".
// src/odspAuth.ts:49:14 - (ae-undocumented) Missing documentation for "getOdspScope".
// src/odspAuth.ts:51:14 - (ae-undocumented) Missing documentation for "pushScope".
// src/odspAuth.ts:53:1 - (ae-undocumented) Missing documentation for "getFetchTokenUrl".
// src/odspAuth.ts:57:1 - (ae-undocumented) Missing documentation for "getLoginPageUrl".
// src/odspAuth.ts:72:14 - (ae-undocumented) Missing documentation for "getOdspRefreshTokenFn".
// src/odspAuth.ts:77:14 - (ae-undocumented) Missing documentation for "getPushRefreshTokenFn".
// src/odspAuth.ts:82:14 - (ae-undocumented) Missing documentation for "getRefreshTokenFn".
// src/odspDocLibUtils.ts:11:1 - (ae-undocumented) Missing documentation for "isOdspHostname".
// src/odspDocLibUtils.ts:15:1 - (ae-undocumented) Missing documentation for "isPushChannelHostname".
// src/odspDocLibUtils.ts:19:1 - (ae-undocumented) Missing documentation for "getAadUrl".
// src/odspDocLibUtils.ts:34:1 - (ae-undocumented) Missing documentation for "getAadTenant".
// src/odspDocLibUtils.ts:62:1 - (ae-undocumented) Missing documentation for "getServer".
// src/odspDocLibUtils.ts:70:1 - (ae-undocumented) Missing documentation for "getSiteUrl".
// src/odspDrives.ts:50:1 - (ae-undocumented) Missing documentation for "IOdspDriveItem".
// src/odspDrives.ts:51:2 - (ae-undocumented) Missing documentation for "path".
// src/odspDrives.ts:52:2 - (ae-undocumented) Missing documentation for "name".
// src/odspDrives.ts:53:2 - (ae-undocumented) Missing documentation for "driveId".
// src/odspDrives.ts:54:2 - (ae-undocumented) Missing documentation for "itemId".
// src/odspDrives.ts:55:2 - (ae-undocumented) Missing documentation for "isFolder".
// src/odspDrives.ts:58:1 - (ae-undocumented) Missing documentation for "getDriveItemByRootFileName".
// src/odspDrives.ts:79:1 - (ae-undocumented) Missing documentation for "getDriveItemByServerRelativePath".
// src/odspDrives.ts:111:1 - (ae-undocumented) Missing documentation for "getDriveItemFromDriveAndItem".
// src/odspDrives.ts:121:1 - (ae-undocumented) Missing documentation for "getChildrenByDriveItem".
// src/odspDrives.ts:189:1 - (ae-undocumented) Missing documentation for "getDriveId".
// src/odspErrorUtils.ts:32:14 - (ae-undocumented) Missing documentation for "fetchIncorrectResponse".
// src/odspErrorUtils.ts:35:14 - (ae-undocumented) Missing documentation for "OdspServiceReadOnlyErrorCode".
// src/odspErrorUtils.ts:37:1 - (ae-undocumented) Missing documentation for "getSPOAndGraphRequestIdsFromResponse".
// src/odspErrorUtils.ts:100:2 - (ae-undocumented) Missing documentation for "code".
// src/odspErrorUtils.ts:101:2 - (ae-undocumented) Missing documentation for "innerError".
// src/odspErrorUtils.ts:106:2 - (ae-undocumented) Missing documentation for "error".
// src/odspErrorUtils.ts:114:2 - (ae-undocumented) Missing documentation for "errorType".
// src/odspErrorUtils.ts:115:2 - (ae-undocumented) Missing documentation for "canRetry".
// src/odspErrorUtils.ts:119:3 - (ae-undocumented) Missing documentation for "redirectLocation".
// src/odspErrorUtils.ts:136:1 - (ae-undocumented) Missing documentation for "tryParseErrorResponse".
// src/odspErrorUtils.ts:151:1 - (ae-undocumented) Missing documentation for "parseFacetCodes".
// src/odspErrorUtils.ts:163:1 - (ae-undocumented) Missing documentation for "createOdspNetworkError".
// src/odspErrorUtils.ts:357:1 - (ae-undocumented) Missing documentation for "enrichOdspError".
// src/odspErrorUtils.ts:418:1 - (ae-undocumented) Missing documentation for "hasFacetCodes".
// src/odspRequest.ts:9:1 - (ae-undocumented) Missing documentation for "getAsync".
// src/odspRequest.ts:16:1 - (ae-undocumented) Missing documentation for "putAsync".
// src/odspRequest.ts:29:1 - (ae-undocumented) Missing documentation for "postAsync".
// src/odspRequest.ts:44:1 - (ae-undocumented) Missing documentation for "unauthPostAsync".

// (No @packageDocumentation comment for this package)

```
