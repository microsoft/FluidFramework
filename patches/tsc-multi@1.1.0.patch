diff --git a/dist/build.js b/dist/build.js
index 29144bc5cdb118655229a1f8998c3168170ca257..19b3d6b3066d308d0eb53dfae65fe4806f45176b 100644
--- a/dist/build.js
+++ b/dist/build.js
@@ -56,7 +56,7 @@ async function build({ targets: inputTargets, stdout = "inherit", stderr = "inhe
     const targets = inputTargets && inputTargets.length ? inputTargets : [{}];
     validateTargets(targets);
     const reportStyles = (0, report_1.getReportStyles)();
-    const codes = await (0, p_all_1.default)(targets.map(({ extname, transpileOnly, ...target }, i) => {
+    const codes = await (0, p_all_1.default)(targets.map(({ extname, dtsExtName, transpileOnly, ...target }, i) => {
         const prefix = `[${(0, utils_1.trimPrefix)(extname || DEFAULT_EXTNAME, ".")}]: `;
         const prefixStyle = reportStyles[i % reportStyles.length];
         return () => {
@@ -66,6 +66,7 @@ async function build({ targets: inputTargets, stdout = "inherit", stderr = "inhe
                 stdout,
                 stderr,
                 extname,
+                dtsExtName,
                 target,
                 reportPrefix: prefixStyle(prefix),
                 transpileOnly,
diff --git a/dist/build.js.map b/dist/build.js.map
index 97248fa7f6f322ac04a20aae50785d2ee39590be..7f52e769012dbd18ea775e0ce1e56c4266f41c62 100644
--- a/dist/build.js.map
+++ b/dist/build.js.map
@@ -1 +1 @@
-{"version":3,"file":"build.js","sourceRoot":"","sources":["../src/build.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"build.js","sourceRoot":"","sources":["../src/build.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/cli.d.ts b/dist/cli.d.ts
old mode 100755
new mode 100644
diff --git a/dist/config.d.ts b/dist/config.d.ts
index 3848267ebc4ad4369f54de7e857dd549cdedddcd..6dcf5abf0d5befc56a3136790215da8797fa357f 100644
--- a/dist/config.d.ts
+++ b/dist/config.d.ts
@@ -1,9 +1,11 @@
 import { Infer } from "superstruct";
 declare const targetSchema: import("superstruct").Struct<{
     extname?: string | undefined;
+    dtsExtName?: string | undefined;
     transpileOnly?: boolean | undefined;
 }, {
     extname: import("superstruct").Struct<string | undefined, null>;
+    dtsExtName: import("superstruct").Struct<string | undefined, null>;
     transpileOnly: import("superstruct").Struct<boolean | undefined, null>;
 }>;
 export type Target = Infer<typeof targetSchema> & {
@@ -13,6 +15,7 @@ declare const configSchema: import("superstruct").Struct<{
     projects?: string[] | undefined;
     targets?: {
         extname?: string | undefined;
+        dtsExtName?: string | undefined;
         transpileOnly?: boolean | undefined;
     }[] | undefined;
     compiler?: string | undefined;
@@ -21,12 +24,15 @@ declare const configSchema: import("superstruct").Struct<{
     projects: import("superstruct").Struct<string[] | undefined, import("superstruct").Struct<string, null>>;
     targets: import("superstruct").Struct<{
         extname?: string | undefined;
+        dtsExtName?: string | undefined;
         transpileOnly?: boolean | undefined;
     }[] | undefined, import("superstruct").Struct<{
         extname?: string | undefined;
+        dtsExtName?: string | undefined;
         transpileOnly?: boolean | undefined;
     }, {
         extname: import("superstruct").Struct<string | undefined, null>;
+        dtsExtName: import("superstruct").Struct<string | undefined, null>;
         transpileOnly: import("superstruct").Struct<boolean | undefined, null>;
     }>>;
     compiler: import("superstruct").Struct<string | undefined, null>;
diff --git a/dist/config.js b/dist/config.js
index ec88667662f2467aab454c2579823af53c105d0a..b088676cc4a2b206e6c8d19be007fb8f0e50b9e4 100644
--- a/dist/config.js
+++ b/dist/config.js
@@ -10,6 +10,7 @@ const fast_glob_1 = tslib_1.__importDefault(require("fast-glob"));
 const debug = debug_1.default.extend("config");
 const targetSchema = (0, superstruct_1.type)({
     extname: (0, superstruct_1.optional)((0, superstruct_1.string)()),
+    dtsExtName: (0, superstruct_1.optional)((0, superstruct_1.string)()),
     transpileOnly: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
 });
 const configSchema = (0, superstruct_1.object)({
diff --git a/dist/config.js.map b/dist/config.js.map
index fc89668cf0107b667a4fb692aef828ba8e258456..bac0e7b30dc2aa37a79cf95150ab91179e4b7967 100644
--- a/dist/config.js.map
+++ b/dist/config.js.map
@@ -1 +1 @@
-{"version":3,"file":"config.js","sourceRoot":"","sources":["../src/config.ts"],"names":[],"mappings":";;;;AAAA,+BAAwC;AACxC,6CAWqB;AACrB,4DAA4B;AAC5B,mCAAgD;AAChD,kEAA6B;AAE7B,MAAM,KAAK,GAAG,eAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAErC,MAAM,YAAY,GAAG,IAAA,kBAAI,EAAC;IACxB,OAAO,EAAE,IAAA,sBAAQ,EAAC,IAAA,oBAAM,GAAE,CAAC;IAC3B,aAAa,EAAE,IAAA,sBAAQ,EAAC,IAAA,qBAAO,GAAE,CAAC;CACnC,CAAC,CAAC;AAIH,MAAM,YAAY,GAAG,IAAA,oBAAM,EAAC;IAC1B,QAAQ,EAAE,IAAA,sBAAQ,EAAC,IAAA,mBAAK,EAAC,IAAA,oBAAM,GAAE,CAAC,CAAC;IACnC,OAAO,EAAE,IAAA,sBAAQ,EAAC,IAAA,mBAAK,EAAC,YAAY,CAAC,CAAC;IACtC,QAAQ,EAAE,IAAA,sBAAQ,EAAC,IAAA,oBAAM,GAAE,CAAC;IAC5B,UAAU,EAAE,IAAA,sBAAQ,EAAC,IAAA,iBAAG,EAAC,IAAA,qBAAO,GAAE,EAAE,CAAC,CAAC,CAAC;CACxC,CAAC,CAAC;AAUI,KAAK,UAAU,kBAAkB,CACtC,GAAW,EACX,QAAkB;IAElB,OAAO,IAAA,mBAAI,EAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;AACnD,CAAC;AALD,gDAKC;AAOM,KAAK,UAAU,UAAU,CAAC,EAC/B,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,EACnB,IAAI,GACc;IAClB,MAAM,cAAc,GAAG,CAAC,CAAC,IAAI,CAAC;IAC9B,MAAM,UAAU,GAAG,IAAA,cAAO,EAAC,GAAG,EAAE,IAAI,IAAI,gBAAgB,CAAC,CAAC;IAE1D,KAAK,CAAC,qBAAqB,EAAE,UAAU,CAAC,CAAC;IAEzC,MAAM,IAAI,GAAG,MAAM,CAAC,GAAG,EAAE;QACvB,IAAI,cAAc;YAAE,OAAO,IAAA,gBAAQ,EAAC,UAAU,CAAC,CAAC;QAChD,OAAO,IAAA,mBAAW,EAAC,UAAU,CAAC,CAAC;IACjC,CAAC,CAAC,EAAE,CAAC;IAEL,MAAM,MAAM,GAAG,IAAA,sBAAQ,EAAC,IAAI,EAAE,YAAY,CAAC,CAAC;IAE5C,IAAI,MAAM,CAAC,CAAC,CAAC,EAAE;QACb,MAAM,MAAM,CAAC,CAAC,CAAC,CAAC;KACjB;IAED,MAAM,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IAEzB,OAAO;QACL,GAAG,MAAM;QACT,GAAG;QACH,QAAQ,EAAE,MAAM,kBAAkB,CAChC,IAAA,cAAO,EAAC,UAAU,CAAC,EACnB,MAAM,CAAC,QAAQ,IAAI,EAAE,CACtB;KACF,CAAC;AACJ,CAAC;AA9BD,gCA8BC"}
\ No newline at end of file
+{"version":3,"file":"config.js","sourceRoot":"","sources":["../src/config.ts"],"names":[],"mappings":";;;;AAAA,+BAAwC;AACxC,6CAWqB;AACrB,4DAA4B;AAC5B,mCAAgD;AAChD,kEAA6B;AAE7B,MAAM,KAAK,GAAG,eAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAErC,MAAM,YAAY,GAAG,IAAA,kBAAI,EAAC;IACxB,OAAO,EAAE,IAAA,sBAAQ,EAAC,IAAA,oBAAM,GAAE,CAAC;IAC3B,UAAU,EAAE,IAAA,sBAAQ,EAAC,IAAA,oBAAM,GAAE,CAAC;IAC9B,aAAa,EAAE,IAAA,sBAAQ,EAAC,IAAA,qBAAO,GAAE,CAAC;CACnC,CAAC,CAAC;AAIH,MAAM,YAAY,GAAG,IAAA,oBAAM,EAAC;IAC1B,QAAQ,EAAE,IAAA,sBAAQ,EAAC,IAAA,mBAAK,EAAC,IAAA,oBAAM,GAAE,CAAC,CAAC;IACnC,OAAO,EAAE,IAAA,sBAAQ,EAAC,IAAA,mBAAK,EAAC,YAAY,CAAC,CAAC;IACtC,QAAQ,EAAE,IAAA,sBAAQ,EAAC,IAAA,oBAAM,GAAE,CAAC;IAC5B,UAAU,EAAE,IAAA,sBAAQ,EAAC,IAAA,iBAAG,EAAC,IAAA,qBAAO,GAAE,EAAE,CAAC,CAAC,CAAC;CACxC,CAAC,CAAC;AAUI,KAAK,UAAU,kBAAkB,CACtC,GAAW,EACX,QAAkB;IAElB,OAAO,IAAA,mBAAI,EAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;AACnD,CAAC;AALD,gDAKC;AAOM,KAAK,UAAU,UAAU,CAAC,EAC/B,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,EACnB,IAAI,GACc;IAClB,MAAM,cAAc,GAAG,CAAC,CAAC,IAAI,CAAC;IAC9B,MAAM,UAAU,GAAG,IAAA,cAAO,EAAC,GAAG,EAAE,IAAI,IAAI,gBAAgB,CAAC,CAAC;IAE1D,KAAK,CAAC,qBAAqB,EAAE,UAAU,CAAC,CAAC;IAEzC,MAAM,IAAI,GAAG,MAAM,CAAC,GAAG,EAAE;QACvB,IAAI,cAAc;YAAE,OAAO,IAAA,gBAAQ,EAAC,UAAU,CAAC,CAAC;QAChD,OAAO,IAAA,mBAAW,EAAC,UAAU,CAAC,CAAC;IACjC,CAAC,CAAC,EAAE,CAAC;IAEL,MAAM,MAAM,GAAG,IAAA,sBAAQ,EAAC,IAAI,EAAE,YAAY,CAAC,CAAC;IAE5C,IAAI,MAAM,CAAC,CAAC,CAAC,EAAE;QACb,MAAM,MAAM,CAAC,CAAC,CAAC,CAAC;KACjB;IAED,MAAM,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IAEzB,OAAO;QACL,GAAG,MAAM;QACT,GAAG;QACH,QAAQ,EAAE,MAAM,kBAAkB,CAChC,IAAA,cAAO,EAAC,UAAU,CAAC,EACnB,MAAM,CAAC,QAAQ,IAAI,EAAE,CACtB;KACF,CAAC;AACJ,CAAC;AA9BD,gCA8BC"}
\ No newline at end of file
diff --git a/dist/transformers/rewriteDtsImport.d.ts b/dist/transformers/rewriteDtsImport.d.ts
new file mode 100644
index 0000000000000000000000000000000000000000..8596724b2cf28554d1b82ef1038144fbe18b7218
--- /dev/null
+++ b/dist/transformers/rewriteDtsImport.d.ts
@@ -0,0 +1,3 @@
+import ts from "typescript";
+import { RewriteImportTransformerOptions } from "./rewriteImport";
+export declare function createRewriteDtsImportTransformer(options: RewriteImportTransformerOptions): ts.TransformerFactory<ts.SourceFile | ts.Bundle>;
diff --git a/dist/transformers/rewriteDtsImport.js b/dist/transformers/rewriteDtsImport.js
new file mode 100644
index 0000000000000000000000000000000000000000..9aae4de9296dc59a1a640c43ab68abfb37140c2f
--- /dev/null
+++ b/dist/transformers/rewriteDtsImport.js
@@ -0,0 +1,78 @@
+"use strict";
+Object.defineProperty(exports, "__esModule", { value: true });
+exports.createRewriteDtsImportTransformer = void 0;
+const tslib_1 = require("tslib");
+const path_1 = require("path");
+const typescript_1 = tslib_1.__importDefault(require("typescript"));
+const utils_1 = require("../utils");
+const JS_EXT = ".js";
+const JSON_EXT = ".json";
+function isRelativePath(path) {
+    return path.startsWith("./") || path.startsWith("../");
+}
+function createRewriteDtsImportTransformer(options) {
+    const { sys, factory, isStringLiteral, isImportDeclaration, isCallExpression, SyntaxKind, visitNode, visitEachChild, isIdentifier, isExportDeclaration, } = options.ts;
+    function isDirectory(sourceFile, path) {
+        const sourcePath = sourceFile.fileName;
+        const fullPath = (0, path_1.resolve)((0, path_1.dirname)(sourcePath), path);
+        return sys.directoryExists(fullPath);
+    }
+    function updateModuleSpecifier(ctx, sourceFile, node) {
+        if (!isStringLiteral(node) || !isRelativePath(node.text))
+            return node;
+        const ext = (0, path_1.extname)(node.text);
+        if (ext === ".cjs") {
+            return factory.createStringLiteral(node.text);
+        }
+        if (isDirectory(sourceFile, node.text)) {
+            return factory.createStringLiteral(`${node.text}/index${options.extname}`);
+        }
+        if (ext === JSON_EXT && ctx.getCompilerOptions().resolveJsonModule) {
+            return node;
+        }
+        const base = ext === JS_EXT ? (0, utils_1.trimSuffix)(node.text, JS_EXT) : node.text;
+        return factory.createStringLiteral(`${base}${options.extname}`);
+    }
+    return (ctx) => {
+        let sourceFile;
+        const visitor = (node) => {
+            // ESM import
+            if (isImportDeclaration(node)) {
+                return factory.createImportDeclaration(node.modifiers, node.importClause, updateModuleSpecifier(ctx, sourceFile, node.moduleSpecifier), node.assertClause);
+            }
+            // ESM export
+            if (isExportDeclaration(node)) {
+                if (!node.moduleSpecifier)
+                    return node;
+                return factory.createExportDeclaration(node.modifiers, node.isTypeOnly, node.exportClause, updateModuleSpecifier(ctx, sourceFile, node.moduleSpecifier), node.assertClause);
+            }
+            // ESM dynamic import
+            if (isCallExpression(node) &&
+                node.expression.kind === SyntaxKind.ImportKeyword) {
+                const [firstArg, ...restArg] = node.arguments;
+                if (!firstArg)
+                    return node;
+                return factory.createCallExpression(node.expression, node.typeArguments, [updateModuleSpecifier(ctx, sourceFile, firstArg), ...restArg]);
+            }
+            // CommonJS require
+            if (isCallExpression(node) &&
+                isIdentifier(node.expression) &&
+                node.expression.escapedText === "require") {
+                const [firstArg, ...restArgs] = node.arguments;
+                if (!firstArg)
+                    return node;
+                return factory.createCallExpression(node.expression, node.typeArguments, [updateModuleSpecifier(ctx, sourceFile, firstArg), ...restArgs]);
+            }
+            return visitEachChild(node, visitor, ctx);
+        };
+        return (file) => {
+            if (file.kind === typescript_1.default.SyntaxKind.Bundle) {
+                throw new Error(`Doesn't work on bundles.`);
+            }
+            sourceFile = file;
+            return visitNode(file, visitor);
+        };
+    };
+}
+exports.createRewriteDtsImportTransformer = createRewriteDtsImportTransformer;
+//# sourceMappingURL=rewriteDtsImport.js.map
\ No newline at end of file
diff --git a/dist/transformers/rewriteDtsImport.js.map b/dist/transformers/rewriteDtsImport.js.map
new file mode 100644
index 0000000000000000000000000000000000000000..dbff5a5dc81e5646576f3098e894df48dbf292cc
--- /dev/null
+++ b/dist/transformers/rewriteDtsImport.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"rewriteDtsImport.js","sourceRoot":"","sources":["../../src/transformers/rewriteDtsImport.ts"],"names":[],"mappings":";;;;AAAA,+BAAiD;AACjD,oEAA4B;AAC5B,oCAAsC;AAGtC,MAAM,MAAM,GAAG,KAAK,CAAC;AACrB,MAAM,QAAQ,GAAG,OAAO,CAAC;AAEzB,SAAS,cAAc,CAAC,IAAY;IAClC,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AACzD,CAAC;AACD,SAAgB,iCAAiC,CAC/C,OAAwC;IAExC,MAAM,EACJ,GAAG,EACH,OAAO,EACP,eAAe,EACf,mBAAmB,EACnB,gBAAgB,EAChB,UAAU,EACV,SAAS,EACT,cAAc,EACd,YAAY,EACZ,mBAAmB,GACpB,GAAG,OAAO,CAAC,EAAE,CAAC;IAEf,SAAS,WAAW,CAAC,UAAyB,EAAE,IAAY;QAC1D,MAAM,UAAU,GAAG,UAAU,CAAC,QAAQ,CAAC;QACvC,MAAM,QAAQ,GAAG,IAAA,cAAO,EAAC,IAAA,cAAO,EAAC,UAAU,CAAC,EAAE,IAAI,CAAC,CAAC;QAEpD,OAAO,GAAG,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;IACvC,CAAC;IAED,SAAS,qBAAqB,CAC5B,GAA6B,EAC7B,UAAyB,EACzB,IAAmB;QAEnB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,CAAC;QAEtE,MAAM,GAAG,GAAG,IAAA,cAAO,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAI,GAAG,KAAK,MAAM,EAAE;YAClB,OAAO,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC/C;QAED,IAAI,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;YACtC,OAAO,OAAO,CAAC,mBAAmB,CAChC,GAAG,IAAI,CAAC,IAAI,SAAS,OAAO,CAAC,OAAO,EAAE,CACvC,CAAC;SACH;QAED,IAAI,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,kBAAkB,EAAE,CAAC,iBAAiB,EAAE;YAClE,OAAO,IAAI,CAAC;SACb;QAED,MAAM,IAAI,GAAG,GAAG,KAAK,MAAM,CAAC,CAAC,CAAC,IAAA,kBAAU,EAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;QAExE,OAAO,OAAO,CAAC,mBAAmB,CAAC,GAAG,IAAI,GAAG,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;IAClE,CAAC;IAED,OAAO,CAAC,GAAG,EAAE,EAAE;QACb,IAAI,UAAyB,CAAC;QAE9B,MAAM,OAAO,GAAe,CAAC,IAAI,EAAE,EAAE;YACnC,aAAa;YACb,IAAI,mBAAmB,CAAC,IAAI,CAAC,EAAE;gBAC7B,OAAO,OAAO,CAAC,uBAAuB,CACpC,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,YAAY,EACjB,qBAAqB,CAAC,GAAG,EAAE,UAAU,EAAE,IAAI,CAAC,eAAe,CAAC,EAC5D,IAAI,CAAC,YAAY,CAClB,CAAC;aACH;YAED,aAAa;YACb,IAAI,mBAAmB,CAAC,IAAI,CAAC,EAAE;gBAC7B,IAAI,CAAC,IAAI,CAAC,eAAe;oBAAE,OAAO,IAAI,CAAC;gBAEvC,OAAO,OAAO,CAAC,uBAAuB,CACpC,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,YAAY,EACjB,qBAAqB,CAAC,GAAG,EAAE,UAAU,EAAE,IAAI,CAAC,eAAe,CAAC,EAC5D,IAAI,CAAC,YAAY,CAClB,CAAC;aACH;YAED,qBAAqB;YACrB,IACE,gBAAgB,CAAC,IAAI,CAAC;gBACtB,IAAI,CAAC,UAAU,CAAC,IAAI,KAAK,UAAU,CAAC,aAAa,EACjD;gBACA,MAAM,CAAC,QAAQ,EAAE,GAAG,OAAO,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;gBAC9C,IAAI,CAAC,QAAQ;oBAAE,OAAO,IAAI,CAAC;gBAE3B,OAAO,OAAO,CAAC,oBAAoB,CACjC,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,aAAa,EAClB,CAAC,qBAAqB,CAAC,GAAG,EAAE,UAAU,EAAE,QAAQ,CAAC,EAAE,GAAG,OAAO,CAAC,CAC/D,CAAC;aACH;YAED,mBAAmB;YACnB,IACE,gBAAgB,CAAC,IAAI,CAAC;gBACtB,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC;gBAC7B,IAAI,CAAC,UAAU,CAAC,WAAW,KAAK,SAAS,EACzC;gBACA,MAAM,CAAC,QAAQ,EAAE,GAAG,QAAQ,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;gBAC/C,IAAI,CAAC,QAAQ;oBAAE,OAAO,IAAI,CAAC;gBAE3B,OAAO,OAAO,CAAC,oBAAoB,CACjC,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,aAAa,EAClB,CAAC,qBAAqB,CAAC,GAAG,EAAE,UAAU,EAAE,QAAQ,CAAC,EAAE,GAAG,QAAQ,CAAC,CAChE,CAAC;aACH;YAED,OAAO,cAAc,CAAC,IAAI,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;QAC5C,CAAC,CAAC;QAEF,OAAO,CAAC,IAAI,EAAE,EAAE;YACd,IAAI,IAAI,CAAC,IAAI,KAAK,oBAAE,CAAC,UAAU,CAAC,MAAM,EAAE;gBACtC,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;aAC7C;YACD,UAAU,GAAG,IAAI,CAAC;YAClB,OAAO,SAAS,CAAC,IAAI,EAAE,OAAO,CAAkB,CAAC;QACnD,CAAC,CAAC;IACJ,CAAC,CAAC;AACJ,CAAC;AAvHD,8EAuHC"}
\ No newline at end of file
diff --git a/dist/transformers/rewriteImport.d.ts b/dist/transformers/rewriteImport.d.ts
index a6d656cda3819422a97c677a14efd38c41b38679..9f222d6ebf87be553780a7e3983a50f20182b424 100644
--- a/dist/transformers/rewriteImport.d.ts
+++ b/dist/transformers/rewriteImport.d.ts
@@ -1,6 +1,7 @@
 import type ts from "typescript";
 export interface RewriteImportTransformerOptions {
     extname: string;
+    dtsExtName: string;
     system: ts.System;
     ts: typeof ts;
 }
diff --git a/dist/transformers/rewriteImport.js.map b/dist/transformers/rewriteImport.js.map
index cf63753617c5f317c9fe38a44b38a5d16a8dc89c..aa138b77eda8ba42d416cb1e5547202f796e78a2 100644
--- a/dist/transformers/rewriteImport.js.map
+++ b/dist/transformers/rewriteImport.js.map
@@ -1 +1 @@
-{"version":3,"file":"rewriteImport.js","sourceRoot":"","sources":["../../src/transformers/rewriteImport.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"rewriteImport.js","sourceRoot":"","sources":["../../src/transformers/rewriteImport.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/worker/entry.d.ts b/dist/worker/entry.d.ts
old mode 100755
new mode 100644
diff --git a/dist/worker/types.d.ts b/dist/worker/types.d.ts
index 6c8ec0e0c3b6ff0dd2421f3e68807d56de224558..a8ee1b37ef4547fa37637ff1e4f822d0e0b1e6e9 100644
--- a/dist/worker/types.d.ts
+++ b/dist/worker/types.d.ts
@@ -2,6 +2,7 @@ import { Target } from "../config";
 export interface WorkerOptions {
     target: Omit<Target, "extname">;
     extname?: string;
+    dtsExtName?: string;
     verbose?: boolean;
     dry?: boolean;
     force?: boolean;
diff --git a/dist/worker/types.js b/dist/worker/types.js
old mode 100755
new mode 100644
diff --git a/dist/worker/worker.d.ts b/dist/worker/worker.d.ts
index c003cdc782c302b8d4b28bda2d631bc6ade20788..dc838a610f0f5850e825f9783962983dbee7c70c 100644
--- a/dist/worker/worker.d.ts
+++ b/dist/worker/worker.d.ts
@@ -8,7 +8,13 @@ export declare class Worker {
     constructor(data: WorkerOptions, system?: ts.System);
     run(): number;
     private getJSPath;
+    private getDtsPath;
     private getJSMapPath;
+    private getDtsMapPath;
+    /**
+     * Rewrites an output file path based on its extension. If ignoreDts is true, then paths to .d.ts files will not be
+     * rewritten. This is used so that .d.ts file paths are only rewritten under specific circumstances.
+     */
     private rewritePath;
     private rewriteSourceMappingURL;
     private rewriteSourceMap;
diff --git a/dist/worker/worker.js b/dist/worker/worker.js
index 120865b0bca77f07f51b3d3e622ee269b9a1a24c..82baa55dd386b3dc78a66055ab6ce92537d43835 100644
--- a/dist/worker/worker.js
+++ b/dist/worker/worker.js
@@ -6,10 +6,13 @@ const debug_1 = tslib_1.__importDefault(require("./debug"));
 const report_1 = require("../report");
 const utils_1 = require("../utils");
 const rewriteImport_1 = require("../transformers/rewriteImport");
+const rewriteDtsImport_1 = require("../transformers/rewriteDtsImport");
 const path_1 = require("path");
 const JS_EXT = ".js";
 const MAP_EXT = ".map";
 const JS_MAP_EXT = `${JS_EXT}${MAP_EXT}`;
+const DTS_EXT = ".d.ts";
+const DTS_MAP_EXT = `${DTS_EXT}${MAP_EXT}`;
 function loadCompiler(cwd, name = "typescript") {
     const path = require.resolve(name, { paths: [cwd, __dirname] });
     return require(path);
@@ -43,31 +46,82 @@ class Worker {
             return path;
         return (0, utils_1.trimSuffix)(path, JS_EXT) + this.data.extname;
     }
+    getDtsPath(path) {
+        if (!this.data.dtsExtName)
+            return path;
+        return (0, utils_1.trimSuffix)(path, DTS_EXT) + this.data.dtsExtName;
+    }
     getJSMapPath(path) {
         if (!this.data.extname)
             return path;
         return (0, utils_1.trimSuffix)(path, JS_MAP_EXT) + this.data.extname + MAP_EXT;
     }
-    rewritePath(path) {
+    getDtsMapPath(path) {
+        if (!this.data.dtsExtName)
+            return path;
+        return (0, utils_1.trimSuffix)(path, DTS_MAP_EXT) + this.data.dtsExtName + MAP_EXT;
+    }
+    /**
+     * Rewrites an output file path based on its extension. If ignoreDts is true, then paths to .d.ts files will not be
+     * rewritten. This is used so that .d.ts file paths are only rewritten under specific circumstances.
+     */
+    rewritePath(path, ignoreDts = false) {
         if (path.endsWith(JS_EXT)) {
             return this.getJSPath(path);
         }
         if (path.endsWith(JS_MAP_EXT)) {
             return this.getJSMapPath(path);
         }
+        if (ignoreDts === false) {
+            if (path.endsWith(DTS_EXT)) {
+                return this.getDtsPath(path);
+            }
+            if (path.endsWith(DTS_MAP_EXT)) {
+                return this.getDtsMapPath(path);
+            }
+        }
         return path;
     }
     rewriteSourceMappingURL(data) {
-        return data.replace(/\/\/# sourceMappingURL=(.+)/g, (_, path) => `//# sourceMappingURL=${this.getJSMapPath(path)}`);
+        return data.replace(/\/\/# sourceMappingURL=(.+)/g, (_, path) => {
+            (0, debug_1.default)(`replacing sourceMapUrl path: ${path} ==> ${this.rewritePath(path)}`);
+            return `//# sourceMappingURL=${this.rewritePath(path)}`;
+        });
     }
     rewriteSourceMap(data) {
         const json = JSON.parse(data);
-        json.file = this.getJSPath(json.file);
+        (0, debug_1.default)(`rewriting sourcemap: ${json.file} ==> ${this.rewritePath(json.file)}`);
+        json.file = this.rewritePath(json.file);
         return JSON.stringify(json);
     }
     createSystem(sys) {
         const getReadPaths = (path) => {
-            const paths = [this.rewritePath(path)];
+            /**
+             * When reading paths, we don't want to rewrite the paths to DTS files, so we pass `true` to ignoreDts. If we
+             * rewrite dts paths here, we get compilation failures like this:
+             *
+             * [mjs]: error TS6053: File 'FluidFramework/node_modules/.pnpm/typescript@5.1.6/node_modules/typescript/lib/lib.dom.d.ts' not found.
+             *   The file is in the program because:
+             *     Library 'lib.dom.d.ts' specified in compilerOptions
+             * [mjs]: error TS6053: File 'FluidFramework/node_modules/.pnpm/typescript@5.1.6/node_modules/typescript/lib/lib.dom.iterable.d.ts' not found.
+             *   The file is in the program because:
+             *     Library 'lib.dom.iterable.d.ts' specified in compilerOptions
+             * [mjs]: error TS6053: File 'FluidFramework/node_modules/.pnpm/typescript@5.1.6/node_modules/typescript/lib/lib.es2020.d.ts' not found.
+             *   The file is in the program because:
+             *     Library 'lib.es2020.d.ts' specified in compilerOptions
+             * [mjs]: error TS2318: Cannot find global type 'Array'.
+             * [mjs]: error TS2318: Cannot find global type 'Boolean'.
+             * [mjs]: error TS2318: Cannot find global type 'CallableFunction'.
+             * [mjs]: error TS2318: Cannot find global type 'Function'.
+             * [mjs]: error TS2318: Cannot find global type 'IArguments'.
+             * [mjs]: error TS2318: Cannot find global type 'NewableFunction'.
+             * [mjs]: error TS2318: Cannot find global type 'Number'.
+             * [mjs]: error TS2318: Cannot find global type 'Object'.
+             * [mjs]: error TS2318: Cannot find global type 'RegExp'.
+             * [mjs]: error TS2318: Cannot find global type 'String'.
+             * [mjs]: Found 13 errors.
+             */
+            const paths = [this.rewritePath(path, true)];
             // Source files may be .js files when `allowJs` is enabled. When a .js
             // file with rewritten path doesn't exist, retry again without rewriting
             // the path.
@@ -87,10 +141,10 @@ class Worker {
             writeFile: (path, data, writeByteOrderMark) => {
                 const newPath = this.rewritePath(path);
                 const newData = (() => {
-                    if (path.endsWith(JS_EXT)) {
+                    if (path.endsWith(JS_EXT) || path.endsWith(DTS_EXT)) {
                         return this.rewriteSourceMappingURL(data);
                     }
-                    if (path.endsWith(JS_MAP_EXT)) {
+                    if (path.endsWith(JS_MAP_EXT) || path.endsWith(DTS_MAP_EXT)) {
                         return this.rewriteSourceMap(data);
                     }
                     return data;
@@ -123,15 +177,36 @@ class Worker {
     }
     patchSolutionBuilderHost(host) {
         const { createProgram, reportDiagnostic } = host;
-        const transformers = {
-            after: [
-                (0, rewriteImport_1.createRewriteImportTransformer)({
-                    extname: this.data.extname || JS_EXT,
-                    system: this.system,
-                    ts: this.ts,
-                }),
-            ],
-        };
+        (0, debug_1.default)(`dtsExtName === ${this.data.dtsExtName}`);
+        const transformers = this.data.dtsExtName !== undefined
+            ? {
+                after: [
+                    (0, rewriteImport_1.createRewriteImportTransformer)({
+                        extname: this.data.extname || JS_EXT,
+                        dtsExtName: this.data.dtsExtName || DTS_EXT,
+                        system: this.system,
+                        ts: this.ts,
+                    }),
+                ],
+                afterDeclarations: [
+                    (0, rewriteDtsImport_1.createRewriteDtsImportTransformer)({
+                        extname: this.data.extname || JS_EXT,
+                        dtsExtName: this.data.dtsExtName || DTS_EXT,
+                        system: this.system,
+                        ts: this.ts,
+                    }),
+                ],
+            }
+            : {
+                after: [
+                    (0, rewriteImport_1.createRewriteImportTransformer)({
+                        extname: this.data.extname || JS_EXT,
+                        dtsExtName: this.data.dtsExtName || DTS_EXT,
+                        system: this.system,
+                        ts: this.ts,
+                    }),
+                ],
+            };
         const parseConfigFileHost = {
             ...this.system,
             onUnRecoverableConfigFileDiagnostic(diagnostic) {
@@ -185,6 +260,7 @@ class Worker {
             after: [
                 (0, rewriteImport_1.createRewriteImportTransformer)({
                     extname: this.data.extname || JS_EXT,
+                    dtsExtName: this.data.dtsExtName || DTS_EXT,
                     system: this.system,
                     ts: this.ts,
                 }),
diff --git a/dist/worker/worker.js.map b/dist/worker/worker.js.map
index b529fdc74806d8a32bc9785cd95cc37b357939de..c71a0c254435a1eaa5cce2f5d3cedb50d49f49ab 100644
--- a/dist/worker/worker.js.map
+++ b/dist/worker/worker.js.map
@@ -1 +1 @@
-{"version":3,"file":"worker.js","sourceRoot":"","sources":["../../src/worker/worker.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"worker.js","sourceRoot":"","sources":["../../src/worker/worker.ts"],"names":[],"mappings":"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"}