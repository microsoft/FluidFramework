<!-- THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY. -->

# Fluid Framework v2.82.0

## Contents

- [üå≥ SharedTree DDS Changes](#-sharedtree-dds-changes)
  - [Add "push" as alias for insertAtEnd on TreeArrayNode (#26260)](#add-push-as-alias-for-insertatend-on-treearraynode-26260)
  - [Adds optional "label" parameter to runTransaction for grouping changes (#25938)](#adds-optional-label-parameter-to-runtransaction-for-grouping-changes-25938)
  - [Fix bug in multi-step move of array elements (#26344)](#fix-bug-in-multi-step-move-of-array-elements-26344)
  - [Promote MinimumVersionForCollab to beta (#26342)](#promote-minimumversionforcollab-to-beta-26342)
  - [Promote TableSchema APIs to beta (#26339)](#promote-tableschema-apis-to-beta-26339)

## üå≥ SharedTree DDS Changes

### Add "push" as alias for insertAtEnd on TreeArrayNode ([#26260](https://github.com/microsoft/FluidFramework/issues/26260))

Adds `push` as an alias to make the API more intuitive and reduce friction for both `LLM`-generated code and developers familiar with JavaScript array semantics.

#### Usage

```typescript
import { TreeArrayNode } from "@fluidframework/tree";

// `inventory` is a TreeArrayNode from your schema.
inventory.push({ name: "Apples", quantity: 3 });

// Insert multiple items in one call.
inventory.push(
  TreeArrayNode.spread([
    { name: "Oranges", quantity: 2 },
    { name: "Bananas", quantity: 5 },
  ]),
);
```

#### Change details

Commit: [`e2ed71b`](https://github.com/microsoft/FluidFramework/commit/e2ed71b014d44762e433841cada4667dd501e9c1)

Affected packages:

- fluid-framework
- @fluidframework/tree

[‚¨ÜÔ∏è Table of contents](#contents)

### Adds optional "label" parameter to runTransaction for grouping changes ([#25938](https://github.com/microsoft/FluidFramework/issues/25938))

Transaction labels can be used to group multiple changes for undo/redo, where groups of changes with the same label can be undone together. When multiple labels are used in nested transactions, only the outermost label will be used.

The following example demonstrates how to implement label-based undo/redo grouping. It listens to the `changed` event on the checkout to collect all commits with the same label into a group. When `undoLatestGroup()` is called, all transactions in that group are reverted together with a single operation.

```typescript
interface LabeledGroup {
  label: unknown;
  revertibles: { revert(): void }[];
}

const undoGroups: LabeledGroup[] = [];

// The callback on the "changed" event can be used to group the commits.
view.checkout.events.on("changed", (meta, getRevertible) => {
  // Only process local edits, not remote changes or Undo/Redo operations
  if (getRevertible !== undefined && meta.kind === CommitKind.Default) {
    const label = meta.label;
    const revertible = getRevertible();

    // Check if the latest group contains the same label.
    const latestGroup = undoGroups[undoGroups.length - 1];
    if (
      label !== undefined &&
      latestGroup !== undefined &&
      label === latestGroup.label
    ) {
      latestGroup.revertibles.push(revertible);
    } else {
      undoGroups.push({ label, revertibles: [revertible] });
    }
  }
});

const undoLatestGroup = () => {
  const latestGroup =
    undoGroups.pop() ?? fail("There are currently no undo groups.");
  for (const revertible of latestGroup.revertibles.reverse()) {
    revertible.revert();
  }
};

// Group multiple transactions with the same label
view.runTransaction(
  () => {
    view.root.content = 1;
  },
  { label: "EditGroup" },
);
view.runTransaction(
  () => {
    view.root.content = 2;
  },
  { label: "EditGroup" },
);
view.runTransaction(
  () => {
    view.root.content = 3;
  },
  { label: "EditGroup" },
);

// This would undo all three transactions together.
undoLatestGroup();
// view.root.content is now back to 0 (the initial state).
```

#### Change details

Commit: [`cca4db2`](https://github.com/microsoft/FluidFramework/commit/cca4db29c722aca3fbfa5c0b45a852cd8499a17a)

Affected packages:

- fluid-framework
- @fluidframework/tree

[‚¨ÜÔ∏è Table of contents](#contents)

### Fix bug in multi-step move of array elements ([#26344](https://github.com/microsoft/FluidFramework/issues/26344))

A multi-step move can be authored by moving the same array element multiple times within the scope of a single transaction. Such multi-step would lead to errors in the following scenarios:

- Reverting a multi-step move would fail with error code 0x92a on the peer attempting the revert, thus putting the peer in a broken read-only state without corrupting the document.
- If the set of pending edits generated by a peer included an edit with a multi-step move, followed by further edits to any of the moved items, reconciling these edits with concurrent edits sequenced earlier could lead to a document corruption with error code 0x9c7.

These operations are now safe.

#### Change details

Commit: [`1bca56c`](https://github.com/microsoft/FluidFramework/commit/1bca56c3fb2ade3ad876e8761366053e5295490b)

Affected packages:

- fluid-framework
- @fluidframework/tree

[‚¨ÜÔ∏è Table of contents](#contents)

### Promote MinimumVersionForCollab to beta ([#26342](https://github.com/microsoft/FluidFramework/issues/26342))

Promotes the [MinimumVersionForCollab](https://fluidframework.com/docs/api/runtime-definitions/minimumversionforcollab-typealias) type to beta, and adds option to [configuredSharedTreeBeta](https://fluidframework.com/docs/api/fluid-framework#configuredsharedtreebeta-function) for specifying it when creating a new `SharedTree`.

This allows users to opt into new features and optimizations that are only available when certain minimum version thresholds are guaranteed. For more details, see [FluidClientVersion](https://fluidframework.com/docs/api/fluid-framework#fluidclientversion-variable)

#### Example usage

```typescript
// Configure SharedTree DDS to limit the features it requires of collaborators and future document users to only those available in version `2.80.0` and later, overriding the `MinimumVersionForCollab` provided by the runtime (default: "2.0.0").
// Edits made to this DDS by this client might cause clients older than the specified version to be unable to open the document and/or error out of collaboration sessions.
const SharedTree = configuredSharedTreeBeta({
  minVersionForCollab: FluidClientVersion.v2_80,
});
```

#### Change details

Commit: [`2bb53c5`](https://github.com/microsoft/FluidFramework/commit/2bb53c5c3f1aa9e3232d4a1f1e4a6a32d09248eb)

Affected packages:

- fluid-framework
- @fluidframework/tree

[‚¨ÜÔ∏è Table of contents](#contents)

### Promote TableSchema APIs to beta ([#26339](https://github.com/microsoft/FluidFramework/issues/26339))

Promotes the `SharedTree` [TableSchema](https://fluidframework.com/docs/api/fluid-framework/tableschema-namespace) from alpha to beta. These APIs can now be imported via `@fluidframework/tree/beta`. Documents from before this are not supported with the beta version of the schema to ensure orphan cell invariants can be guaranteed.

#### Change details

Commit: [`36a625a`](https://github.com/microsoft/FluidFramework/commit/36a625a305878a267d2010ace377ff0d80d3367d)

Affected packages:

- fluid-framework
- @fluidframework/tree

[‚¨ÜÔ∏è Table of contents](#contents)

### üõ†Ô∏è Start Building Today!

Please continue to engage with us on GitHub [Discussion](https://github.com/microsoft/FluidFramework/discussions) and [Issue](https://github.com/microsoft/FluidFramework/issues) pages as you adopt Fluid Framework!
