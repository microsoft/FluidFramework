<!-- THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY. -->

# Fluid Framework v2.51.0

## Contents

- [üö® Breaking Changes](#-breaking-changes)
  - [@fluid-experimental/attributable-map package removed (#25019)](#fluid-experimentalattributable-map-package-removed-25019)
- [üå≥ SharedTree DDS Changes](#-sharedtree-dds-changes)
  - [Fix adaptEnum's handling of numeric enums (#24957)](#fix-adaptenums-handling-of-numeric-enums-24957)
  - ["rootChanged" event is no longer skipped if first change is setting the root to undefined (#24994)](#rootchanged-event-is-no-longer-skipped-if-first-change-is-setting-the-root-to-undefined-24994)
  - [Make POJO mode TreeArrayNodes report the array constructor as their constructor (#24988)](#make-pojo-mode-treearraynodes-report-the-array-constructor-as-their-constructor-24988)
- [Legacy API Changes](#legacy-api-changes)
  - [New "getSnapshotTree" API on "IChannelStorageService" (#24970)](#new-getsnapshottree-api-on-ichannelstorageservice-24970)
  - [New "PureDataObject" implementation "TreeDataObject" added (#25025)](#new-puredataobject-implementation-treedataobject-added-25025)
  - [Add API for tree-based root data object (#25030)](#add-api-for-tree-based-root-data-object-25030)

## üö® Breaking Changes

### @fluid-experimental/attributable-map package removed ([#25019](https://github.com/microsoft/FluidFramework/issues/25019))

The @fluid-experimental/attributable-map package has been removed without replacement.

#### Change details

Commit: [`c8bbd6d`](https://github.com/microsoft/FluidFramework/commit/c8bbd6d6ecc9b0e9a92710e2a0ce7103ffd57c8b)

Affected packages:

- @fluid-experimental/attributable-map

[‚¨ÜÔ∏è Table of contents](#contents)

## üå≥ SharedTree DDS Changes

### Fix adaptEnum's handling of numeric enums ([#24957](https://github.com/microsoft/FluidFramework/issues/24957))

Enum entries whose values are numeric get additional properties on TypeScript's generated Enum object. These values were getting treated like enum entries at runtime by `adaptEnum` (`@beta`). This has been fixed and the runtime behavior now matches the types in this case.

If any documents were created with this API which were impacted by this bug and keeping them openable is required, they will need a workaround. Impacted schema using the union from `adaptEnum` can need to be updated to explicitly include the previously erroneously generated schema.

Before:

```typescript
enum Mode {
  a = 1,
}
const ModeNodes = adaptEnum(schemaFactory, Mode);
const union = ModeNodes.schema;
```

After:

```typescript
enum Mode {
  a = 1,
}
const ModeNodes = adaptEnum(schemaFactory, Mode);
// Bugged version of adaptEnum used to include this: it should not be used but must be included in the schema for legacy document compatibility.
class Workaround extends schemaFactory.object("a", {}) {}
const union = [...ModeNodes.schema, Workaround] as const;
```

To help detect when schema contain unexpected content, and to ensure workarounds like this are implemented properly, applications should include tests which check the schema for compatibility. See [tree-cli-app's schema tests](https://github.com/microsoft/FluidFramework/blob/main/examples/apps/tree-cli-app/src/test/schema.spec.ts) for an example of how to do this.

The schema returned by `adaptEnum` have also been updated to `toString` to include the value of the particular enum entry: this has no effect on the nodes, just the schema.

#### Change details

Commit: [`7535d31`](https://github.com/microsoft/FluidFramework/commit/7535d31fa61a535bf58bb88fc597e6e4f64c5b23)

Affected packages:

- @fluidframework/tree
- fluid-framework

[‚¨ÜÔ∏è Table of contents](#contents)

### "rootChanged" event is no longer skipped if first change is setting the root to undefined ([#24994](https://github.com/microsoft/FluidFramework/issues/24994))

A bug has been fixed where [rootChanged](https://fluidframework.com/docs/api/fluid-framework/treeviewevents-interface#rootchanged-methodsignature) would not be fired if the change is the first change since the [TreeView](https://fluidframework.com/docs/api/fluid-framework/treeview-interface) became in-schema, and the change was setting the document root to `undefined`.

#### Change details

Commit: [`e6f2587`](https://github.com/microsoft/FluidFramework/commit/e6f258757947b72b6a9d19c79f5717eccd44452b)

Affected packages:

- @fluidframework/tree
- fluid-framework

[‚¨ÜÔ∏è Table of contents](#contents)

### Make POJO mode TreeArrayNodes report the array constructor as their constructor ([#24988](https://github.com/microsoft/FluidFramework/issues/24988))

Make POJO mode TreeArrayNode's inherited `constructor` property report `Array` instead of the `TreeNodeSchema` class. This is necessary to make `TreeArrayNode`s appear equal to arrays according to NodeJS's `assert.strict.deepEqual` in NodeJS 22.

#### Change details

Commit: [`7b4d0ab`](https://github.com/microsoft/FluidFramework/commit/7b4d0abe90f50075bb06ef73ceceff2529ef78f5)

Affected packages:

- @fluidframework/tree
- fluid-framework

[‚¨ÜÔ∏è Table of contents](#contents)

## Legacy API Changes

### New "getSnapshotTree" API on "IChannelStorageService" ([#24970](https://github.com/microsoft/FluidFramework/issues/24970))

A new API, `getSnapshotTree` has been added to `IChannelStorageService`. It should return the snapshot tree for a channel. This will help channels examine their snapshot when it consists of dynamic trees and blobs, i.e., when the number of tree and blobs and / or their keys are not known in advance. This is optional for backwards compatibility, and will become required in the future.

#### Change details

Commit: [`d1241a4`](https://github.com/microsoft/FluidFramework/commit/d1241a4ef19fa9bbfccc1afc68e6ef13effcb5d9)

Affected packages:

- @fluidframework/datastore-definitions

[‚¨ÜÔ∏è Table of contents](#contents)

### New "PureDataObject" implementation "TreeDataObject" added ([#25025](https://github.com/microsoft/FluidFramework/issues/25025))

A new implementation of `PureDataObject` has been added: `TreeDataObject`. Where `DataObject` stores its contents in a `SharedDirectory`, `TreeDataObject` stores its contents in a `SharedTree`.

#### Change details

Commit: [`f4fbd2f`](https://github.com/microsoft/FluidFramework/commit/f4fbd2f582c22e0b6fd06986b9b5dbb6b73396a4)

Affected packages:

- @fluidframework/aqueduct

[‚¨ÜÔ∏è Table of contents](#contents)

### Add API for tree-based root data object ([#25030](https://github.com/microsoft/FluidFramework/issues/25030))

Adds `createTreeContainerRuntimeFactory` which can be used to create runtime factories which construct containers with an entry point containing a single tree-based root data object.

#### Change details

Commit: [`30a0d7e`](https://github.com/microsoft/FluidFramework/commit/30a0d7ef7b6678e5a5aef45bcebcd5c98471a389)

Affected packages:

- @fluidframework/fluid-static

[‚¨ÜÔ∏è Table of contents](#contents)

### üõ†Ô∏è Start Building Today!

Please continue to engage with us on GitHub [Discussion](https://github.com/microsoft/FluidFramework/discussions) and [Issue](https://github.com/microsoft/FluidFramework/issues) pages as you adopt Fluid Framework!
