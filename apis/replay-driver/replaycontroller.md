{"kind":"Class","title":"ReplayController Class","summary":"Replay controller object It controls where we start (snapshot, local file, no snapshots) As well as dispatch of ops","members":{"Method":{"fetchTo":"/docs/apis/replay-driver/replaycontroller#fetchto-Method","getStartingOpSequence":"/docs/apis/replay-driver/replaycontroller#getstartingopsequence-Method","initStorage":"/docs/apis/replay-driver/replaycontroller#initstorage-Method","isDoneFetch":"/docs/apis/replay-driver/replaycontroller#isdonefetch-Method","replay":"/docs/apis/replay-driver/replaycontroller#replay-Method"}},"package":"@fluidframework/replay-driver","unscopedPackageName":"replay-driver"}

[//]: # (Do not edit this file. It is automatically generated by API Documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/replay-driver](/docs/apis/replay-driver) &gt; [ReplayController](/docs/apis/replay-driver/replaycontroller)

Replay controller object It controls where we start (snapshot, local file, no snapshots) As well as dispatch of ops

<b>Signature:</b>

```typescript
export declare abstract class ReplayController extends ReadDocumentStorageServiceBase 
```
<b>Extends:</b> [ReadDocumentStorageServiceBase](/docs/apis/replay-driver/readdocumentstorageservicebase)

## Methods

<table class="table table-striped table-hover method-list">
<caption>List of methods on this class</caption>
  <thead>
    <tr>
     <th scope="col">Method</th>
 <th scope="col">Modifiers</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href='/docs/apis/replay-driver/replaycontroller#fetchto-Method'>fetchTo(currentOp)</a></td>
      <td></td>
      <td>Returns last op number to fetch from current op Note: this API is called while replay() is in progress - next batch of ops is downloaded in parallel</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/replay-driver/replaycontroller#getstartingopsequence-Method'>getStartingOpSequence()</a></td>
      <td></td>
      <td>Returns sequence number to start processing ops Should be zero if not using snapshot, and snapshot seq# otherwise</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/replay-driver/replaycontroller#initstorage-Method'>initStorage(documentService)</a></td>
      <td></td>
      <td>Initialize reply controller</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/replay-driver/replaycontroller#isdonefetch-Method'>isDoneFetch(currentOp, lastTimeStamp)</a></td>
      <td></td>
      <td>Returns true if no more ops should be processed (or downloaded for future processing). It's called at end of each batch with latest op timestamp. Also it's called when there are no more ops available (lastTimeStamp === undefined). If false is returned and there are no more ops, request for more ops is made every 2 seconds. Note: this API is called while replay() is in progress - next batch of ops is downloaded in parallel</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/replay-driver/replaycontroller#replay-Method'>replay(emitter, fetchedOps)</a></td>
      <td></td>
      <td>Replay batch of ops NOTE: new batch of ops is fetched (fetchTo() & isDoneFetch() APIs are called) while this call is in flights</td>
    </tr>
  </tbody>
</table>

<hr><div id=class-details>

## Method Details {#methods-details}

### fetchTo {#fetchto-Method}

Returns last op number to fetch from current op Note: this API is called while replay() is in progress - next batch of ops is downloaded in parallel

<b>Signature:</b>

```typescript
abstract fetchTo(currentOp: number): number | undefined;
```

#### Parameters {#fetchto-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>currentOp</td>
      <td>number</td>
      <td>current op</td>
    </tr>
  </tbody>
</table>

### getStartingOpSequence {#getstartingopsequence-Method}

Returns sequence number to start processing ops Should be zero if not using snapshot, and snapshot seq\# otherwise

<b>Signature:</b>

```typescript
abstract getStartingOpSequence(): Promise<number>;
```

### initStorage {#initstorage-Method}

Initialize reply controller

<b>Signature:</b>

```typescript
abstract initStorage(documentService: IDocumentService): Promise<boolean>;
```

#### Parameters {#initstorage-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>documentService</td>
      <td><a href='/docs/apis/driver-definitions/idocumentservice'>IDocumentService</a></td>
      <td>the real document service</td>
    </tr>
  </tbody>
</table>

#### Returns {#initstorage-Method-returns}


- Boolean, indicating if controller should be used. If false is returned, caller should fallback to original storage.

<b>Return type(s):</b> Promise&lt;boolean&gt;

### isDoneFetch {#isdonefetch-Method}

Returns true if no more ops should be processed (or downloaded for future processing). It's called at end of each batch with latest op timestamp. Also it's called when there are no more ops available (lastTimeStamp === undefined). If false is returned and there are no more ops, request for more ops is made every 2 seconds. Note: this API is called while replay() is in progress - next batch of ops is downloaded in parallel

<b>Signature:</b>

```typescript
abstract isDoneFetch(currentOp: number, lastTimeStamp?: number): boolean;
```

#### Parameters {#isdonefetch-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>currentOp</td>
      <td>number</td>
      <td>current op</td>
    </tr>
    <tr>
      <td>lastTimeStamp</td>
      <td>number</td>
      <td>timestamp of last op (if more ops are available). Undefined otherwise.</td>
    </tr>
  </tbody>
</table>

### replay {#replay-Method}

Replay batch of ops NOTE: new batch of ops is fetched (fetchTo() &amp; isDoneFetch() APIs are called) while this call is in flights

<b>Signature:</b>

```typescript
abstract replay(emitter: (op: api.ISequencedDocumentMessage[]) => void, fetchedOps: api.ISequencedDocumentMessage[]): Promise<void>;
```

#### Parameters {#replay-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>emitter</td>
      <td>(op: api.<a href='/docs/apis/protocol-definitions/isequenceddocumentmessage'>ISequencedDocumentMessage</a>[]) => void</td>
      <td>callback to emit ops</td>
    </tr>
    <tr>
      <td>fetchedOps</td>
      <td>api.<a href='/docs/apis/protocol-definitions/isequenceddocumentmessage'>ISequencedDocumentMessage</a>[]</td>
      <td>ops to process</td>
    </tr>
  </tbody>
</table>


</div>
