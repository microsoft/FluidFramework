{"kind":"Class","title":"Policy Class","summary":"The policy followed by a [TransactionInternal](/docs/apis/tree/transactioninternal)<!-- -->.","members":{"Method":{"createViewNodesForTree":"/docs/apis/tree/transactioninternal/policy#createviewnodesfortree-Method","dispatchChange":"/docs/apis/tree/transactioninternal/policy#dispatchchange-Method","tryResolveChange":"/docs/apis/tree/transactioninternal/policy#tryresolvechange-Method","validateOnClose":"/docs/apis/tree/transactioninternal/policy#validateonclose-Method"},"Property":{"detached":"/docs/apis/tree/transactioninternal/policy#detached-Property"}},"package":"@fluid-experimental/tree","unscopedPackageName":"tree"}

[//]: # (Do not edit this file. It is automatically generated by API Documenter.)

[Packages](/docs/apis/) &gt; [@fluid-experimental/tree](/docs/apis/tree) &gt; [TransactionInternal](/docs/apis/tree/transactioninternal) &gt; [Policy](/docs/apis/tree/transactioninternal/policy)

The policy followed by a [TransactionInternal](/docs/apis/tree/transactioninternal)<!-- -->.

<b>Signature:</b>

```typescript
export class Policy implements GenericTransactionPolicy 
```
<b>Implements:</b> [GenericTransactionPolicy](/docs/apis/tree/generictransactionpolicy)

## Properties

<table class="table table-striped table-hover property-list">
<caption>List of properties on this class</caption>
  <thead>
    <tr>
     <th scope="col">Property</th>
 <th scope="col">Modifiers</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href='/docs/apis/tree/transactioninternal/policy#detached-Property'>detached</a></td>
      <td></td>
      <td>Map<<a href='/docs/apis/tree#detachedsequenceid-TypeAlias'>DetachedSequenceId</a>, readonly <a href='/docs/apis/tree#nodeid-TypeAlias'>NodeId</a>[]></td>
      <td>Maps detached sequences of nodes to their NodeIds</td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover method-list">
<caption>List of methods on this class</caption>
  <thead>
    <tr>
     <th scope="col">Method</th>
 <th scope="col">Modifiers</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href='/docs/apis/tree/transactioninternal/policy#createviewnodesfortree-Method'>createViewNodesForTree(sequence, onCreateNode, onInvalidDetachedId)</a></td>
      <td></td>
      <td>Generates tree view nodes from the supplied edit nodes. Invokes onCreateNode for each new node, and halts creation early if it returns true. Invokes onInvalidDetachedId and halts early for any invalid detached IDs referenced in the edit node sequence.</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/tree/transactioninternal/policy#dispatchchange-Method'>dispatchChange(state, change)</a></td>
      <td></td>
      <td>Applies a given change</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/tree/transactioninternal/policy#tryresolvechange-Method'>tryResolveChange(state, change)</a></td>
      <td></td>
      <td>Resolves change with Result.Ok</td>
    </tr>
    <tr>
      <td><a href='/docs/apis/tree/transactioninternal/policy#validateonclose-Method'>validateOnClose(state)</a></td>
      <td></td>
      <td>Validates the transaction when it is closed</td>
    </tr>
  </tbody>
</table>

<hr><div id=class-details>

## Property Details {#properties-details}

### detached {#detached-Property}

Maps detached sequences of nodes to their NodeIds

<b>Signature:</b>

```typescript
protected readonly detached: Map<DetachedSequenceId, readonly NodeId[]>;
```

## Method Details {#methods-details}

### createViewNodesForTree {#createviewnodesfortree-Method}

Generates tree view nodes from the supplied edit nodes. Invokes onCreateNode for each new node, and halts creation early if it returns true. Invokes onInvalidDetachedId and halts early for any invalid detached IDs referenced in the edit node sequence.

<b>Signature:</b>

```typescript
protected createViewNodesForTree(sequence: Iterable<BuildNodeInternal>, onCreateNode: (stableId: NodeId, node: TreeViewNode) => boolean, onInvalidDetachedId: (sequenceId: DetachedSequenceId) => void): NodeId[] | undefined;
```

#### Parameters {#createviewnodesfortree-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>sequence</td>
      <td>Iterable<<a href='/docs/apis/tree#buildnodeinternal-TypeAlias'>BuildNodeInternal</a>></td>
      <td></td>
    </tr>
    <tr>
      <td>onCreateNode</td>
      <td>(stableId: <a href='/docs/apis/tree#nodeid-TypeAlias'>NodeId</a>, node: <a href='/docs/apis/tree/treeviewnode'>TreeViewNode</a>) => boolean</td>
      <td></td>
    </tr>
    <tr>
      <td>onInvalidDetachedId</td>
      <td>(sequenceId: <a href='/docs/apis/tree#detachedsequenceid-TypeAlias'>DetachedSequenceId</a>) => void</td>
      <td></td>
    </tr>
  </tbody>
</table>

#### Returns {#createviewnodesfortree-Method-returns}


all the top-level node IDs in `sequence` (both from nodes and from detached sequences).

<b>Return type(s):</b> [NodeId](/docs/apis/tree#nodeid-TypeAlias)<!-- -->\[\] \| undefined

### dispatchChange {#dispatchchange-Method}

Applies a given change

<b>Signature:</b>

```typescript
dispatchChange(state: ValidState, change: ChangeInternal): ChangeResult;
```

#### Parameters {#dispatchchange-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>state</td>
      <td>ValidState</td>
      <td>Current state</td>
    </tr>
    <tr>
      <td>change</td>
      <td><a href='/docs/apis/tree#changeinternal-TypeAlias'>ChangeInternal</a></td>
      <td>Change to apply</td>
    </tr>
  </tbody>
</table>

#### Returns {#dispatchchange-Method-returns}


a [ChangeResult](/docs/apis/tree#changeresult-TypeAlias) containing either the change result or a Failure

<b>Return type(s):</b> [ChangeResult](/docs/apis/tree#changeresult-TypeAlias)

### tryResolveChange {#tryresolvechange-Method}

Resolves change with Result.Ok

<b>Signature:</b>

```typescript
tryResolveChange(state: ValidState, change: ChangeInternal): Result.Ok<ChangeInternal>;
```

#### Parameters {#tryresolvechange-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>state</td>
      <td>ValidState</td>
      <td>Unused</td>
    </tr>
    <tr>
      <td>change</td>
      <td><a href='/docs/apis/tree#changeinternal-TypeAlias'>ChangeInternal</a></td>
      <td>Change to resolve</td>
    </tr>
  </tbody>
</table>

#### Returns {#tryresolvechange-Method-returns}


Result.Ok which contains change

<b>Return type(s):</b> [Result.Ok](/docs/apis/tree/result/ok)<!-- -->&lt;[ChangeInternal](/docs/apis/tree#changeinternal-TypeAlias)<!-- -->&gt;

### validateOnClose {#validateonclose-Method}

Validates the transaction when it is closed

<b>Signature:</b>

```typescript
validateOnClose(state: ValidState): ChangeResult;
```

#### Parameters {#validateonclose-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>state</td>
      <td>ValidState</td>
      <td>Current state</td>
    </tr>
  </tbody>
</table>

#### Returns {#validateonclose-Method-returns}


a [ChangeResult](/docs/apis/tree#changeresult-TypeAlias) containing either the change result or a Failure

<b>Return type(s):</b> [ChangeResult](/docs/apis/tree#changeresult-TypeAlias)


</div>
