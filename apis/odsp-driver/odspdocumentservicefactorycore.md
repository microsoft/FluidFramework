{"kind":"Class","title":"OdspDocumentServiceFactoryCore Class","summary":"Factory for creating the sharepoint document service. Use this if you want to use the sharepoint implementation.\n\nThis constructor should be used by environments that support dynamic imports and that wish to leverage code splitting as a means to keep bundles as small as possible.","members":{"Constructor":{"(constructor)":"/docs/apis/odsp-driver/odspdocumentservicefactorycore#_constructor_-Constructor"},"Method":{"createContainer":"/docs/apis/odsp-driver/odspdocumentservicefactorycore#createcontainer-Method","createDocumentService":"/docs/apis/odsp-driver/odspdocumentservicefactorycore#createdocumentservice-Method","createDocumentServiceCore":"/docs/apis/odsp-driver/odspdocumentservicefactorycore#createdocumentservicecore-Method"},"Property":{"persistedCache":"/docs/apis/odsp-driver/odspdocumentservicefactorycore#persistedcache-Property","protocolName":"/docs/apis/odsp-driver/odspdocumentservicefactorycore#protocolname-Property"}},"package":"@fluidframework/odsp-driver","unscopedPackageName":"odsp-driver"}

[//]: # (Do not edit this file. It is automatically generated by API Documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/odsp-driver](/docs/apis/odsp-driver) &gt; [OdspDocumentServiceFactoryCore](/docs/apis/odsp-driver/odspdocumentservicefactorycore)

Factory for creating the sharepoint document service. Use this if you want to use the sharepoint implementation.

This constructor should be used by environments that support dynamic imports and that wish to leverage code splitting as a means to keep bundles as small as possible.

<b>Signature:</b>

```typescript
export declare class OdspDocumentServiceFactoryCore implements IDocumentServiceFactory 
```
<b>Implements:</b> [IDocumentServiceFactory](/docs/apis/driver-definitions/idocumentservicefactory)

## Constructors

<table class="table table-striped table-hover constructor-list">
<caption>List of constructors for this class</caption>
  <thead>
    <tr>
     <th scope="col">Constructor</th>
 <th scope="col">Modifiers</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore#_constructor_-Constructor'>(constructor)(getStorageToken, getWebsocketToken, getSocketIOClient, persistedCache, hostPolicy)</a></td>
      <td></td>
      <td>Constructs a new instance of the <code>OdspDocumentServiceFactoryCore</code> class</td>
    </tr>
  </tbody>
</table>

## Properties

<table class="table table-striped table-hover property-list">
<caption>List of properties on this class</caption>
  <thead>
    <tr>
     <th scope="col">Property</th>
 <th scope="col">Modifiers</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore#persistedcache-Property'>persistedCache</a></td>
      <td></td>
      <td><a href='/docs/apis/odsp-driver-definitions/ipersistedcache'>IPersistedCache</a></td>
      <td></td>
    </tr>
    <tr>
      <td><a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore#protocolname-Property'>protocolName</a></td>
      <td></td>
      <td>(not declared)</td>
      <td></td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover method-list">
<caption>List of methods on this class</caption>
  <thead>
    <tr>
     <th scope="col">Method</th>
 <th scope="col">Modifiers</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore#createcontainer-Method'>createContainer(createNewSummary, createNewResolvedUrl, logger, clientIsSummarizer)</a></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore#createdocumentservice-Method'>createDocumentService(resolvedUrl, logger, clientIsSummarizer)</a></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore#createdocumentservicecore-Method'>createDocumentServiceCore(resolvedUrl, odspLogger, cacheAndTrackerArg, clientIsSummarizer)</a></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>

<hr><div id=class-details>

## Constructor Details {#constructors-details}

### OdspDocumentServiceFactoryCore.(constructor) {#_constructor_-Constructor}

Constructs a new instance of the `OdspDocumentServiceFactoryCore` class

<b>Signature:</b>

```typescript
constructor(getStorageToken: TokenFetcher<OdspResourceTokenFetchOptions>, getWebsocketToken: TokenFetcher<OdspResourceTokenFetchOptions> | undefined, getSocketIOClient: () => Promise<typeof SocketIOClientStatic>, persistedCache?: IPersistedCache, hostPolicy?: HostStoragePolicy);
```

#### Parameters {#_constructor_-Constructor-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>getStorageToken</td>
      <td><a href='/docs/apis/odsp-driver-definitions#tokenfetcher-TypeAlias'>TokenFetcher</a><<a href='/docs/apis/odsp-driver-definitions/odspresourcetokenfetchoptions'>OdspResourceTokenFetchOptions</a>></td>
      <td>function that can provide the storage token for a given site. This is is also referred to as the "Vroom" token in SPO.</td>
    </tr>
    <tr>
      <td>getWebsocketToken</td>
      <td><a href='/docs/apis/odsp-driver-definitions#tokenfetcher-TypeAlias'>TokenFetcher</a><<a href='/docs/apis/odsp-driver-definitions/odspresourcetokenfetchoptions'>OdspResourceTokenFetchOptions</a>> | undefined</td>
      <td>function that can provide a token for accessing the web socket. This is also to as the "Push" token in SPO. If undefined then websocket token is expected to be returned with joinSession response payload.</td>
    </tr>
    <tr>
      <td>getSocketIOClient</td>
      <td>() => Promise<typeof SocketIOClientStatic></td>
      <td></td>
    </tr>
    <tr>
      <td>persistedCache</td>
      <td><a href='/docs/apis/odsp-driver-definitions/ipersistedcache'>IPersistedCache</a></td>
      <td>PersistedCache provided by host for use in this session.</td>
    </tr>
    <tr>
      <td>hostPolicy</td>
      <td><a href='/docs/apis/odsp-driver-definitions/hoststoragepolicy'>HostStoragePolicy</a></td>
      <td></td>
    </tr>
  </tbody>
</table>


## Property Details {#properties-details}

### persistedCache {#persistedcache-Property}

<b>Signature:</b>

```typescript
protected persistedCache: IPersistedCache;
```

### protocolName {#protocolname-Property}

<b>Signature:</b>

```typescript
readonly protocolName = "fluid-odsp:";
```

## Method Details {#methods-details}

### createContainer {#createcontainer-Method}

<b>Signature:</b>

```typescript
createContainer(createNewSummary: ISummaryTree | undefined, createNewResolvedUrl: IResolvedUrl, logger?: ITelemetryBaseLogger, clientIsSummarizer?: boolean): Promise<IDocumentService>;
```

#### Parameters {#createcontainer-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>createNewSummary</td>
      <td><a href='/docs/apis/protocol-definitions/isummarytree'>ISummaryTree</a> | undefined</td>
      <td></td>
    </tr>
    <tr>
      <td>createNewResolvedUrl</td>
      <td><a href='/docs/apis/driver-definitions#iresolvedurl-TypeAlias'>IResolvedUrl</a></td>
      <td></td>
    </tr>
    <tr>
      <td>logger</td>
      <td><a href='/docs/apis/common-definitions/itelemetrybaselogger'>ITelemetryBaseLogger</a></td>
      <td></td>
    </tr>
    <tr>
      <td>clientIsSummarizer</td>
      <td>boolean</td>
      <td></td>
    </tr>
  </tbody>
</table>

### createDocumentService {#createdocumentservice-Method}

<b>Signature:</b>

```typescript
createDocumentService(resolvedUrl: IResolvedUrl, logger?: ITelemetryBaseLogger, clientIsSummarizer?: boolean): Promise<IDocumentService>;
```

#### Parameters {#createdocumentservice-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>resolvedUrl</td>
      <td><a href='/docs/apis/driver-definitions#iresolvedurl-TypeAlias'>IResolvedUrl</a></td>
      <td></td>
    </tr>
    <tr>
      <td>logger</td>
      <td><a href='/docs/apis/common-definitions/itelemetrybaselogger'>ITelemetryBaseLogger</a></td>
      <td></td>
    </tr>
    <tr>
      <td>clientIsSummarizer</td>
      <td>boolean</td>
      <td></td>
    </tr>
  </tbody>
</table>

### createDocumentServiceCore {#createdocumentservicecore-Method}

<b>Signature:</b>

```typescript
protected createDocumentServiceCore(resolvedUrl: IResolvedUrl, odspLogger: TelemetryLogger, cacheAndTrackerArg?: ICacheAndTracker, clientIsSummarizer?: boolean): Promise<IDocumentService>;
```

#### Parameters {#createdocumentservicecore-Method-parameters}


<table class="table table-striped table-hover param-list">
<caption>List of parameters</caption>
  <thead>
    <tr>
     <th scope="col">Parameter</th>
 <th scope="col">Type</th>
 <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>resolvedUrl</td>
      <td><a href='/docs/apis/driver-definitions#iresolvedurl-TypeAlias'>IResolvedUrl</a></td>
      <td></td>
    </tr>
    <tr>
      <td>odspLogger</td>
      <td><a href='/docs/apis/telemetry-utils/telemetrylogger'>TelemetryLogger</a></td>
      <td></td>
    </tr>
    <tr>
      <td>cacheAndTrackerArg</td>
      <td>ICacheAndTracker</td>
      <td></td>
    </tr>
    <tr>
      <td>clientIsSummarizer</td>
      <td>boolean</td>
      <td></td>
    </tr>
  </tbody>
</table>


</div>
