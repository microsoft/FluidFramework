{
  "title": "@fluidframework/test-utils Package",
  "kind": "Package",
  "members": {
    "TypeAlias": {
      "ChannelFactoryRegistry": "/docs/apis/test-utils#channelfactoryregistry-typealias",
      "fluidEntryPoint": "/docs/apis/test-utils#fluidentrypoint-typealias",
      "SupportedExportInterfaces": "/docs/apis/test-utils#supportedexportinterfaces-typealias"
    },
    "Function": {
      "createAndAttachContainer": "/docs/apis/test-utils#createandattachcontainer-function",
      "createLoader": "/docs/apis/test-utils#createloader-function",
      "createSummarizer": "/docs/apis/test-utils#createsummarizer-function",
      "createSummarizerFromFactory": "/docs/apis/test-utils#createsummarizerfromfactory-function",
      "ensureContainerConnected": "/docs/apis/test-utils#ensurecontainerconnected-function",
      "getUnexpectedLogErrorException": "/docs/apis/test-utils#getunexpectedlogerrorexception-function",
      "summarizeNow": "/docs/apis/test-utils#summarizenow-function",
      "timeoutAwait": "/docs/apis/test-utils#timeoutawait-function",
      "timeoutPromise": "/docs/apis/test-utils#timeoutpromise-function",
      "waitForContainerConnection": "/docs/apis/test-utils#waitforcontainerconnection-function",
      "wrapDocumentService": "/docs/apis/test-utils#wrapdocumentservice-function",
      "wrapDocumentServiceFactory": "/docs/apis/test-utils#wrapdocumentservicefactory-function",
      "wrapDocumentStorageService": "/docs/apis/test-utils#wrapdocumentstorageservice-function"
    },
    "Variable": {
      "createDocumentId": "/docs/apis/test-utils#createdocumentid-variable",
      "createTestContainerRuntimeFactory": "/docs/apis/test-utils#createtestcontainerruntimefactory-variable",
      "defaultTimeoutDurationMs": "/docs/apis/test-utils#defaulttimeoutdurationms-variable",
      "mockConfigProvider": "/docs/apis/test-utils#mockconfigprovider-variable",
      "retryWithEventualValue": "/docs/apis/test-utils#retrywitheventualvalue-variable",
      "TestContainerRuntimeFactory": "/docs/apis/test-utils#testcontainerruntimefactory-variable"
    },
    "Enum": {
      "DataObjectFactoryType": "/docs/apis/test-utils#dataobjectfactorytype-enum"
    },
    "Class": {
      "EventAndErrorTrackingLogger": "/docs/apis/test-utils\\eventanderrortrackinglogger-class",
      "LoaderContainerTracker": "/docs/apis/test-utils\\loadercontainertracker-class",
      "LocalCodeLoader": "/docs/apis/test-utils\\localcodeloader-class",
      "TestFluidObject": "/docs/apis/test-utils\\testfluidobject-class",
      "TestFluidObjectFactory": "/docs/apis/test-utils\\testfluidobjectfactory-class",
      "TestObjectProvider": "/docs/apis/test-utils\\testobjectprovider-class"
    },
    "Interface": {
      "IOpProcessingController": "/docs/apis/test-utils\\iopprocessingcontroller-interface",
      "IProvideTestFluidObject": "/docs/apis/test-utils\\iprovidetestfluidobject-interface",
      "ITestContainerConfig": "/docs/apis/test-utils\\itestcontainerconfig-interface",
      "ITestFluidObject": "/docs/apis/test-utils\\itestfluidobject-interface",
      "ITestObjectProvider": "/docs/apis/test-utils\\itestobjectprovider-interface",
      "TimeoutWithError": "/docs/apis/test-utils\\timeoutwitherror-interface",
      "TimeoutWithValue": "/docs/apis/test-utils\\timeoutwithvalue-interface"
    }
  },
  "package": "@fluidframework/test-utils",
  "unscopedPackageName": "test-utils"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/test-utils](/docs/apis/test-utils)

## Interfaces

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Interface
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\iopprocessingcontroller-interface'>IOpProcessingController</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\iprovidetestfluidobject-interface'>IProvideTestFluidObject</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\itestcontainerconfig-interface'>ITestContainerConfig</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\itestfluidobject-interface'>ITestFluidObject</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\itestobjectprovider-interface'>ITestObjectProvider</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\timeoutwitherror-interface'>TimeoutWithError</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\timeoutwithvalue-interface'>TimeoutWithValue</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Classes

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Class
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\eventanderrortrackinglogger-class'>EventAndErrorTrackingLogger</a>
      </td>
      <td>
        This class tracks events. It allows specifying expected events, which will be looked for in order. It also tracks all unexpected errors. At any point you call reportAndClearTrackedEvents which will provide all unexpected errors, and any expected events that have not occurred.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\loadercontainertracker-class'>LoaderContainerTracker</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\localcodeloader-class'>LocalCodeLoader</a>
      </td>
      <td>
        A simple code loader that caches a mapping of package name to a Fluid entry point. On load, it retrieves the entry point matching the package name in the given code details.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\testfluidobject-class'>TestFluidObject</a>
      </td>
      <td>
        A test Fluid object that will create a shared object for each key-value pair in the factoryEntries passed to load. The shared objects can be retrieved by passing the key of the entry to getSharedObject. It exposes the IFluidDataStoreContext and IFluidDataStoreRuntime.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\testfluidobjectfactory-class'>TestFluidObjectFactory</a>
      </td>
      <td>
        Creates a factory for a TestFluidObject with the given object factory entries. It creates a data store runtime with the object factories in the entry list. All the entries with an id other than undefined are passed to the Fluid object so that it can create a shared object for each.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils\testobjectprovider-class'>TestObjectProvider</a>
      </td>
      <td>
        Shared base class for test object provider. Contain code for loader and container creation and loading
      </td>
    </tr>
  </tbody>
</table>

## Enumerations

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Enum
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#dataobjectfactorytype-enum'>DataObjectFactoryType</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Types

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        TypeAlias
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#channelfactoryregistry-typealias'>ChannelFactoryRegistry</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#fluidentrypoint-typealias'>fluidEntryPoint</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#supportedexportinterfaces-typealias'>SupportedExportInterfaces</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Functions

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Function
      </th>
      <th scope="col">
        Alerts
      </th>
      <th scope="col">
        Return Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createandattachcontainer-function'>createAndAttachContainer</a>
      </td>
      <td>
      </td>
      <td>
        Promise<IContainer>
      </td>
      <td>
        Creates a detached Container and attaches it.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createloader-function'>createLoader</a>
      </td>
      <td>
      </td>
      <td>
        IHostLoader
      </td>
      <td>
        Creates a loader with the given package entries and driver.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createsummarizer-function'>createSummarizer</a>
      </td>
      <td>
      </td>
      <td>
        Promise<{ container: IContainer; summarizer: <a href='/docs/apis/container-runtime\isummarizer-interface'>ISummarizer</a>; }>
      </td>
      <td>
        Creates a summarizer client from the given container and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createsummarizerfromfactory-function'>createSummarizerFromFactory</a>
      </td>
      <td>
      </td>
      <td>
        Promise<{ container: IContainer; summarizer: <a href='/docs/apis/container-runtime\isummarizer-interface'>ISummarizer</a>; }>
      </td>
      <td>
        Creates a summarizer client from the given container and data store factory, and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#ensurecontainerconnected-function'>ensureContainerConnected</a>
      </td>
      <td>
        <code>DEPRECATED</code>
      </td>
      <td>
        Promise<void>
      </td>
      <td>
        Waits for the specified container to emit a 'connected' event.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#getunexpectedlogerrorexception-function'>getUnexpectedLogErrorException</a>
      </td>
      <td>
      </td>
      <td>
        Error | undefined
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#summarizenow-function'>summarizeNow</a>
      </td>
      <td>
      </td>
      <td>
        Promise<{ summaryTree: import("@fluidframework/protocol-definitions").<a href='/docs/apis/protocol-definitions\isummarytree-interface'>ISummaryTree</a>; summaryVersion: string; summaryRefSeq: number; }>
      </td>
      <td>
        Summarizes on demand and returns the summary tree, the version number and the reference sequence number of the submitted summary.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#timeoutawait-function'>timeoutAwait</a>
      </td>
      <td>
      </td>
      <td>
        Promise<T>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#timeoutpromise-function'>timeoutPromise</a>
      </td>
      <td>
      </td>
      <td>
        Promise<T>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#waitforcontainerconnection-function'>waitForContainerConnection</a>
      </td>
      <td>
      </td>
      <td>
        Promise<void>
      </td>
      <td>
        Utility function to wait for the specified Container to be in Connected state. If the Container is already connected, the Promise returns immediately; otherwise it resolves when the Container emits its 'connected' event. If failOnContainerClose === true, the returned Promise will be rejected if the container emits a 'closed' event before a 'connected' event.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#wrapdocumentservice-function'>wrapDocumentService</a>
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentservice-interface'>IDocumentService</a>
      </td>
      <td>
        Wraps the given IDocumentService to override the <code>connectToStorage</code> method. The intent is to plumb the <code>uploadSummaryCb</code> to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document storage service that is created in <code>connectToStorage</code> is wrapped by calling <code>wrapDocumentStorageService</code> to pass in the <code>uploadSummaryCb</code>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#wrapdocumentservicefactory-function'>wrapDocumentServiceFactory</a>
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentservicefactory-interface'>IDocumentServiceFactory</a>
      </td>
      <td>
        Wraps the given IDocumentServiceFactory to override the <code>createDocumentService</code> method. The intent is to plumb the <code>uploadSummaryCb</code> all the way to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document service that is created in <code>createDocumentService</code> is wrapped by calling <code>wrapDocumentService</code> to pass in the <code>uploadSummaryCb</code>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#wrapdocumentstorageservice-function'>wrapDocumentStorageService</a>
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentstorageservice-interface'>IDocumentStorageService</a>
      </td>
      <td>
        Wraps the given IDocumentStorageService to override the <code>uploadSummaryWithContext</code> method. It calls the <code>uploadSummaryCb</code> whenever a summary is uploaded by the client. The summary context can be updated in the callback before it is uploaded to the server.
      </td>
    </tr>
  </tbody>
</table>

## Variables

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Variable
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createdocumentid-variable'>createDocumentId</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createtestcontainerruntimefactory-variable'>createTestContainerRuntimeFactory</a>
      </td>
      <td>
        Create a container runtime factory class that allows you to set runtime options
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#defaulttimeoutdurationms-variable'>defaultTimeoutDurationMs</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#mockconfigprovider-variable'>mockConfigProvider</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#retrywitheventualvalue-variable'>retryWithEventualValue</a>
      </td>
      <td>
        Simple retry mechanism with linear back off to call a function which may eventually return an accepted value.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#testcontainerruntimefactory-variable'>TestContainerRuntimeFactory</a>
      </td>
      <td>
        A container runtime factory that allows you to set runtime options
      </td>
    </tr>
  </tbody>
</table>

## Enumeration Details

### DataObjectFactoryType {#dataobjectfactorytype-enum}

#### Signature {#dataobjectfactorytype-signature}

```typescript
export declare enum DataObjectFactoryType 
```

#### Flags

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Flag
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#dataobjectfactorytype-primed-enummember'>Primed</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#dataobjectfactorytype-test-enummember'>Test</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### FlagDetails

##### Primed {#dataobjectfactorytype-primed-enummember}

###### Signature {#primed-signature}

```typescript
Primed = 0
```

##### Test {#dataobjectfactorytype-test-enummember}

###### Signature {#test-signature}

```typescript
Test = 1
```

## Type Details

### ChannelFactoryRegistry {#channelfactoryregistry-typealias}

#### Signature {#channelfactoryregistry-signature}

```typescript
export declare type ChannelFactoryRegistry = Iterable<[string | undefined, IChannelFactory]>;
```

### fluidEntryPoint {#fluidentrypoint-typealias}

#### Signature {#fluidentrypoint-signature}

```typescript
export declare type fluidEntryPoint = SupportedExportInterfaces | IFluidModule;
```

### SupportedExportInterfaces {#supportedexportinterfaces-typealias}

#### Signature {#supportedexportinterfaces-signature}

```typescript
export declare type SupportedExportInterfaces = Partial<IProvideRuntimeFactory & IProvideFluidDataStoreFactory & IProvideFluidDataStoreRegistry & IProvideFluidCodeDetailsComparer>;
```

## Function Details

### createAndAttachContainer {#createandattachcontainer-function}

Creates a detached Container and attaches it.

#### Signature {#createandattachcontainer-signature}

```typescript
export declare function createAndAttachContainer(source: IFluidCodeDetails, loader: IHostLoader, attachRequest: IRequest): Promise<IContainer>;
```

#### Parameters {#createandattachcontainer-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        source
      </td>
      <td>
        IFluidCodeDetails
      </td>
      <td>
        The code details used to create the Container.
      </td>
    </tr>
    <tr>
      <td>
        loader
      </td>
      <td>
        IHostLoader
      </td>
      <td>
        The loader to use to initialize the container.
      </td>
    </tr>
    <tr>
      <td>
        attachRequest
      </td>
      <td>
        <a href='/docs/apis/core-interfaces\irequest-interface'>IRequest</a>
      </td>
      <td>
        The request to create new from.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createandattachcontainer-returns}

<b>Return type:</b> Promise&lt;IContainer&gt;

### createLoader {#createloader-function}

Creates a loader with the given package entries and driver.

#### Signature {#createloader-signature}

```typescript
export declare function createLoader(packageEntries: Iterable<[IFluidCodeDetails, fluidEntryPoint]>, documentServiceFactory: IDocumentServiceFactory, urlResolver: IUrlResolver, logger?: ITelemetryBaseLogger, options?: ILoaderOptions): IHostLoader;
```

#### Parameters {#createloader-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        packageEntries
      </td>
      <td>
      </td>
      <td>
        Iterable<[IFluidCodeDetails, <a href='/docs/apis/test-utils#fluidentrypoint-typealias'>fluidEntryPoint</a>]>
      </td>
      <td>
        A list of code details to Fluid entry points.
      </td>
    </tr>
    <tr>
      <td>
        documentServiceFactory
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentservicefactory-interface'>IDocumentServiceFactory</a>
      </td>
      <td>
        the driver factory to use
      </td>
    </tr>
    <tr>
      <td>
        urlResolver
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\iurlresolver-interface'>IUrlResolver</a>
      </td>
      <td>
        the url resolver to use
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/common-definitions\itelemetrybaselogger-interface'>ITelemetryBaseLogger</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        options
      </td>
      <td>
        optional
      </td>
      <td>
        ILoaderOptions
      </td>
      <td>
        loader options
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createloader-returns}

<b>Return type:</b> IHostLoader

### createSummarizer {#createsummarizer-function}

Creates a summarizer client from the given container and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.

#### Signature {#createsummarizer-signature}

```typescript
export declare function createSummarizer(provider: ITestObjectProvider, container: IContainer, summaryVersion?: string, gcOptions?: IGCRuntimeOptions, configProvider?: IConfigProviderBase, logger?: ITelemetryBaseLogger): Promise<{
    container: IContainer;
    summarizer: ISummarizer;
}>;
```

#### Parameters {#createsummarizer-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        provider
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/test-utils\itestobjectprovider-interface'>ITestObjectProvider</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        container
      </td>
      <td>
      </td>
      <td>
        IContainer
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        summaryVersion
      </td>
      <td>
        optional
      </td>
      <td>
        string
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        gcOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/container-runtime\igcruntimeoptions-interface'>IGCRuntimeOptions</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        configProvider
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/telemetry-utils\iconfigproviderbase-interface'>IConfigProviderBase</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/common-definitions\itelemetrybaselogger-interface'>ITelemetryBaseLogger</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createsummarizer-returns}

<b>Return type:</b> Promise&lt;{ container: IContainer; summarizer: [ISummarizer](/docs/apis/container-runtime\isummarizer-interface)<!-- -->; }&gt;

### createSummarizerFromFactory {#createsummarizerfromfactory-function}

Creates a summarizer client from the given container and data store factory, and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.

#### Signature {#createsummarizerfromfactory-signature}

```typescript
export declare function createSummarizerFromFactory(provider: ITestObjectProvider, container: IContainer, dataStoreFactory: IFluidDataStoreFactory, summaryVersion?: string, containerRuntimeFactoryType?: typeof ContainerRuntimeFactoryWithDefaultDataStore, registryEntries?: NamedFluidDataStoreRegistryEntries): Promise<{
    container: IContainer;
    summarizer: ISummarizer;
}>;
```

#### Parameters {#createsummarizerfromfactory-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        provider
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/test-utils\itestobjectprovider-interface'>ITestObjectProvider</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        container
      </td>
      <td>
      </td>
      <td>
        IContainer
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        dataStoreFactory
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/runtime-definitions\ifluiddatastorefactory-interface'>IFluidDataStoreFactory</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        summaryVersion
      </td>
      <td>
        optional
      </td>
      <td>
        string
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        containerRuntimeFactoryType
      </td>
      <td>
        optional
      </td>
      <td>
        typeof <a href='/docs/apis/aqueduct\containerruntimefactorywithdefaultdatastore-class'>ContainerRuntimeFactoryWithDefaultDataStore</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        registryEntries
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/runtime-definitions#namedfluiddatastoreregistryentries-typealias'>NamedFluidDataStoreRegistryEntries</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createsummarizerfromfactory-returns}

<b>Return type:</b> Promise&lt;{ container: IContainer; summarizer: [ISummarizer](/docs/apis/container-runtime\isummarizer-interface)<!-- -->; }&gt;

### ensureContainerConnected {#ensurecontainerconnected-function}

{{% callout Warning Deprecated %}}
Use waitForContainerConnection instead. Note that an upcoming release will change the default parameters on that function to: - failOnContainerClose = true - timeoutOptions.durationMs = 1s


{{% /callout %}}

Waits for the specified container to emit a 'connected' event.

#### Signature {#ensurecontainerconnected-signature}

```typescript
export declare function ensureContainerConnected(container: IContainer): Promise<void>;
```

#### Parameters {#ensurecontainerconnected-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        container
      </td>
      <td>
        IContainer
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#ensurecontainerconnected-returns}

<b>Return type:</b> Promise&lt;void&gt;

### getUnexpectedLogErrorException {#getunexpectedlogerrorexception-function}

#### Signature {#getunexpectedlogerrorexception-signature}

```typescript
export declare function getUnexpectedLogErrorException(logger: EventAndErrorTrackingLogger | undefined, prefix?: string): Error | undefined;
```

#### Parameters {#getunexpectedlogerrorexception-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        logger
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/test-utils\eventanderrortrackinglogger-class'>EventAndErrorTrackingLogger</a> | undefined
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        prefix
      </td>
      <td>
        optional
      </td>
      <td>
        string
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getunexpectedlogerrorexception-returns}

<b>Return type:</b> Error \| undefined

### summarizeNow {#summarizenow-function}

Summarizes on demand and returns the summary tree, the version number and the reference sequence number of the submitted summary.

#### Signature {#summarizenow-signature}

```typescript
export declare function summarizeNow(summarizer: ISummarizer, reason?: string): Promise<{
    summaryTree: import("@fluidframework/protocol-definitions").ISummaryTree;
    summaryVersion: string;
    summaryRefSeq: number;
}>;
```

#### Parameters {#summarizenow-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        summarizer
      </td>
      <td>
      </td>
      <td>
        <a href='/docs/apis/container-runtime\isummarizer-interface'>ISummarizer</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        reason
      </td>
      <td>
        optional
      </td>
      <td>
        string
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#summarizenow-returns}

<b>Return type:</b> Promise&lt;{ summaryTree: import("@fluidframework/protocol-definitions").[ISummaryTree](/docs/apis/protocol-definitions\isummarytree-interface)<!-- -->; summaryVersion: string; summaryRefSeq: number; }&gt;

### timeoutAwait {#timeoutawait-function}

#### Signature {#timeoutawait-signature}

```typescript
export declare function timeoutAwait<T = void>(promise: PromiseLike<T>, timeoutOptions?: TimeoutWithError | TimeoutWithValue<T>): Promise<T>;
```

#### Parameters {#timeoutawait-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        promise
      </td>
      <td>
      </td>
      <td>
        PromiseLike<T>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        timeoutOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/test-utils\timeoutwitherror-interface'>TimeoutWithError</a> | <a href='/docs/apis/test-utils\timeoutwithvalue-interface'>TimeoutWithValue</a><T>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#timeoutawait-returns}

<b>Return type:</b> Promise&lt;T&gt;

### timeoutPromise {#timeoutpromise-function}

#### Signature {#timeoutpromise-signature}

```typescript
export declare function timeoutPromise<T = void>(executor: (resolve: (value: T | PromiseLike<T>) => void, reject: (reason?: any) => void) => void, timeoutOptions?: TimeoutWithError | TimeoutWithValue<T>): Promise<T>;
```

#### Parameters {#timeoutpromise-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        executor
      </td>
      <td>
      </td>
      <td>
        (resolve: (value: T | PromiseLike<T>) => void, reject: (reason?: any) => void) => void
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        timeoutOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/test-utils\timeoutwitherror-interface'>TimeoutWithError</a> | <a href='/docs/apis/test-utils\timeoutwithvalue-interface'>TimeoutWithValue</a><T>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#timeoutpromise-returns}

<b>Return type:</b> Promise&lt;T&gt;

### waitForContainerConnection {#waitforcontainerconnection-function}

Utility function to wait for the specified Container to be in Connected state. If the Container is already connected, the Promise returns immediately; otherwise it resolves when the Container emits its 'connected' event. If failOnContainerClose === true, the returned Promise will be rejected if the container emits a 'closed' event before a 'connected' event.

#### Signature {#waitforcontainerconnection-signature}

```typescript
export declare function waitForContainerConnection(container: IContainer, failOnContainerClose?: boolean, timeoutOptions?: TimeoutWithError): Promise<void>;
```

#### Parameters {#waitforcontainerconnection-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Modifiers
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        container
      </td>
      <td>
      </td>
      <td>
        IContainer
      </td>
      <td>
        The container to wait for.
      </td>
    </tr>
    <tr>
      <td>
        failOnContainerClose
      </td>
      <td>
        optional
      </td>
      <td>
        boolean
      </td>
      <td>
        If true, the returned Promise will be rejected if the container emits a 'closed' event before a 'connected' event. Defaults to false (but this will change in an upcoming version).
      </td>
    </tr>
    <tr>
      <td>
        timeoutOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <a href='/docs/apis/test-utils\timeoutwitherror-interface'>TimeoutWithError</a>
      </td>
      <td>
        Options related to the behavior of the timeout. If not provided, no timeout will be applied and the promise will wait indefinitely for the Container to emit its 'connected' (or 'closed, if failOnContainerClose === true) event.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#waitforcontainerconnection-returns}

A Promise that resolves when the specified container emits a 'connected' event (or immediately if the Container is already connected). If failOnContainerClose === true and the container emits a 'closed' event before a 'connected' event, the Promise is rejected with the error from the 'closed' event, if any. If timeoutOptions is provided, the Promise will reject if the container hasn't emmited a relevant event before timeoutOptions.durationMs (which defaults to 250ms if left undefined).

<b>Return type:</b> Promise&lt;void&gt;

### wrapDocumentService {#wrapdocumentservice-function}

Wraps the given IDocumentService to override the `connectToStorage` method. The intent is to plumb the `uploadSummaryCb` to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document storage service that is created in `connectToStorage` is wrapped by calling `wrapDocumentStorageService` to pass in the `uploadSummaryCb`<!-- -->.

#### Signature {#wrapdocumentservice-signature}

```typescript
export declare function wrapDocumentService(innerDocService: IDocumentService, uploadSummaryCb: (summaryTree: ISummaryTree, context: ISummaryContext) => ISummaryContext): IDocumentService;
```

#### Parameters {#wrapdocumentservice-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        innerDocService
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentservice-interface'>IDocumentService</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        uploadSummaryCb
      </td>
      <td>
        (summaryTree: <a href='/docs/apis/protocol-definitions\isummarytree-interface'>ISummaryTree</a>, context: <a href='/docs/apis/driver-definitions\isummarycontext-interface'>ISummaryContext</a>) => <a href='/docs/apis/driver-definitions\isummarycontext-interface'>ISummaryContext</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#wrapdocumentservice-returns}

<b>Return type:</b> [IDocumentService](/docs/apis/driver-definitions\idocumentservice-interface)

### wrapDocumentServiceFactory {#wrapdocumentservicefactory-function}

Wraps the given IDocumentServiceFactory to override the `createDocumentService` method. The intent is to plumb the `uploadSummaryCb` all the way to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document service that is created in `createDocumentService` is wrapped by calling `wrapDocumentService` to pass in the `uploadSummaryCb`<!-- -->.

#### Signature {#wrapdocumentservicefactory-signature}

```typescript
export declare function wrapDocumentServiceFactory(innerDocServiceFactory: IDocumentServiceFactory, uploadSummaryCb: (summaryTree: ISummaryTree, context: ISummaryContext) => ISummaryContext): IDocumentServiceFactory;
```

#### Parameters {#wrapdocumentservicefactory-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        innerDocServiceFactory
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentservicefactory-interface'>IDocumentServiceFactory</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        uploadSummaryCb
      </td>
      <td>
        (summaryTree: <a href='/docs/apis/protocol-definitions\isummarytree-interface'>ISummaryTree</a>, context: <a href='/docs/apis/driver-definitions\isummarycontext-interface'>ISummaryContext</a>) => <a href='/docs/apis/driver-definitions\isummarycontext-interface'>ISummaryContext</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#wrapdocumentservicefactory-returns}

<b>Return type:</b> [IDocumentServiceFactory](/docs/apis/driver-definitions\idocumentservicefactory-interface)

### wrapDocumentStorageService {#wrapdocumentstorageservice-function}

Wraps the given IDocumentStorageService to override the `uploadSummaryWithContext` method. It calls the `uploadSummaryCb` whenever a summary is uploaded by the client. The summary context can be updated in the callback before it is uploaded to the server.

#### Signature {#wrapdocumentstorageservice-signature}

```typescript
export declare function wrapDocumentStorageService(innerDocStorageService: IDocumentStorageService, uploadSummaryCb: (summaryTree: ISummaryTree, context: ISummaryContext) => ISummaryContext): IDocumentStorageService;
```

#### Parameters {#wrapdocumentstorageservice-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">
        Parameter
      </th>
      <th scope="col">
        Type
      </th>
      <th scope="col">
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        innerDocStorageService
      </td>
      <td>
        <a href='/docs/apis/driver-definitions\idocumentstorageservice-interface'>IDocumentStorageService</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        uploadSummaryCb
      </td>
      <td>
        (summaryTree: <a href='/docs/apis/protocol-definitions\isummarytree-interface'>ISummaryTree</a>, context: <a href='/docs/apis/driver-definitions\isummarycontext-interface'>ISummaryContext</a>) => <a href='/docs/apis/driver-definitions\isummarycontext-interface'>ISummaryContext</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#wrapdocumentstorageservice-returns}

<b>Return type:</b> [IDocumentStorageService](/docs/apis/driver-definitions\idocumentstorageservice-interface)

## Variable Details

### createDocumentId {#createdocumentid-variable}

#### Signature {#createdocumentid-signature}

```typescript
createDocumentId: () => string
```

### createTestContainerRuntimeFactory {#createtestcontainerruntimefactory-variable}

Create a container runtime factory class that allows you to set runtime options

#### Signature {#createtestcontainerruntimefactory-signature}

```typescript
createTestContainerRuntimeFactory: (containerRuntimeCtor: typeof ContainerRuntime) => {
    new (type: string, dataStoreFactory: IFluidDataStoreFactory, runtimeOptions?: IContainerRuntimeOptions, requestHandlers?: RuntimeRequestHandler[]): {
        type: string;
        dataStoreFactory: IFluidDataStoreFactory;
        runtimeOptions: IContainerRuntimeOptions;
        requestHandlers: RuntimeRequestHandler[];
        instantiateFirstTime(runtime: ContainerRuntime): Promise<void>;
        instantiateFromExisting(runtime: ContainerRuntime): Promise<void>;
        preInitialize(context: IContainerContext, existing: boolean): Promise<IRuntime & IContainerRuntime>;
        readonly IRuntimeFactory: any;
        instantiateRuntime(context: IContainerContext, existing: boolean): Promise<IRuntime>;
        hasInitialized(_runtime: IContainerRuntime): Promise<void>;
    };
}
```

### defaultTimeoutDurationMs {#defaulttimeoutdurationms-variable}

#### Signature {#defaulttimeoutdurationms-signature}

```typescript
defaultTimeoutDurationMs = 250
```

### mockConfigProvider {#mockconfigprovider-variable}

#### Signature {#mockconfigprovider-signature}

```typescript
mockConfigProvider: (settings?: Record<string, ConfigTypes>) => IConfigProviderBase
```

### retryWithEventualValue {#retrywitheventualvalue-variable}

Simple retry mechanism with linear back off to call a function which may eventually return an accepted value.

#### Signature {#retrywitheventualvalue-signature}

```typescript
retryWithEventualValue: <T>(callback: () => Promise<T>, check: (value: T) => boolean, defaultValue: T, maxTries?: number, backOffMs?: number) => Promise<T>
```

### TestContainerRuntimeFactory {#testcontainerruntimefactory-variable}

A container runtime factory that allows you to set runtime options

#### Signature {#testcontainerruntimefactory-signature}

```typescript
TestContainerRuntimeFactory: {
    new (type: string, dataStoreFactory: IFluidDataStoreFactory, runtimeOptions?: IContainerRuntimeOptions, requestHandlers?: RuntimeRequestHandler[]): {
        type: string;
        dataStoreFactory: IFluidDataStoreFactory;
        runtimeOptions: IContainerRuntimeOptions;
        requestHandlers: RuntimeRequestHandler[];
        instantiateFirstTime(runtime: ContainerRuntime): Promise<void>;
        instantiateFromExisting(runtime: ContainerRuntime): Promise<void>;
        preInitialize(context: IContainerContext, existing: boolean): Promise<IRuntime & IContainerRuntime>;
        readonly IRuntimeFactory: any;
        instantiateRuntime(context: IContainerContext, existing: boolean): Promise<IRuntime>;
        hasInitialized(_runtime: IContainerRuntime): Promise<void>;
    };
}
```