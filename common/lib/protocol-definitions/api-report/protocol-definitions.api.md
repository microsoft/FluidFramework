## API Report File for "@fluidframework/protocol-definitions"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { IErrorEvent } from '@fluidframework/common-definitions';
import { IEventProvider } from '@fluidframework/common-definitions';

// @internal
export type ConnectionMode = "write" | "read";

// @internal (undocumented)
export enum FileMode {
    // (undocumented)
    Directory = "040000",
    // (undocumented)
    Executable = "100755",
    // (undocumented)
    File = "100644",
    // (undocumented)
    Symlink = "120000"
}

// @internal @deprecated (undocumented)
export interface IActorClient {
    // (undocumented)
    sub: string;
}

// @internal
export type IApprovedProposal = {
    approvalSequenceNumber: number;
} & ISequencedProposal;

// @internal (undocumented)
export interface IAttachment {
    // (undocumented)
    id: string;
}

// @internal
export interface IBlob {
    contents: string;
    encoding: "utf-8" | "base64";
}

// @internal
export interface IBranchOrigin {
    id: string;
    minimumSequenceNumber: number;
    sequenceNumber: number;
}

// @internal
export interface ICapabilities {
    interactive: boolean;
}

// @internal
export interface IClient {
    details: IClientDetails;
    mode: ConnectionMode;
    // (undocumented)
    permission: string[];
    scopes: string[];
    timestamp?: number;
    user: IUser;
}

// @internal
export interface IClientConfiguration {
    blockSize: number;
    maxMessageSize: number;
    noopCountFrequency?: number;
    noopTimeFrequency?: number;
}

// @internal
export interface IClientDetails {
    capabilities: ICapabilities;
    // (undocumented)
    device?: string;
    // (undocumented)
    environment?: string;
    type?: string;
}

// @internal
export interface IClientJoin {
    clientId: string;
    detail: IClient;
}

// @internal
export type ICommittedProposal = {
    commitSequenceNumber: number;
} & IApprovedProposal;

// @internal
export interface IConnect {
    client: IClient;
    driverVersion?: string;
    epoch?: string;
    id: string;
    mode: ConnectionMode;
    nonce?: string;
    relayUserAgent?: string;
    supportedFeatures?: Record<string, unknown>;
    tenantId: string;
    token: string | null;
    versions: string[];
}

// @internal
export interface IConnected {
    checkpointSequenceNumber?: number;
    claims: ITokenClaims;
    clientId: string;
    epoch?: string;
    existing: boolean;
    initialClients: ISignalClient[];
    initialMessages: ISequencedDocumentMessage[];
    initialSignals: ISignalMessage[];
    maxMessageSize: number;
    mode: ConnectionMode;
    nonce?: string;
    relayServiceAgent?: string;
    serviceConfiguration: IClientConfiguration;
    supportedFeatures?: Record<string, unknown>;
    supportedVersions: string[];
    timestamp?: number;
    version: string;
}

// @internal (undocumented)
export interface ICreateBlobResponse {
    // (undocumented)
    id: string;
}

// @internal (undocumented)
export interface IDocumentAttributes {
    minimumSequenceNumber: number;
    sequenceNumber: number;
}

// @internal
export interface IDocumentMessage {
    clientSequenceNumber: number;
    compression?: string;
    contents: unknown;
    metadata?: unknown;
    referenceSequenceNumber: number;
    serverMetadata?: unknown;
    traces?: ITrace[];
    type: string;
}

// @internal
export interface IDocumentSystemMessage extends IDocumentMessage {
    // (undocumented)
    data: string;
}

// @internal (undocumented)
export interface INack {
    content: INackContent;
    operation: IDocumentMessage | undefined;
    sequenceNumber: number;
}

// @internal
export interface INackContent {
    code: number;
    message: string;
    retryAfter?: number;
    type: NackErrorType;
}

// @internal (undocumented)
export interface IProcessMessageResult {
    // (undocumented)
    immediateNoOp?: boolean;
}

// @internal
export interface IProposal {
    key: string;
    value: unknown;
}

// @internal (undocumented)
export interface IProtocolState {
    // (undocumented)
    members: [string, ISequencedClient][];
    // (undocumented)
    minimumSequenceNumber: number;
    // (undocumented)
    proposals: [number, ISequencedProposal, string[]][];
    // (undocumented)
    sequenceNumber: number;
    // (undocumented)
    values: [string, ICommittedProposal][];
}

// @internal
export interface IQuorum extends Omit<IQuorumClients, "on" | "once" | "off">, Omit<IQuorumProposals, "on" | "once" | "off">, IEventProvider<IQuorumEvents> {
}

// @internal
export interface IQuorumClients extends IEventProvider<IQuorumClientsEvents> {
    // (undocumented)
    getMember(clientId: string): ISequencedClient | undefined;
    // (undocumented)
    getMembers(): Map<string, ISequencedClient>;
}

// @internal
export interface IQuorumClientsEvents extends IErrorEvent {
    // (undocumented)
    (event: "addMember", listener: (clientId: string, details: ISequencedClient) => void): any;
    // (undocumented)
    (event: "removeMember", listener: (clientId: string) => void): any;
}

// @internal
export type IQuorumEvents = IQuorumClientsEvents & IQuorumProposalsEvents;

// @internal
export interface IQuorumProposals extends IEventProvider<IQuorumProposalsEvents> {
    // (undocumented)
    get(key: string): unknown;
    // (undocumented)
    has(key: string): boolean;
    // (undocumented)
    propose(key: string, value: unknown): Promise<void>;
}

// @internal
export interface IQuorumProposalsEvents extends IErrorEvent {
    // (undocumented)
    (event: "addProposal", listener: (proposal: ISequencedProposal) => void): any;
    // (undocumented)
    (event: "approveProposal", listener: (sequenceNumber: number, key: string, value: unknown, approvalSequenceNumber: number) => void): any;
}

// @internal
export interface ISentSignalMessage extends ISignalMessageBase {
    targetClientId?: string;
}

// @internal
export interface ISequencedClient {
    client: IClient;
    sequenceNumber: number;
}

// @internal (undocumented)
export interface ISequencedDocumentAugmentedMessage extends ISequencedDocumentMessage {
    // (undocumented)
    additionalContent: string;
}

// @internal
export interface ISequencedDocumentMessage {
    clientId: string | null;
    clientSequenceNumber: number;
    // @deprecated
    compression?: string;
    contents: unknown;
    data?: string;
    // @deprecated
    expHash1?: string;
    metadata?: unknown;
    minimumSequenceNumber: number;
    origin?: IBranchOrigin;
    referenceSequenceNumber: number;
    sequenceNumber: number;
    serverMetadata?: unknown;
    timestamp: number;
    traces?: ITrace[];
    type: string;
}

// @internal
export type ISequencedDocumentMessageExperimental = Omit<ISequencedDocumentMessage, "expHash1" | "compression"> & {
    expHash1?: string;
    compression?: string;
};

// @internal (undocumented)
export interface ISequencedDocumentSystemMessage extends ISequencedDocumentMessage {
    // (undocumented)
    data: string;
}

// @internal
export type ISequencedProposal = {
    sequenceNumber: number;
} & IProposal;

// @internal
export interface IServerError {
    errorMessage: string;
}

// @internal (undocumented)
export interface ISignalClient {
    client: IClient;
    clientConnectionNumber?: number;
    clientId: string;
    referenceSequenceNumber?: number;
}

// @internal
export interface ISignalMessage extends ISignalMessageBase {
    clientId: string | null;
}

// @internal
export interface ISignalMessageBase {
    clientConnectionNumber?: number;
    content: unknown;
    referenceSequenceNumber?: number;
    type?: string;
}

// @internal (undocumented)
export interface ISnapshotTree {
    // (undocumented)
    blobs: {
        [path: string]: string;
    };
    // (undocumented)
    id?: string;
    // (undocumented)
    trees: {
        [path: string]: ISnapshotTree;
    };
    unreferenced?: true;
}

// @internal (undocumented)
export interface ISnapshotTreeEx extends ISnapshotTree {
    // (undocumented)
    id: string;
    // (undocumented)
    trees: {
        [path: string]: ISnapshotTreeEx;
    };
}

// @internal
export type IsoDate = string;

// @internal
export interface ISummaryAck {
    handle: string;
    summaryProposal: ISummaryProposal;
}

// @internal
export interface ISummaryAttachment {
    // (undocumented)
    id: string;
    // (undocumented)
    type: SummaryType.Attachment;
}

// @internal
export interface ISummaryBlob {
    // (undocumented)
    content: string | Uint8Array;
    // (undocumented)
    type: SummaryType.Blob;
}

// @internal (undocumented)
export interface ISummaryContent {
    details?: IUploadedSummaryDetails;
    handle: string;
    head: string;
    message: string;
    parents: string[];
}

// @internal
export interface ISummaryHandle {
    handle: string;
    handleType: SummaryTypeNoHandle;
    // (undocumented)
    type: SummaryType.Handle;
}

// @internal
export interface ISummaryNack {
    code?: number;
    message?: string;
    retryAfter?: number;
    summaryProposal: ISummaryProposal;
}

// @internal
export interface ISummaryProposal {
    summarySequenceNumber: number;
}

// @internal @deprecated (undocumented)
export interface ISummaryTokenClaims {
    // (undocumented)
    act: IActorClient;
    // (undocumented)
    claims: ITokenClaims;
    // (undocumented)
    sub: string;
}

// @internal
export interface ISummaryTree {
    // (undocumented)
    tree: {
        [path: string]: SummaryObject;
    };
    // (undocumented)
    type: SummaryType.Tree;
    unreferenced?: true;
}

// @internal
export interface ITokenClaims {
    documentId: string;
    exp: number;
    iat: number;
    jti?: string;
    scopes: string[];
    tenantId: string;
    user: IUser;
    ver: string;
}

// @internal @deprecated (undocumented)
export interface ITokenProvider {
    isValid(): boolean;
}

// @internal @deprecated (undocumented)
export interface ITokenService {
    // (undocumented)
    extractClaims(token: string): ITokenClaims;
}

// @internal
export interface ITrace {
    action: string;
    service: string;
    timestamp: number;
}

// @internal (undocumented)
export interface ITree {
    // (undocumented)
    entries: ITreeEntry[];
    id?: string;
    unreferenced?: true;
}

// @internal
export type ITreeEntry = {
    path: string;
    mode: FileMode;
} & ({
    type: TreeEntry.Blob;
    value: IBlob;
} | {
    type: TreeEntry.Tree;
    value: ITree;
} | {
    type: TreeEntry.Attachment;
    value: IAttachment;
});

// @internal (undocumented)
export interface IUploadedSummaryDetails {
    includesProtocolTree?: boolean;
}

// @internal
export interface IUser {
    id: string;
}

// @internal
export interface IVersion {
    date?: IsoDate;
    id: string;
    treeId: string;
}

// @internal (undocumented)
export enum MessageType {
    Accept = "accept",
    ClientJoin = "join",
    ClientLeave = "leave",
    Control = "control",
    NoClient = "noClient",
    NoOp = "noop",
    Operation = "op",
    Propose = "propose",
    Reject = "reject",
    RoundTrip = "tripComplete",
    Summarize = "summarize",
    SummaryAck = "summaryAck",
    SummaryNack = "summaryNack"
}

// @internal
export enum NackErrorType {
    BadRequestError = "BadRequestError",
    InvalidScopeError = "InvalidScopeError",
    LimitExceededError = "LimitExceededError",
    ThrottlingError = "ThrottlingError"
}

// @internal
export enum ScopeType {
    DocRead = "doc:read",
    DocWrite = "doc:write",
    SummaryWrite = "summary:write"
}

// @internal (undocumented)
export enum SignalType {
    ClientJoin = "join",
    ClientLeave = "leave"
}

// @internal
export type SummaryObject = ISummaryTree | ISummaryBlob | ISummaryHandle | ISummaryAttachment;

// @internal
export type SummaryTree = ISummaryTree | ISummaryHandle;

// @internal
export namespace SummaryType {
    // (undocumented)
    export type Attachment = 4;
    // (undocumented)
    export type Blob = 2;
    // (undocumented)
    export type Handle = 3;
    // (undocumented)
    export type Tree = 1;
    const Tree: Tree;
    const Blob: Blob;
    const Handle: Handle;
    const Attachment: Attachment;
}

// @internal
export type SummaryType = SummaryType.Attachment | SummaryType.Blob | SummaryType.Handle | SummaryType.Tree;

// @internal
export type SummaryTypeNoHandle = SummaryType.Tree | SummaryType.Blob | SummaryType.Attachment;

// @internal
export enum TreeEntry {
    // (undocumented)
    Attachment = "Attachment",
    // (undocumented)
    Blob = "Blob",
    // (undocumented)
    Tree = "Tree"
}

```
