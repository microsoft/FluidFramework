{
  "title": "@fluidframework/test-utils Package",
  "kind": "Package",
  "members": {
    "TypeAlias": {
      "ChannelFactoryRegistry": "/docs/apis/test-utils#channelfactoryregistry-typealias",
      "fluidEntryPoint": "/docs/apis/test-utils#fluidentrypoint-typealias",
      "SupportedExportInterfaces": "/docs/apis/test-utils#supportedexportinterfaces-typealias"
    },
    "Function": {
      "createAndAttachContainer": "/docs/apis/test-utils#createandattachcontainer-function",
      "createLoader": "/docs/apis/test-utils#createloader-function",
      "createSummarizer": "/docs/apis/test-utils#createsummarizer-function",
      "createSummarizerFromFactory": "/docs/apis/test-utils#createsummarizerfromfactory-function",
      "getUnexpectedLogErrorException": "/docs/apis/test-utils#getunexpectedlogerrorexception-function",
      "summarizeNow": "/docs/apis/test-utils#summarizenow-function",
      "timeoutAwait": "/docs/apis/test-utils#timeoutawait-function",
      "timeoutPromise": "/docs/apis/test-utils#timeoutpromise-function",
      "waitForContainerConnection": "/docs/apis/test-utils#waitforcontainerconnection-function",
      "wrapDocumentService": "/docs/apis/test-utils#wrapdocumentservice-function",
      "wrapDocumentServiceFactory": "/docs/apis/test-utils#wrapdocumentservicefactory-function",
      "wrapDocumentStorageService": "/docs/apis/test-utils#wrapdocumentstorageservice-function"
    },
    "Variable": {
      "createDocumentId": "/docs/apis/test-utils#createdocumentid-variable",
      "createTestContainerRuntimeFactory": "/docs/apis/test-utils#createtestcontainerruntimefactory-variable",
      "defaultTimeoutDurationMs": "/docs/apis/test-utils#defaulttimeoutdurationms-variable",
      "mockConfigProvider": "/docs/apis/test-utils#mockconfigprovider-variable",
      "retryWithEventualValue": "/docs/apis/test-utils#retrywitheventualvalue-variable",
      "TestContainerRuntimeFactory": "/docs/apis/test-utils#testcontainerruntimefactory-variable"
    },
    "Enum": {
      "DataObjectFactoryType": "/docs/apis/test-utils#dataobjectfactorytype-enum"
    },
    "Class": {
      "EventAndErrorTrackingLogger": "/docs/apis/test-utils/eventanderrortrackinglogger-class",
      "LoaderContainerTracker": "/docs/apis/test-utils/loadercontainertracker-class",
      "LocalCodeLoader": "/docs/apis/test-utils/localcodeloader-class",
      "TestFluidObject": "/docs/apis/test-utils/testfluidobject-class",
      "TestFluidObjectFactory": "/docs/apis/test-utils/testfluidobjectfactory-class",
      "TestObjectProvider": "/docs/apis/test-utils/testobjectprovider-class"
    },
    "Interface": {
      "IOpProcessingController": "/docs/apis/test-utils/iopprocessingcontroller-interface",
      "IProvideTestFluidObject": "/docs/apis/test-utils/iprovidetestfluidobject-interface",
      "ITestContainerConfig": "/docs/apis/test-utils/itestcontainerconfig-interface",
      "ITestFluidObject": "/docs/apis/test-utils/itestfluidobject-interface",
      "ITestObjectProvider": "/docs/apis/test-utils/itestobjectprovider-interface",
      "TimeoutWithError": "/docs/apis/test-utils/timeoutwitherror-interface",
      "TimeoutWithValue": "/docs/apis/test-utils/timeoutwithvalue-interface"
    }
  },
  "package": "@fluidframework/test-utils",
  "unscopedPackageName": "test-utils"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/test-utils](/docs/apis/test-utils)

## Interfaces

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Interface
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/iopprocessingcontroller-interface'>IOpProcessingController</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/iprovidetestfluidobject-interface'>IProvideTestFluidObject</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/itestcontainerconfig-interface'>ITestContainerConfig</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/itestfluidobject-interface'>ITestFluidObject</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/itestobjectprovider-interface'>ITestObjectProvider</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/timeoutwitherror-interface'>TimeoutWithError</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/timeoutwithvalue-interface'>TimeoutWithValue</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Classes

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Class
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/eventanderrortrackinglogger-class'>EventAndErrorTrackingLogger</a>
      </td>
      <td>
        This class tracks events. It allows specifying expected events, which will be looked for in order. It also tracks all unexpected errors. At any point you call reportAndClearTrackedEvents which will provide all unexpected errors, and any expected events that have not occurred.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/loadercontainertracker-class'>LoaderContainerTracker</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/localcodeloader-class'>LocalCodeLoader</a>
      </td>
      <td>
        A simple code loader that caches a mapping of package name to a Fluid entry point. On load, it retrieves the entry point matching the package name in the given code details.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/testfluidobject-class'>TestFluidObject</a>
      </td>
      <td>
        A test Fluid object that will create a shared object for each key-value pair in the factoryEntries passed to load. The shared objects can be retrieved by passing the key of the entry to getSharedObject. It exposes the IFluidDataStoreContext and IFluidDataStoreRuntime.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/testfluidobjectfactory-class'>TestFluidObjectFactory</a>
      </td>
      <td>
        Creates a factory for a TestFluidObject with the given object factory entries. It creates a data store runtime with the object factories in the entry list. All the entries with an id other than undefined are passed to the Fluid object so that it can create a shared object for each.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils/testobjectprovider-class'>TestObjectProvider</a>
      </td>
      <td>
        Shared base class for test object provider. Contain code for loader and container creation and loading
      </td>
    </tr>
  </tbody>
</table>

## Enumerations

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Enum
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#dataobjectfactorytype-enum'>DataObjectFactoryType</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Types

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        TypeAlias
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#channelfactoryregistry-typealias'>ChannelFactoryRegistry</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#fluidentrypoint-typealias'>fluidEntryPoint</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#supportedexportinterfaces-typealias'>SupportedExportInterfaces</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Functions

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Function
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createandattachcontainer-function'>createAndAttachContainer</a>
      </td>
      <td>
        <span>Promise&lt;IContainer&gt;</span>
      </td>
      <td>
        Creates a detached Container and attaches it.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createloader-function'>createLoader</a>
      </td>
      <td>
        <span>IHostLoader</span>
      </td>
      <td>
        Creates a loader with the given package entries and driver.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createsummarizer-function'>createSummarizer</a>
      </td>
      <td>
        <span>Promise&lt;{     container: IContainer;     summarizer: <a href='/docs/apis/container-runtime/isummarizer-interface'>ISummarizer</a>; }&gt;</span>
      </td>
      <td>
        <p>
          Creates a summarizer client from the given container and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.
        </p>
        <p>
          Can pass in a test config provider to enable/disable features.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createsummarizerfromfactory-function'>createSummarizerFromFactory</a>
      </td>
      <td>
        <span>Promise&lt;{     container: IContainer;     summarizer: <a href='/docs/apis/container-runtime/isummarizer-interface'>ISummarizer</a>; }&gt;</span>
      </td>
      <td>
        Creates a summarizer client from the given container and data store factory, and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#getunexpectedlogerrorexception-function'>getUnexpectedLogErrorException</a>
      </td>
      <td>
        <span>Error &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#summarizenow-function'>summarizeNow</a>
      </td>
      <td>
        <span>Promise&lt;{     summaryTree: import(&quot;@fluidframework/protocol-definitions&quot;).<a href='/docs/apis/protocol-definitions/isummarytree-interface'>ISummaryTree</a>;     summaryVersion: string;     summaryRefSeq: number; }&gt;</span>
      </td>
      <td>
        Summarizes on demand and returns the summary tree, the version number and the reference sequence number of the submitted summary.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#timeoutawait-function'>timeoutAwait</a>
      </td>
      <td>
        <span>Promise&lt;T&gt;</span>
      </td>
      <td>
        Wraps the given promise around with promise that will complete after a specific timeout if the original promise does not resolve by then. By default, it uses the mocha test timeout and complete the promise just before that so that tests don't time out because of unpredictable awaits. The timeout can be overridden via timeoutOptions but it's recommended to use the default value.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#timeoutpromise-function'>timeoutPromise</a>
      </td>
      <td>
        <span>Promise&lt;T&gt;</span>
      </td>
      <td>
        Creates a promise from the given executor that will complete after a specific timeout. By default, it uses the mocha test timeout and complete the promise just before that so that tests don't time out because of unpredictable awaits. The timeout can be overridden via timeoutOptions but it's recommended to use the default value.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#waitforcontainerconnection-function'>waitForContainerConnection</a>
      </td>
      <td>
        <span>Promise&lt;void&gt;</span>
      </td>
      <td>
        Utility function to wait for the specified Container to be in Connected state. If the Container is already connected, the Promise returns immediately; otherwise it resolves when the Container emits its 'connected' event. If failOnContainerClose === true, the returned Promise will be rejected if the container emits a 'closed' event before a 'connected' event.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#wrapdocumentservice-function'>wrapDocumentService</a>
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentservice-interface'>IDocumentService</a></span>
      </td>
      <td>
        Wraps the given IDocumentService to override the <code>connectToStorage</code> method. The intent is to plumb the <code>uploadSummaryCb</code> to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document storage service that is created in <code>connectToStorage</code> is wrapped by calling <code>wrapDocumentStorageService</code> to pass in the <code>uploadSummaryCb</code>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#wrapdocumentservicefactory-function'>wrapDocumentServiceFactory</a>
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentservicefactory-interface'>IDocumentServiceFactory</a></span>
      </td>
      <td>
        Wraps the given IDocumentServiceFactory to override the <code>createDocumentService</code> method. The intent is to plumb the <code>uploadSummaryCb</code> all the way to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document service that is created in <code>createDocumentService</code> is wrapped by calling <code>wrapDocumentService</code> to pass in the <code>uploadSummaryCb</code>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#wrapdocumentstorageservice-function'>wrapDocumentStorageService</a>
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentstorageservice-interface'>IDocumentStorageService</a></span>
      </td>
      <td>
        Wraps the given IDocumentStorageService to override the <code>uploadSummaryWithContext</code> method. It calls the <code>uploadSummaryCb</code> whenever a summary is uploaded by the client. The summary context can be updated in the callback before it is uploaded to the server.
      </td>
    </tr>
  </tbody>
</table>

## Variables

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Variable
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createdocumentid-variable'>createDocumentId</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#createtestcontainerruntimefactory-variable'>createTestContainerRuntimeFactory</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        Create a container runtime factory class that allows you to set runtime options
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#defaulttimeoutdurationms-variable'>defaultTimeoutDurationMs</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#mockconfigprovider-variable'>mockConfigProvider</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#retrywitheventualvalue-variable'>retryWithEventualValue</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        Simple retry mechanism with linear back off to call a function which may eventually return an accepted value.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#testcontainerruntimefactory-variable'>TestContainerRuntimeFactory</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        A container runtime factory that allows you to set runtime options
      </td>
    </tr>
  </tbody>
</table>

## Enumeration Details

### DataObjectFactoryType {#dataobjectfactorytype-enum}

#### Signature {#dataobjectfactorytype-signature}

```typescript
export declare enum DataObjectFactoryType
```

#### Flags

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Flag
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#dataobjectfactorytype-primed-enummember'>Primed</a>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/test-utils#dataobjectfactorytype-test-enummember'>Test</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

##### Primed {#dataobjectfactorytype-primed-enummember}

###### Signature {#primed-signature}

```typescript
Primed = 0
```

##### Test {#dataobjectfactorytype-test-enummember}

###### Signature {#test-signature}

```typescript
Test = 1
```

## Type Details

### ChannelFactoryRegistry {#channelfactoryregistry-typealias}

#### Signature {#channelfactoryregistry-signature}

```typescript
export declare type ChannelFactoryRegistry = Iterable<[string | undefined, IChannelFactory]>;
```

### fluidEntryPoint {#fluidentrypoint-typealias}

#### Signature {#fluidentrypoint-signature}

```typescript
export declare type fluidEntryPoint = SupportedExportInterfaces | IFluidModule;
```

### SupportedExportInterfaces {#supportedexportinterfaces-typealias}

#### Signature {#supportedexportinterfaces-signature}

```typescript
export declare type SupportedExportInterfaces = Partial<IProvideRuntimeFactory & IProvideFluidDataStoreFactory & IProvideFluidDataStoreRegistry & IProvideFluidCodeDetailsComparer>;
```

## Function Details

### createAndAttachContainer {#createandattachcontainer-function}

Creates a detached Container and attaches it.

#### Signature {#createandattachcontainer-signature}

```typescript
export declare function createAndAttachContainer(source: IFluidCodeDetails, loader: IHostLoader, attachRequest: IRequest): Promise<IContainer>;
```

#### Parameters {#createandattachcontainer-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        source
      </td>
      <td>
        <span>IFluidCodeDetails</span>
      </td>
      <td>
        The code details used to create the Container.
      </td>
    </tr>
    <tr>
      <td>
        loader
      </td>
      <td>
        <span>IHostLoader</span>
      </td>
      <td>
        The loader to use to initialize the container.
      </td>
    </tr>
    <tr>
      <td>
        attachRequest
      </td>
      <td>
        <span><a href='/docs/apis/core-interfaces/irequest-interface'>IRequest</a></span>
      </td>
      <td>
        The request to create new from.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createandattachcontainer-returns}

**Return type:** Promise&lt;IContainer&gt;

### createLoader {#createloader-function}

Creates a loader with the given package entries and driver.

#### Signature {#createloader-signature}

```typescript
export declare function createLoader(packageEntries: Iterable<[IFluidCodeDetails, fluidEntryPoint]>, documentServiceFactory: IDocumentServiceFactory, urlResolver: IUrlResolver, logger?: ITelemetryBaseLogger, options?: ILoaderOptions): IHostLoader;
```

#### Parameters {#createloader-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        packageEntries
      </td>
      <td>
      </td>
      <td>
        <span>Iterable&lt;[IFluidCodeDetails, <a href='/docs/apis/test-utils#fluidentrypoint-typealias'>fluidEntryPoint</a>]&gt;</span>
      </td>
      <td>
        A list of code details to Fluid entry points.
      </td>
    </tr>
    <tr>
      <td>
        documentServiceFactory
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentservicefactory-interface'>IDocumentServiceFactory</a></span>
      </td>
      <td>
        the driver factory to use
      </td>
    </tr>
    <tr>
      <td>
        urlResolver
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/iurlresolver-interface'>IUrlResolver</a></span>
      </td>
      <td>
        the url resolver to use
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ITelemetryBaseLogger</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        options
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ILoaderOptions</span>
      </td>
      <td>
        loader options
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createloader-returns}

**Return type:** IHostLoader

### createSummarizer {#createsummarizer-function}

Creates a summarizer client from the given container and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.

Can pass in a test config provider to enable/disable features.

#### Signature {#createsummarizer-signature}

```typescript
export declare function createSummarizer(provider: ITestObjectProvider, container: IContainer, config?: ITestContainerConfig, summaryVersion?: string, logger?: ITelemetryBaseLogger): Promise<{
    container: IContainer;
    summarizer: ISummarizer;
}>;
```

#### Parameters {#createsummarizer-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        provider
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/itestobjectprovider-interface'>ITestObjectProvider</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        container
      </td>
      <td>
      </td>
      <td>
        <span>IContainer</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        config
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/itestcontainerconfig-interface'>ITestContainerConfig</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        summaryVersion
      </td>
      <td>
        optional
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ITelemetryBaseLogger</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createsummarizer-returns}

**Return type:** Promise&lt;{     container: IContainer;     summarizer: [ISummarizer](/docs/apis/container-runtime/isummarizer-interface); }&gt;

### createSummarizerFromFactory {#createsummarizerfromfactory-function}

Creates a summarizer client from the given container and data store factory, and returns the summarizer client's IContainer and ISummarizer. The ISummarizer can be used to generate on-demand summaries. The IContainer can be used to fetch data stores, etc.

#### Signature {#createsummarizerfromfactory-signature}

```typescript
export declare function createSummarizerFromFactory(provider: ITestObjectProvider, container: IContainer, dataStoreFactory: IFluidDataStoreFactory, summaryVersion?: string, containerRuntimeFactoryType?: typeof ContainerRuntimeFactoryWithDefaultDataStore, registryEntries?: NamedFluidDataStoreRegistryEntries, logger?: ITelemetryBaseLogger, configProvider?: IConfigProviderBase): Promise<{
    container: IContainer;
    summarizer: ISummarizer;
}>;
```

#### Parameters {#createsummarizerfromfactory-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        provider
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/itestobjectprovider-interface'>ITestObjectProvider</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        container
      </td>
      <td>
      </td>
      <td>
        <span>IContainer</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        dataStoreFactory
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/runtime-definitions/ifluiddatastorefactory-interface'>IFluidDataStoreFactory</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        summaryVersion
      </td>
      <td>
        optional
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        containerRuntimeFactoryType
      </td>
      <td>
        optional
      </td>
      <td>
        <span>typeof <a href='/docs/apis/aqueduct/containerruntimefactorywithdefaultdatastore-class'>ContainerRuntimeFactoryWithDefaultDataStore</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        registryEntries
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/runtime-definitions#namedfluiddatastoreregistryentries-typealias'>NamedFluidDataStoreRegistryEntries</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ITelemetryBaseLogger</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        configProvider
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/telemetry-utils/iconfigproviderbase-interface'>IConfigProviderBase</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createsummarizerfromfactory-returns}

**Return type:** Promise&lt;{     container: IContainer;     summarizer: [ISummarizer](/docs/apis/container-runtime/isummarizer-interface); }&gt;

### getUnexpectedLogErrorException {#getunexpectedlogerrorexception-function}

#### Signature {#getunexpectedlogerrorexception-signature}

```typescript
export declare function getUnexpectedLogErrorException(logger: EventAndErrorTrackingLogger | undefined, prefix?: string): Error | undefined;
```

#### Parameters {#getunexpectedlogerrorexception-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        logger
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/eventanderrortrackinglogger-class'>EventAndErrorTrackingLogger</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        prefix
      </td>
      <td>
        optional
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getunexpectedlogerrorexception-returns}

**Return type:** Error \| undefined

### summarizeNow {#summarizenow-function}

Summarizes on demand and returns the summary tree, the version number and the reference sequence number of the submitted summary.

#### Signature {#summarizenow-signature}

```typescript
export declare function summarizeNow(summarizer: ISummarizer, reason?: string): Promise<{
    summaryTree: import("@fluidframework/protocol-definitions").ISummaryTree;
    summaryVersion: string;
    summaryRefSeq: number;
}>;
```

#### Parameters {#summarizenow-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        summarizer
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/container-runtime/isummarizer-interface'>ISummarizer</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        reason
      </td>
      <td>
        optional
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#summarizenow-returns}

**Return type:** Promise&lt;{     summaryTree: import("@fluidframework/protocol-definitions").[ISummaryTree](/docs/apis/protocol-definitions/isummarytree-interface);     summaryVersion: string;     summaryRefSeq: number; }&gt;

### timeoutAwait {#timeoutawait-function}

Wraps the given promise around with promise that will complete after a specific timeout if the original promise does not resolve by then. By default, it uses the mocha test timeout and complete the promise just before that so that tests don't time out because of unpredictable awaits. The timeout can be overridden via timeoutOptions but it's recommended to use the default value.

#### Signature {#timeoutawait-signature}

```typescript
export declare function timeoutAwait<T = void>(promise: PromiseLike<T>, timeoutOptions?: TimeoutWithError | TimeoutWithValue<T>): Promise<T>;
```

#### Parameters {#timeoutawait-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        promise
      </td>
      <td>
      </td>
      <td>
        <span>PromiseLike&lt;T&gt;</span>
      </td>
      <td>
        The promise to be awaited.
      </td>
    </tr>
    <tr>
      <td>
        timeoutOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/timeoutwitherror-interface'>TimeoutWithError</a> &#124; <a href='/docs/apis/test-utils/timeoutwithvalue-interface'>TimeoutWithValue</a>&lt;T&gt;</span>
      </td>
      <td>
        Options that can be used to override the timeout and / or define the behavior when the promise is not fulfilled. For example, instead of rejecting the promise, resolve with a specific value.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#timeoutawait-returns}

A new promise that will complete when the given promise resolves or the timeout expires.

**Return type:** Promise&lt;T&gt;

### timeoutPromise {#timeoutpromise-function}

Creates a promise from the given executor that will complete after a specific timeout. By default, it uses the mocha test timeout and complete the promise just before that so that tests don't time out because of unpredictable awaits. The timeout can be overridden via timeoutOptions but it's recommended to use the default value.

#### Signature {#timeoutpromise-signature}

```typescript
export declare function timeoutPromise<T = void>(executor: (resolve: (value: T | PromiseLike<T>) => void, reject: (reason?: any) => void) => void, timeoutOptions?: TimeoutWithError | TimeoutWithValue<T>): Promise<T>;
```

#### Parameters {#timeoutpromise-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        executor
      </td>
      <td>
      </td>
      <td>
        <span>(resolve: (value: T &#124; PromiseLike&lt;T&gt;) =&gt; void, reject: (reason?: any) =&gt; void) =&gt; void</span>
      </td>
      <td>
        The executor for the promise.
      </td>
    </tr>
    <tr>
      <td>
        timeoutOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/timeoutwitherror-interface'>TimeoutWithError</a> &#124; <a href='/docs/apis/test-utils/timeoutwithvalue-interface'>TimeoutWithValue</a>&lt;T&gt;</span>
      </td>
      <td>
        Options that can be used to override the timeout and / or define the behavior when the promise is not fulfilled. For example, instead of rejecting the promise, resolve with a specific value.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#timeoutpromise-returns}

A new promise that will complete when the given executor resolves or the timeout expires.

**Return type:** Promise&lt;T&gt;

### waitForContainerConnection {#waitforcontainerconnection-function}

Utility function to wait for the specified Container to be in Connected state. If the Container is already connected, the Promise returns immediately; otherwise it resolves when the Container emits its 'connected' event. If failOnContainerClose === true, the returned Promise will be rejected if the container emits a 'closed' event before a 'connected' event.

#### Signature {#waitforcontainerconnection-signature}

```typescript
export declare function waitForContainerConnection(container: IContainer, failOnContainerClose?: boolean, timeoutOptions?: TimeoutWithError): Promise<void>;
```

#### Parameters {#waitforcontainerconnection-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        container
      </td>
      <td>
      </td>
      <td>
        <span>IContainer</span>
      </td>
      <td>
        The container to wait for.
      </td>
    </tr>
    <tr>
      <td>
        failOnContainerClose
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
        If true, the returned Promise will be rejected if the container emits a 'closed' event before a 'connected' event. Defaults to true.
      </td>
    </tr>
    <tr>
      <td>
        timeoutOptions
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/test-utils/timeoutwitherror-interface'>TimeoutWithError</a></span>
      </td>
      <td>
        Options related to the behavior of the timeout. If provided, the returned Promise will reject if the container hasn't emitted relevant events in timeoutOptions.durationMs. If not provided, the Promise will wait indefinitely for the Container to emit its 'connected' (or 'closed', if failOnContainerClose === true) event.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#waitforcontainerconnection-returns}

A Promise that either: - Resolves when the specified container emits a 'connected' event (or immediately if the Container is already connected). - Rejects if failOnContainerClose === true and the container emits a 'closed' event before a 'connected' event. - Rejects after timeoutOptions.durationMs if timeoutOptions !== undefined and the container does not emit relevant events, within that timeframe.

**Return type:** Promise&lt;void&gt;

### wrapDocumentService {#wrapdocumentservice-function}

Wraps the given IDocumentService to override the `connectToStorage` method. The intent is to plumb the `uploadSummaryCb` to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document storage service that is created in `connectToStorage` is wrapped by calling `wrapDocumentStorageService` to pass in the `uploadSummaryCb`.

#### Signature {#wrapdocumentservice-signature}

```typescript
export declare function wrapDocumentService(innerDocService: IDocumentService, uploadSummaryCb: (summaryTree: ISummaryTree, context: ISummaryContext) => ISummaryContext): IDocumentService;
```

#### Parameters {#wrapdocumentservice-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        innerDocService
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentservice-interface'>IDocumentService</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        uploadSummaryCb
      </td>
      <td>
        <span>(summaryTree: <a href='/docs/apis/protocol-definitions/isummarytree-interface'>ISummaryTree</a>, context: <a href='/docs/apis/driver-definitions/isummarycontext-interface'>ISummaryContext</a>) =&gt; <a href='/docs/apis/driver-definitions/isummarycontext-interface'>ISummaryContext</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#wrapdocumentservice-returns}

**Return type:** [IDocumentService](/docs/apis/driver-definitions/idocumentservice-interface)

### wrapDocumentServiceFactory {#wrapdocumentservicefactory-function}

Wraps the given IDocumentServiceFactory to override the `createDocumentService` method. The intent is to plumb the `uploadSummaryCb` all the way to the IDocumentStorageService so that it is called whenever a summary is uploaded by the client. The document service that is created in `createDocumentService` is wrapped by calling `wrapDocumentService` to pass in the `uploadSummaryCb`.

#### Signature {#wrapdocumentservicefactory-signature}

```typescript
export declare function wrapDocumentServiceFactory(innerDocServiceFactory: IDocumentServiceFactory, uploadSummaryCb: (summaryTree: ISummaryTree, context: ISummaryContext) => ISummaryContext): IDocumentServiceFactory;
```

#### Parameters {#wrapdocumentservicefactory-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        innerDocServiceFactory
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentservicefactory-interface'>IDocumentServiceFactory</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        uploadSummaryCb
      </td>
      <td>
        <span>(summaryTree: <a href='/docs/apis/protocol-definitions/isummarytree-interface'>ISummaryTree</a>, context: <a href='/docs/apis/driver-definitions/isummarycontext-interface'>ISummaryContext</a>) =&gt; <a href='/docs/apis/driver-definitions/isummarycontext-interface'>ISummaryContext</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#wrapdocumentservicefactory-returns}

**Return type:** [IDocumentServiceFactory](/docs/apis/driver-definitions/idocumentservicefactory-interface)

### wrapDocumentStorageService {#wrapdocumentstorageservice-function}

Wraps the given IDocumentStorageService to override the `uploadSummaryWithContext` method. It calls the `uploadSummaryCb` whenever a summary is uploaded by the client. The summary context can be updated in the callback before it is uploaded to the server.

#### Signature {#wrapdocumentstorageservice-signature}

```typescript
export declare function wrapDocumentStorageService(innerDocStorageService: IDocumentStorageService, uploadSummaryCb: (summaryTree: ISummaryTree, context: ISummaryContext) => ISummaryContext): IDocumentStorageService;
```

#### Parameters {#wrapdocumentstorageservice-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        innerDocStorageService
      </td>
      <td>
        <span><a href='/docs/apis/driver-definitions/idocumentstorageservice-interface'>IDocumentStorageService</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        uploadSummaryCb
      </td>
      <td>
        <span>(summaryTree: <a href='/docs/apis/protocol-definitions/isummarytree-interface'>ISummaryTree</a>, context: <a href='/docs/apis/driver-definitions/isummarycontext-interface'>ISummaryContext</a>) =&gt; <a href='/docs/apis/driver-definitions/isummarycontext-interface'>ISummaryContext</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#wrapdocumentstorageservice-returns}

**Return type:** [IDocumentStorageService](/docs/apis/driver-definitions/idocumentstorageservice-interface)

## Variable Details

### createDocumentId {#createdocumentid-variable}

#### Signature {#createdocumentid-signature}

```typescript
createDocumentId: () => string
```

### createTestContainerRuntimeFactory {#createtestcontainerruntimefactory-variable}

Create a container runtime factory class that allows you to set runtime options

#### Signature {#createtestcontainerruntimefactory-signature}

```typescript
createTestContainerRuntimeFactory: (containerRuntimeCtor: typeof ContainerRuntime) => {
    new (type: string, dataStoreFactory: IFluidDataStoreFactory, runtimeOptions?: IContainerRuntimeOptions, requestHandlers?: RuntimeRequestHandler[]): {
        type: string;
        dataStoreFactory: IFluidDataStoreFactory;
        runtimeOptions: IContainerRuntimeOptions;
        requestHandlers: RuntimeRequestHandler[];
        instantiateFirstTime(runtime: ContainerRuntime): Promise<void>;
        instantiateFromExisting(runtime: ContainerRuntime): Promise<void>;
        preInitialize(context: IContainerContext, existing: boolean): Promise<IRuntime & IContainerRuntime>;
        readonly IRuntimeFactory: any;
        instantiateRuntime(context: IContainerContext, existing: boolean): Promise<IRuntime>;
        hasInitialized(_runtime: IContainerRuntime): Promise<void>;
    };
}
```

### defaultTimeoutDurationMs {#defaulttimeoutdurationms-variable}

#### Signature {#defaulttimeoutdurationms-signature}

```typescript
defaultTimeoutDurationMs = 250
```

### mockConfigProvider {#mockconfigprovider-variable}

#### Signature {#mockconfigprovider-signature}

```typescript
mockConfigProvider: (settings?: Record<string, ConfigTypes>) => IConfigProviderBase
```

### retryWithEventualValue {#retrywitheventualvalue-variable}

Simple retry mechanism with linear back off to call a function which may eventually return an accepted value.

#### Signature {#retrywitheventualvalue-signature}

```typescript
retryWithEventualValue: <T>(callback: () => Promise<T>, check: (value: T) => boolean, defaultValue: T, maxTries?: number, backOffMs?: number) => Promise<T>
```

### TestContainerRuntimeFactory {#testcontainerruntimefactory-variable}

A container runtime factory that allows you to set runtime options

#### Signature {#testcontainerruntimefactory-signature}

```typescript
TestContainerRuntimeFactory: {
    new (type: string, dataStoreFactory: IFluidDataStoreFactory, runtimeOptions?: IContainerRuntimeOptions, requestHandlers?: RuntimeRequestHandler[]): {
        type: string;
        dataStoreFactory: IFluidDataStoreFactory;
        runtimeOptions: IContainerRuntimeOptions;
        requestHandlers: RuntimeRequestHandler[];
        instantiateFirstTime(runtime: ContainerRuntime): Promise<void>;
        instantiateFromExisting(runtime: ContainerRuntime): Promise<void>;
        preInitialize(context: IContainerContext, existing: boolean): Promise<IRuntime & IContainerRuntime>;
        readonly IRuntimeFactory: any;
        instantiateRuntime(context: IContainerContext, existing: boolean): Promise<IRuntime>;
        hasInitialized(_runtime: IContainerRuntime): Promise<void>;
    };
}
```
