{
  "title": "TransactionInternal Namespace",
  "summary": "A mutable transaction for applying sequences of changes to a TreeView. Allows viewing the intermediate states.\n\nContains necessary state to apply changes within an edit to a TreeView.\n\nMay have any number of changes applied to make up the edit. Use `close` to complete the transaction, returning the array of changes and an EditingResult showing the results of applying the changes as an Edit to the initial TreeView (passed to the constructor).\n\nNo data outside the Transaction is modified by Transaction: the results from `close` must be used to actually submit an `Edit`.",
  "kind": "Namespace",
  "members": {
    "Interface": {
      "BadPlaceFailure": "/docs/apis/tree/transactioninternal/badplacefailure-interface",
      "BadRangeFailure": "/docs/apis/tree/transactioninternal/badrangefailure-interface",
      "ConstraintViolationFailure": "/docs/apis/tree/transactioninternal/constraintviolationfailure-interface",
      "DetachedSequenceIdAlreadyInUseFailure": "/docs/apis/tree/transactioninternal/detachedsequenceidalreadyinusefailure-interface",
      "DetachedSequenceNotFoundFailure": "/docs/apis/tree/transactioninternal/detachedsequencenotfoundfailure-interface",
      "DuplicateIdInBuildFailure": "/docs/apis/tree/transactioninternal/duplicateidinbuildfailure-interface",
      "IdAlreadyInUseFailure": "/docs/apis/tree/transactioninternal/idalreadyinusefailure-interface",
      "UnknownIdFailure": "/docs/apis/tree/transactioninternal/unknownidfailure-interface",
      "UnusedDetachedSequenceFailure": "/docs/apis/tree/transactioninternal/unuseddetachedsequencefailure-interface"
    },
    "Enum": {
      "ConstraintViolationKind": "/docs/apis/tree/transactioninternal-namespace#constraintviolationkind-enum",
      "FailureKind": "/docs/apis/tree/transactioninternal-namespace#failurekind-enum"
    },
    "TypeAlias": {
      "ConstraintViolationResult": "/docs/apis/tree/transactioninternal-namespace#constraintviolationresult-typealias",
      "Failure": "/docs/apis/tree/transactioninternal-namespace#failure-typealias",
      "ValidState": "/docs/apis/tree/transactioninternal-namespace#validstate-typealias"
    },
    "Function": {
      "factory": "/docs/apis/tree/transactioninternal-namespace#factory-function"
    },
    "Class": {
      "Policy": "/docs/apis/tree/transactioninternal/policy-class"
    }
  },
  "package": "@fluid-experimental/tree",
  "unscopedPackageName": "tree"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluid-experimental/tree](/docs/apis/tree) &gt; [TransactionInternal](/docs/apis/tree/transactioninternal-namespace)

A mutable transaction for applying sequences of changes to a TreeView. Allows viewing the intermediate states.

Contains necessary state to apply changes within an edit to a TreeView.

May have any number of changes applied to make up the edit. Use `close` to complete the transaction, returning the array of changes and an EditingResult showing the results of applying the changes as an Edit to the initial TreeView (passed to the constructor).

No data outside the Transaction is modified by Transaction: the results from `close` must be used to actually submit an `Edit`.

## Signature {#transactioninternal-signature}

```typescript
export declare namespace TransactionInternal
```

## Interfaces

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Interface
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/badplacefailure-interface'>BadPlaceFailure</a>
      </td>
      <td>
        Error thrown when an insert change uses an invalid Place
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/badrangefailure-interface'>BadRangeFailure</a>
      </td>
      <td>
        Error thrown when a detach operation is given an invalid or malformed Range
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/constraintviolationfailure-interface'>ConstraintViolationFailure</a>
      </td>
      <td>
        Error thrown when a constraint fails to apply
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/detachedsequenceidalreadyinusefailure-interface'>DetachedSequenceIdAlreadyInUseFailure</a>
      </td>
      <td>
        Error thrown when a transaction encounters a build operation using an already in use DetachedSequenceID.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/detachedsequencenotfoundfailure-interface'>DetachedSequenceNotFoundFailure</a>
      </td>
      <td>
        Error thrown when a transaction tries to operate on an unknown DetachedSequenceID
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/duplicateidinbuildfailure-interface'>DuplicateIdInBuildFailure</a>
      </td>
      <td>
        Error thrown when a build uses a duplicated NodeId
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/idalreadyinusefailure-interface'>IdAlreadyInUseFailure</a>
      </td>
      <td>
        Error thrown when a build node ID is already used in the current state
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/unknownidfailure-interface'>UnknownIdFailure</a>
      </td>
      <td>
        Error thrown when a change is attempted on an unknown NodeId
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/unuseddetachedsequencefailure-interface'>UnusedDetachedSequenceFailure</a>
      </td>
      <td>
        Error returned when a transaction is closed while there is an unused detached sequence.
      </td>
    </tr>
  </tbody>
</table>

## Classes

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Class
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal/policy-class'>Policy</a>
      </td>
      <td>
        The policy followed by a <a href='/docs/apis/tree/transactioninternal-namespace'>TransactionInternal</a>.
      </td>
    </tr>
  </tbody>
</table>

## Enumerations

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Enum
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#constraintviolationkind-enum'>ConstraintViolationKind</a>
      </td>
      <td>
        Enum of possible kinds of constraint violations that can be encountered
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-enum'>FailureKind</a>
      </td>
      <td>
        The kinds of failures that a transaction might encounter.
      </td>
    </tr>
  </tbody>
</table>

## Types

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        TypeAlias
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#constraintviolationresult-typealias'>ConstraintViolationResult</a>
      </td>
      <td>
        The details of what kind of constraint was violated and caused a ConstraintViolationFailure error to occur
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failure-typealias'>Failure</a>
      </td>
      <td>
        A failure encountered by a transaction.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#validstate-typealias'>ValidState</a>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Functions

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Function
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#factory-function'>factory</a>
      </td>
      <td>
        <span><a href='/docs/apis/tree/generictransaction-class'>GenericTransaction</a></span>
      </td>
      <td>
        Makes a new <a href='/docs/apis/tree/generictransaction-class'>GenericTransaction</a> that follows the <a href='/docs/apis/tree/transactioninternal/policy-class'>Policy</a> policy.
      </td>
    </tr>
  </tbody>
</table>

## Enumeration Details

### ConstraintViolationKind {#constraintviolationkind-enum}

Enum of possible kinds of constraint violations that can be encountered

#### Signature {#constraintviolationkind-signature}

```typescript
export enum ConstraintViolationKind
```

#### Flags

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Flag
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#constraintviolationkind-badlabel-enummember'>BadLabel</a>
      </td>
      <td>
        The constraint failed because the trait label prescribed by the constraint does not match the actual trait label of the range being constrained
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#constraintviolationkind-badlength-enummember'>BadLength</a>
      </td>
      <td>
        The constraint failed because the length prescribed by the constraint does not match the length of range being constrained
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#constraintviolationkind-badparent-enummember'>BadParent</a>
      </td>
      <td>
        The constraint failed because the parent prescribed by the constraint does not match the actual parent of the range being constrained
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#constraintviolationkind-badrange-enummember'>BadRange</a>
      </td>
      <td>
        The constraint failed because it applies to an invalid range
      </td>
    </tr>
  </tbody>
</table>

##### BadLabel {#constraintviolationkind-badlabel-enummember}

The constraint failed because the trait label prescribed by the constraint does not match the actual trait label of the range being constrained

###### Signature {#badlabel-signature}

```typescript
BadLabel = "BadLabel"
```

##### BadLength {#constraintviolationkind-badlength-enummember}

The constraint failed because the length prescribed by the constraint does not match the length of range being constrained

###### Signature {#badlength-signature}

```typescript
BadLength = "BadLength"
```

##### BadParent {#constraintviolationkind-badparent-enummember}

The constraint failed because the parent prescribed by the constraint does not match the actual parent of the range being constrained

###### Signature {#badparent-signature}

```typescript
BadParent = "BadParent"
```

##### BadRange {#constraintviolationkind-badrange-enummember}

The constraint failed because it applies to an invalid range

###### Signature {#badrange-signature}

```typescript
BadRange = "BadRange"
```

### FailureKind {#failurekind-enum}

The kinds of failures that a transaction might encounter.

#### Signature {#failurekind-signature}

```typescript
export enum FailureKind
```

#### Flags

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Flag
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-badplace-enummember'>BadPlace</a>
      </td>
      <td>
        Transaction tries to insert in an invalid Place
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-badrange-enummember'>BadRange</a>
      </td>
      <td>
        Transaction tries to detach an invalid Range
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-constraintviolation-enummember'>ConstraintViolation</a>
      </td>
      <td>
        Transaction has an invalid constraint
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-detachedsequenceidalreadyinuse-enummember'>DetachedSequenceIdAlreadyInUse</a>
      </td>
      <td>
        Transaction has a build operation using an already in use DetachedSequenceID.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-detachedsequencenotfound-enummember'>DetachedSequenceNotFound</a>
      </td>
      <td>
        Transaction tries to operate on an unknown DetachedSequenceID
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-duplicateidinbuild-enummember'>DuplicateIdInBuild</a>
      </td>
      <td>
        Transaction has a build which uses a duplicated NodeId
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-idalreadyinuse-enummember'>IdAlreadyInUse</a>
      </td>
      <td>
        Transaction tries to build a node using an ID which is already used in the current state
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-unknownid-enummember'>UnknownId</a>
      </td>
      <td>
        Transaction tries to set value of an unknown node
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/tree/transactioninternal-namespace#failurekind-unuseddetachedsequence-enummember'>UnusedDetachedSequence</a>
      </td>
      <td>
        Transaction has an unused DetachedSequenceId
      </td>
    </tr>
  </tbody>
</table>

##### BadPlace {#failurekind-badplace-enummember}

Transaction tries to insert in an invalid Place

###### Signature {#badplace-signature}

```typescript
BadPlace = "BadPlace"
```

##### BadRange {#failurekind-badrange-enummember}

Transaction tries to detach an invalid Range

###### Signature {#badrange-signature}

```typescript
BadRange = "BadRange"
```

##### ConstraintViolation {#failurekind-constraintviolation-enummember}

Transaction has an invalid constraint

###### Signature {#constraintviolation-signature}

```typescript
ConstraintViolation = "ConstraintViolation"
```

##### DetachedSequenceIdAlreadyInUse {#failurekind-detachedsequenceidalreadyinuse-enummember}

Transaction has a build operation using an already in use DetachedSequenceID.

###### Signature {#detachedsequenceidalreadyinuse-signature}

```typescript
DetachedSequenceIdAlreadyInUse = "DetachedSequenceIdAlreadyInUse"
```

##### DetachedSequenceNotFound {#failurekind-detachedsequencenotfound-enummember}

Transaction tries to operate on an unknown DetachedSequenceID

###### Signature {#detachedsequencenotfound-signature}

```typescript
DetachedSequenceNotFound = "DetachedSequenceNotFound"
```

##### DuplicateIdInBuild {#failurekind-duplicateidinbuild-enummember}

Transaction has a build which uses a duplicated NodeId

###### Signature {#duplicateidinbuild-signature}

```typescript
DuplicateIdInBuild = "DuplicateIdInBuild"
```

##### IdAlreadyInUse {#failurekind-idalreadyinuse-enummember}

Transaction tries to build a node using an ID which is already used in the current state

###### Signature {#idalreadyinuse-signature}

```typescript
IdAlreadyInUse = "IdAlreadyInUse"
```

##### UnknownId {#failurekind-unknownid-enummember}

Transaction tries to set value of an unknown node

###### Signature {#unknownid-signature}

```typescript
UnknownId = "UnknownId"
```

##### UnusedDetachedSequence {#failurekind-unuseddetachedsequence-enummember}

Transaction has an unused DetachedSequenceId

###### Signature {#unuseddetachedsequence-signature}

```typescript
UnusedDetachedSequence = "UnusedDetachedSequence"
```

## Type Details

### ConstraintViolationResult {#constraintviolationresult-typealias}

The details of what kind of constraint was violated and caused a ConstraintViolationFailure error to occur

#### Signature {#constraintviolationresult-signature}

```typescript
export type ConstraintViolationResult = {
        readonly kind: ConstraintViolationKind.BadRange;
        readonly rangeFailure: BadRangeValidationResult;
    } | {
        readonly kind: ConstraintViolationKind.BadLength;
        readonly actual: number;
    } | {
        readonly kind: ConstraintViolationKind.BadParent;
        readonly actual: NodeId;
    } | {
        readonly kind: ConstraintViolationKind.BadLabel;
        readonly actual: TraitLabel;
    };
```

### Failure {#failure-typealias}

A failure encountered by a transaction.

#### Signature {#failure-signature}

```typescript
export type Failure = UnusedDetachedSequenceFailure | DetachedSequenceIdAlreadyInUseFailure | DetachedSequenceNotFoundFailure | DuplicateIdInBuildFailure | IdAlreadyInUseFailure | UnknownIdFailure | BadPlaceFailure | BadRangeFailure | ConstraintViolationFailure;
```

### ValidState {#validstate-typealias}

#### Signature {#validstate-signature}

```typescript
type ValidState = SucceedingTransactionState;
```

## Function Details

### factory {#factory-function}

Makes a new [GenericTransaction](/docs/apis/tree/generictransaction-class) that follows the [Policy](/docs/apis/tree/transactioninternal/policy-class) policy.

#### Signature {#factory-signature}

```typescript
export function factory(view: RevisionView): GenericTransaction;
```

#### Parameters {#factory-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        view
      </td>
      <td>
        <span><a href='/docs/apis/tree/revisionview-class'>RevisionView</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#factory-returns}

**Return type:** [GenericTransaction](/docs/apis/tree/generictransaction-class)
