{
  "title": "Client Class",
  "kind": "Class",
  "members": {
    "Constructor": {
      "(constructor)": "/docs/apis/merge-tree/client-class#_constructor_-constructor"
    },
    "Method": {
      "addLongClientId": "/docs/apis/merge-tree/client-class#addlongclientid-method",
      "annotateMarker": "/docs/apis/merge-tree/client-class#annotatemarker-method",
      "annotateMarkerNotifyConsensus": "/docs/apis/merge-tree/client-class#annotatemarkernotifyconsensus-method",
      "annotateRangeLocal": "/docs/apis/merge-tree/client-class#annotaterangelocal-method",
      "applyMsg": "/docs/apis/merge-tree/client-class#applymsg-method",
      "applyStashedOp": "/docs/apis/merge-tree/client-class#applystashedop_2-method",
      "cloneFromSegments": "/docs/apis/merge-tree/client-class#clonefromsegments-method",
      "createLocalReferencePosition": "/docs/apis/merge-tree/client-class#createlocalreferenceposition-method",
      "createTextHelper": "/docs/apis/merge-tree/client-class#createtexthelper-method",
      "findReconnectionPosition": "/docs/apis/merge-tree/client-class#findreconnectionposition-method",
      "findTile": "/docs/apis/merge-tree/client-class#findtile-method",
      "getClientId": "/docs/apis/merge-tree/client-class#getclientid-method",
      "getCollabWindow": "/docs/apis/merge-tree/client-class#getcollabwindow-method",
      "getContainingSegment": "/docs/apis/merge-tree/client-class#getcontainingsegment-method",
      "getCurrentSeq": "/docs/apis/merge-tree/client-class#getcurrentseq-method",
      "getLength": "/docs/apis/merge-tree/client-class#getlength-method",
      "getLongClientId": "/docs/apis/merge-tree/client-class#getlongclientid-method",
      "getMarkerFromId": "/docs/apis/merge-tree/client-class#getmarkerfromid-method",
      "getOrAddShortClientId": "/docs/apis/merge-tree/client-class#getoraddshortclientid-method",
      "getPosition": "/docs/apis/merge-tree/client-class#getposition-method",
      "getPropertiesAtPosition": "/docs/apis/merge-tree/client-class#getpropertiesatposition-method",
      "getRangeExtentsOfPosition": "/docs/apis/merge-tree/client-class#getrangeextentsofposition-method",
      "getShortClientId": "/docs/apis/merge-tree/client-class#getshortclientid-method",
      "getStackContext": "/docs/apis/merge-tree/client-class#getstackcontext-method",
      "insertAtReferencePositionLocal": "/docs/apis/merge-tree/client-class#insertatreferencepositionlocal-method",
      "insertSegmentLocal": "/docs/apis/merge-tree/client-class#insertsegmentlocal-method",
      "load": "/docs/apis/merge-tree/client-class#load-method",
      "localReferencePositionToPosition": "/docs/apis/merge-tree/client-class#localreferencepositiontoposition-method",
      "localTransaction": "/docs/apis/merge-tree/client-class#localtransaction-method",
      "peekPendingSegmentGroups": "/docs/apis/merge-tree/client-class#peekpendingsegmentgroups-method",
      "posFromRelativePos": "/docs/apis/merge-tree/client-class#posfromrelativepos-method",
      "regeneratePendingOp": "/docs/apis/merge-tree/client-class#regeneratependingop-method",
      "removeLocalReferencePosition": "/docs/apis/merge-tree/client-class#removelocalreferenceposition-method",
      "removeRangeLocal": "/docs/apis/merge-tree/client-class#removerangelocal-method",
      "resolveRemoteClientPosition": "/docs/apis/merge-tree/client-class#resolveremoteclientposition-method",
      "rollback": "/docs/apis/merge-tree/client-class#rollback-method",
      "serializeGCData": "/docs/apis/merge-tree/client-class#serializegcdata-method",
      "startOrUpdateCollaboration": "/docs/apis/merge-tree/client-class#startorupdatecollaboration-method",
      "summarize": "/docs/apis/merge-tree/client-class#summarize-method",
      "updateConsensusProperty": "/docs/apis/merge-tree/client-class#updateconsensusproperty-method",
      "updateMinSeq": "/docs/apis/merge-tree/client-class#updateminseq-method",
      "updateSeqNumbers": "/docs/apis/merge-tree/client-class#updateseqnumbers-method",
      "walkAllSegments": "/docs/apis/merge-tree/client-class#walkallsegments-method",
      "walkSegments": "/docs/apis/merge-tree/client-class#walksegments_1-method"
    },
    "Property": {
      "logger": "/docs/apis/merge-tree/client-class#logger-property",
      "longClientId": "/docs/apis/merge-tree/client-class#longclientid-property",
      "specToSegment": "/docs/apis/merge-tree/client-class#spectosegment-property"
    }
  },
  "package": "@fluidframework/merge-tree",
  "unscopedPackageName": "merge-tree"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/merge-tree](/docs/apis/merge-tree) &gt; [Client](/docs/apis/merge-tree/client-class)

## Signature {#client-signature}

```typescript
export declare class Client extends TypedEventEmitter<IClientEvents>
```

**Extends:** [TypedEventEmitter](/docs/apis/common-utils/typedeventemitter-class)&lt;IClientEvents&gt;

## Constructors

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Constructor
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#_constructor_-constructor'>(constructor)</a>
      </td>
      <td>
        Constructs a new instance of the <code>Client</code> class
      </td>
    </tr>
  </tbody>
</table>

## Properties

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Property
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#logger-property'>logger</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span><a href='/docs/apis/telemetry-utils/itelemetryloggerext-interface'>ITelemetryLoggerExt</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#longclientid-property'>longClientId</a>
      </td>
      <td>
      </td>
      <td>
        <span>string &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#spectosegment-property'>specToSegment</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span>(spec: <a href='/docs/apis/merge-tree/ijsonsegment-interface'>IJSONSegment</a>) =&gt; <a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Method
      </th>
      <th>
        Alerts
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#addlongclientid-method'>addLongClientId</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#annotatemarker-method'>annotateMarker</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeannotatemsg-interface'>IMergeTreeAnnotateMsg</a> &#124; undefined</span>
      </td>
      <td>
        Annotates the markers with the provided properties
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#annotatemarkernotifyconsensus-method'>annotateMarkerNotifyConsensus</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeannotatemsg-interface'>IMergeTreeAnnotateMsg</a> &#124; undefined</span>
      </td>
      <td>
        Annotate a marker and call the callback on consensus.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#annotaterangelocal-method'>annotateRangeLocal</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeannotatemsg-interface'>IMergeTreeAnnotateMsg</a> &#124; undefined</span>
      </td>
      <td>
        Annotates the range with the provided properties
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#applymsg-method'>applyMsg</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#applystashedop-method'>applyStashedOp</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#applystashedop_1-method'>applyStashedOp</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a>[]</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#applystashedop_2-method'>applyStashedOp</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a> &#124; <a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a>[]</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#clonefromsegments-method'>cloneFromSegments</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/client-class'>Client</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#createlocalreferenceposition-method'>createLocalReferencePosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/localreferenceposition-interface'>LocalReferencePosition</a></span>
      </td>
      <td>
        Creates a <code>LocalReferencePosition</code> on this client. If the refType does not include ReferenceType.Transient, the returned reference will be added to the localRefs on the provided segment.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#createtexthelper-method'>createTextHelper</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreetexthelper-interface'>IMergeTreeTextHelper</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#findreconnectionposition-method'>findReconnectionPosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        During reconnect, we must find the positions to pending segments relative to other pending segments. This methods computes that position relative to a localSeq. Pending segments above the localSeq will be ignored.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#findtile-method'>findTile</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>{         tile: <a href='/docs/apis/merge-tree/referenceposition-interface'>ReferencePosition</a>;         pos: number;     } &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getclientid-method'>getClientId</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getcollabwindow-method'>getCollabWindow</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/collaborationwindow-class'>CollaborationWindow</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getcontainingsegment-method'>getContainingSegment</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>{         segment: T &#124; undefined;         offset: number &#124; undefined;     }</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getcurrentseq-method'>getCurrentSeq</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getlength-method'>getLength</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getlongclientid-method'>getLongClientId</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getmarkerfromid-method'>getMarkerFromId</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getoraddshortclientid-method'>getOrAddShortClientId</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getposition-method'>getPosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        Returns the current position of a segment, and -1 if the segment does not exist in this merge tree
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getpropertiesatposition-method'>getPropertiesAtPosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getrangeextentsofposition-method'>getRangeExtentsOfPosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>{         posStart: number &#124; undefined;         posAfterEnd: number &#124; undefined;     }</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getshortclientid-method'>getShortClientId</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#getstackcontext-method'>getStackContext</a>
      </td>
      <td>
        <code>DEPRECATED</code>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#rangestackmap-typealias'>RangeStackMap</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#insertatreferencepositionlocal-method'>insertAtReferencePositionLocal</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeinsertmsg-interface'>IMergeTreeInsertMsg</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#insertsegmentlocal-method'>insertSegmentLocal</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeinsertmsg-interface'>IMergeTreeInsertMsg</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#load-method'>load</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>Promise&lt;{         catchupOpsP: Promise&lt;<a href='/docs/apis/protocol-definitions/isequenceddocumentmessage-interface'>ISequencedDocumentMessage</a>[]&gt;;     }&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#localreferencepositiontoposition-method'>localReferencePositionToPosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        Resolves a <code>ReferencePosition</code> into a character position using this client's perspective.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#localtransaction-method'>localTransaction</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#peekpendingsegmentgroups-method'>peekPendingSegmentGroups</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a> &#124; <a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a>[] &#124; undefined</span>
      </td>
      <td>
        The merge tree maintains a queue of segment groups for each local operation. These segment groups track segments modified by an operation. This method peeks the tail of that queue, and returns the segments groups there. It is used to get the segment group(s) for the previous operations.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#posfromrelativepos-method'>posFromRelativePos</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        Given a position specified relative to a marker id, lookup the marker and convert the position to a character position.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#regeneratependingop-method'>regeneratePendingOp</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#imergetreeop-typealias'>IMergeTreeOp</a></span>
      </td>
      <td>
        Given an pending operation and segment group, regenerate the op, so it can be resubmitted
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#removelocalreferenceposition-method'>removeLocalReferencePosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/localreferenceposition-interface'>LocalReferencePosition</a> &#124; undefined</span>
      </td>
      <td>
        Removes a <code>LocalReferencePosition</code> from this client.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#removerangelocal-method'>removeRangeLocal</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeremovemsg-interface'>IMergeTreeRemoveMsg</a></span>
      </td>
      <td>
        Removes the range
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#resolveremoteclientposition-method'>resolveRemoteClientPosition</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>number &#124; undefined</span>
      </td>
      <td>
        Resolves a remote client's position against the local sequence and returns the remote client's position relative to the local sequence
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#rollback-method'>rollback</a>
      </td>
      <td>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Revert an op
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#serializegcdata-method'>serializeGCData</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Serializes the data required for garbage collection. The IFluidHandles stored in all segments that haven't been removed represent routes to other objects. We serialize the data in these segments using the passed in serializer which keeps track of all serialized handles.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#startorupdatecollaboration-method'>startOrUpdateCollaboration</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#summarize-method'>summarize</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/runtime-definitions/isummarytreewithstats-interface'>ISummaryTreeWithStats</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#updateconsensusproperty-method'>updateConsensusProperty</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#updateminseq-method'>updateMinSeq</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#updateseqnumbers-method'>updateSeqNumbers</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#walkallsegments-method'>walkAllSegments</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#walksegments-method'>walkSegments</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/client-class#walksegments_1-method'>walkSegments</a>
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Constructor Details

### (constructor) {#_constructor_-constructor}

Constructs a new instance of the `Client` class

#### Signature {#_constructor_-signature}

```typescript
constructor(specToSegment: (spec: IJSONSegment) => ISegment, logger: ITelemetryLoggerExt, options?: PropertySet);
```

#### Parameters {#_constructor_-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        specToSegment
      </td>
      <td>
      </td>
      <td>
        <span>(spec: <a href='/docs/apis/merge-tree/ijsonsegment-interface'>IJSONSegment</a>) =&gt; <a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/telemetry-utils/itelemetryloggerext-interface'>ITelemetryLoggerExt</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        options
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Property Details

### logger {#logger-property}

#### Signature {#logger-signature}

```typescript
readonly logger: ITelemetryLoggerExt;
```

### longClientId {#longclientid-property}

#### Signature {#longclientid-signature}

```typescript
longClientId: string | undefined;
```

### specToSegment {#spectosegment-property}

#### Signature {#spectosegment-signature}

```typescript
readonly specToSegment: (spec: IJSONSegment) => ISegment;
```

## Method Details

### addLongClientId {#addlongclientid-method}

#### Signature {#addlongclientid-signature}

```typescript
addLongClientId(longClientId: string): void;
```

#### Parameters {#addlongclientid-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        longClientId
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### annotateMarker {#annotatemarker-method}

Annotates the markers with the provided properties

#### Signature {#annotatemarker-signature}

```typescript
annotateMarker(marker: Marker, props: PropertySet, combiningOp?: ICombiningOp): IMergeTreeAnnotateMsg | undefined;
```

#### Parameters {#annotatemarker-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        marker
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/marker-class'>Marker</a></span>
      </td>
      <td>
        The marker to annotate
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties to annotate the marker with
      </td>
    </tr>
    <tr>
      <td>
        combiningOp
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/icombiningop-interface'>ICombiningOp</a></span>
      </td>
      <td>
        Optional. Specifies how to combine values for the property, such as &quot;incr&quot; for increment.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#annotatemarker-returns}

The annotate op if valid, otherwise undefined

**Return type:** [IMergeTreeAnnotateMsg](/docs/apis/merge-tree/imergetreeannotatemsg-interface) \| undefined

### annotateMarkerNotifyConsensus {#annotatemarkernotifyconsensus-method}

Annotate a marker and call the callback on consensus.

#### Signature {#annotatemarkernotifyconsensus-signature}

```typescript
annotateMarkerNotifyConsensus(marker: Marker, props: PropertySet, consensusCallback: (m: Marker) => void): IMergeTreeAnnotateMsg | undefined;
```

#### Parameters {#annotatemarkernotifyconsensus-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        marker
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/marker-class'>Marker</a></span>
      </td>
      <td>
        The marker to annotate
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties to annotate the marker with
      </td>
    </tr>
    <tr>
      <td>
        consensusCallback
      </td>
      <td>
        <span>(m: <a href='/docs/apis/merge-tree/marker-class'>Marker</a>) =&gt; void</span>
      </td>
      <td>
        The callback called when consensus is reached
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#annotatemarkernotifyconsensus-returns}

The annotate op if valid, otherwise undefined

**Return type:** [IMergeTreeAnnotateMsg](/docs/apis/merge-tree/imergetreeannotatemsg-interface) \| undefined

### annotateRangeLocal {#annotaterangelocal-method}

Annotates the range with the provided properties

#### Signature {#annotaterangelocal-signature}

```typescript
annotateRangeLocal(start: number, end: number, props: PropertySet, combiningOp: ICombiningOp | undefined): IMergeTreeAnnotateMsg | undefined;
```

#### Parameters {#annotaterangelocal-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The inclusive start position of the range to annotate
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The exclusive end position of the range to annotate
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties to annotate the range with
      </td>
    </tr>
    <tr>
      <td>
        combiningOp
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/icombiningop-interface'>ICombiningOp</a> &#124; undefined</span>
      </td>
      <td>
        Specifies how to combine values for the property, such as &quot;incr&quot; for increment.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#annotaterangelocal-returns}

The annotate op if valid, otherwise undefined

**Return type:** [IMergeTreeAnnotateMsg](/docs/apis/merge-tree/imergetreeannotatemsg-interface) \| undefined

### applyMsg {#applymsg-method}

#### Signature {#applymsg-signature}

```typescript
applyMsg(msg: ISequencedDocumentMessage, local?: boolean): void;
```

#### Parameters {#applymsg-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        msg
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/protocol-definitions/isequenceddocumentmessage-interface'>ISequencedDocumentMessage</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        local
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### applyStashedOp {#applystashedop-method}

#### Signature {#applystashedop-signature}

```typescript
applyStashedOp(op: IMergeTreeDeltaOp): SegmentGroup;
```

#### Parameters {#applystashedop-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        op
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#imergetreedeltaop-typealias'>IMergeTreeDeltaOp</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#applystashedop-returns}

**Return type:** [SegmentGroup](/docs/apis/merge-tree/segmentgroup-interface)

### applyStashedOp {#applystashedop_1-method}

#### Signature {#applystashedop_1-signature}

```typescript
applyStashedOp(op: IMergeTreeGroupMsg): SegmentGroup[];
```

#### Parameters {#applystashedop_1-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        op
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreegroupmsg-interface'>IMergeTreeGroupMsg</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#applystashedop_1-returns}

**Return type:** [SegmentGroup](/docs/apis/merge-tree/segmentgroup-interface)\[\]

### applyStashedOp {#applystashedop_2-method}

#### Signature {#applystashedop_2-signature}

```typescript
applyStashedOp(op: IMergeTreeOp): SegmentGroup | SegmentGroup[];
```

#### Parameters {#applystashedop_2-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        op
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#imergetreeop-typealias'>IMergeTreeOp</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#applystashedop_2-returns}

**Return type:** [SegmentGroup](/docs/apis/merge-tree/segmentgroup-interface) \| [SegmentGroup](/docs/apis/merge-tree/segmentgroup-interface)\[\]

### cloneFromSegments {#clonefromsegments-method}

#### Signature {#clonefromsegments-signature}

```typescript
cloneFromSegments(): Client;
```

#### Returns {#clonefromsegments-returns}

**Return type:** [Client](/docs/apis/merge-tree/client-class)

### createLocalReferencePosition {#createlocalreferenceposition-method}

Creates a `LocalReferencePosition` on this client. If the refType does not include ReferenceType.Transient, the returned reference will be added to the localRefs on the provided segment.

#### Signature {#createlocalreferenceposition-signature}

```typescript
createLocalReferencePosition(segment: ISegment, offset: number | undefined, refType: ReferenceType, properties: PropertySet | undefined, slidingPreference?: SlidingPreference): LocalReferencePosition;
```

#### Parameters {#createlocalreferenceposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        segment
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
        Segment to add the local reference on
      </td>
    </tr>
    <tr>
      <td>
        offset
      </td>
      <td>
      </td>
      <td>
        <span>number &#124; undefined</span>
      </td>
      <td>
        Offset on the segment at which to place the local reference
      </td>
    </tr>
    <tr>
      <td>
        refType
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#referencetype-enum'>ReferenceType</a></span>
      </td>
      <td>
        ReferenceType for the created local reference
      </td>
    </tr>
    <tr>
      <td>
        properties
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a> &#124; undefined</span>
      </td>
      <td>
        PropertySet to place on the created local reference
      </td>
    </tr>
    <tr>
      <td>
        slidingPreference
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#slidingpreference-typealias'>SlidingPreference</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createlocalreferenceposition-returns}

**Return type:** [LocalReferencePosition](/docs/apis/merge-tree/localreferenceposition-interface)

### createTextHelper {#createtexthelper-method}

#### Signature {#createtexthelper-signature}

```typescript
createTextHelper(): IMergeTreeTextHelper;
```

#### Returns {#createtexthelper-returns}

**Return type:** [IMergeTreeTextHelper](/docs/apis/merge-tree/imergetreetexthelper-interface)

### findReconnectionPosition {#findreconnectionposition-method}

During reconnect, we must find the positions to pending segments relative to other pending segments. This methods computes that position relative to a localSeq. Pending segments above the localSeq will be ignored.

#### Signature {#findreconnectionposition-signature}

```typescript
findReconnectionPosition(segment: ISegment, localSeq: number): number;
```

#### Parameters {#findreconnectionposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        segment
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
        The segment to find the position for
      </td>
    </tr>
    <tr>
      <td>
        localSeq
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The localSeq to find the position of the segment at
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#findreconnectionposition-returns}

**Return type:** number

### findTile {#findtile-method}

#### Signature {#findtile-signature}

```typescript
findTile(startPos: number, tileLabel: string, preceding?: boolean): {
        tile: ReferencePosition;
        pos: number;
    } | undefined;
```

#### Parameters {#findtile-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        startPos
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        tileLabel
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        preceding
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#findtile-returns}

**Return type:** {         tile: [ReferencePosition](/docs/apis/merge-tree/referenceposition-interface);         pos: number;     } \| undefined

### getClientId {#getclientid-method}

#### Signature {#getclientid-signature}

```typescript
getClientId(): number;
```

#### Returns {#getclientid-returns}

**Return type:** number

### getCollabWindow {#getcollabwindow-method}

#### Signature {#getcollabwindow-signature}

```typescript
getCollabWindow(): CollaborationWindow;
```

#### Returns {#getcollabwindow-returns}

**Return type:** [CollaborationWindow](/docs/apis/merge-tree/collaborationwindow-class)

### getContainingSegment {#getcontainingsegment-method}

#### Signature {#getcontainingsegment-signature}

```typescript
getContainingSegment<T extends ISegment>(pos: number, sequenceArgs?: Pick<ISequencedDocumentMessage, "referenceSequenceNumber" | "clientId">, localSeq?: number): {
        segment: T | undefined;
        offset: number | undefined;
    };
```

#### Parameters {#getcontainingsegment-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        sequenceArgs
      </td>
      <td>
        optional
      </td>
      <td>
        <span>Pick&lt;<a href='/docs/apis/protocol-definitions/isequenceddocumentmessage-interface'>ISequencedDocumentMessage</a>, &quot;referenceSequenceNumber&quot; &#124; &quot;clientId&quot;&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        localSeq
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getcontainingsegment-returns}

**Return type:** {         segment: T \| undefined;         offset: number \| undefined;     }

### getCurrentSeq {#getcurrentseq-method}

#### Signature {#getcurrentseq-signature}

```typescript
getCurrentSeq(): number;
```

#### Returns {#getcurrentseq-returns}

**Return type:** number

### getLength {#getlength-method}

#### Signature {#getlength-signature}

```typescript
getLength(): number;
```

#### Returns {#getlength-returns}

**Return type:** number

### getLongClientId {#getlongclientid-method}

#### Signature {#getlongclientid-signature}

```typescript
getLongClientId(shortClientId: number): string;
```

#### Parameters {#getlongclientid-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        shortClientId
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getlongclientid-returns}

**Return type:** string

### getMarkerFromId {#getmarkerfromid-method}

#### Signature {#getmarkerfromid-signature}

```typescript
getMarkerFromId(id: string): ISegment | undefined;
```

#### Parameters {#getmarkerfromid-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        id
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getmarkerfromid-returns}

**Return type:** [ISegment](/docs/apis/merge-tree/isegment-interface) \| undefined

### getOrAddShortClientId {#getoraddshortclientid-method}

#### Signature {#getoraddshortclientid-signature}

```typescript
getOrAddShortClientId(longClientId: string): number;
```

#### Parameters {#getoraddshortclientid-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        longClientId
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getoraddshortclientid-returns}

**Return type:** number

### getPosition {#getposition-method}

Returns the current position of a segment, and -1 if the segment does not exist in this merge tree

#### Signature {#getposition-signature}

```typescript
getPosition(segment: ISegment | undefined, localSeq?: number): number;
```

#### Parameters {#getposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        segment
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a> &#124; undefined</span>
      </td>
      <td>
        The segment to get the position of
      </td>
    </tr>
    <tr>
      <td>
        localSeq
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getposition-returns}

**Return type:** number

### getPropertiesAtPosition {#getpropertiesatposition-method}

#### Signature {#getpropertiesatposition-signature}

```typescript
getPropertiesAtPosition(pos: number): PropertySet | undefined;
```

#### Parameters {#getpropertiesatposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getpropertiesatposition-returns}

**Return type:** [PropertySet](/docs/apis/merge-tree#propertyset-typealias) \| undefined

### getRangeExtentsOfPosition {#getrangeextentsofposition-method}

#### Signature {#getrangeextentsofposition-signature}

```typescript
getRangeExtentsOfPosition(pos: number): {
        posStart: number | undefined;
        posAfterEnd: number | undefined;
    };
```

#### Parameters {#getrangeextentsofposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getrangeextentsofposition-returns}

**Return type:** {         posStart: number \| undefined;         posAfterEnd: number \| undefined;     }

### getShortClientId {#getshortclientid-method}

#### Signature {#getshortclientid-signature}

```typescript
getShortClientId(longClientId: string): number;
```

#### Parameters {#getshortclientid-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        longClientId
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getshortclientid-returns}

**Return type:** number

### getStackContext {#getstackcontext-method}

{{% callout warning Deprecated %}}
- this functionality is no longer supported and will be removed

{{% /callout %}}

#### Signature {#getstackcontext-signature}

```typescript
getStackContext(startPos: number, rangeLabels: string[]): RangeStackMap;
```

#### Parameters {#getstackcontext-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        startPos
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        rangeLabels
      </td>
      <td>
        <span>string[]</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getstackcontext-returns}

**Return type:** [RangeStackMap](/docs/apis/merge-tree#rangestackmap-typealias)

### insertAtReferencePositionLocal {#insertatreferencepositionlocal-method}

#### Signature {#insertatreferencepositionlocal-signature}

```typescript
insertAtReferencePositionLocal(refPos: ReferencePosition, segment: ISegment): IMergeTreeInsertMsg | undefined;
```

#### Parameters {#insertatreferencepositionlocal-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        refPos
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/referenceposition-interface'>ReferencePosition</a></span>
      </td>
      <td>
        The reference position to insert the segment at
      </td>
    </tr>
    <tr>
      <td>
        segment
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
        The segment to insert
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#insertatreferencepositionlocal-returns}

**Return type:** [IMergeTreeInsertMsg](/docs/apis/merge-tree/imergetreeinsertmsg-interface) \| undefined

### insertSegmentLocal {#insertsegmentlocal-method}

#### Signature {#insertsegmentlocal-signature}

```typescript
insertSegmentLocal(pos: number, segment: ISegment): IMergeTreeInsertMsg | undefined;
```

#### Parameters {#insertsegmentlocal-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The position to insert the segment at
      </td>
    </tr>
    <tr>
      <td>
        segment
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
        The segment to insert
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#insertsegmentlocal-returns}

**Return type:** [IMergeTreeInsertMsg](/docs/apis/merge-tree/imergetreeinsertmsg-interface) \| undefined

### load {#load-method}

#### Signature {#load-signature}

```typescript
load(runtime: IFluidDataStoreRuntime, storage: IChannelStorageService, serializer: IFluidSerializer): Promise<{
        catchupOpsP: Promise<ISequencedDocumentMessage[]>;
    }>;
```

#### Parameters {#load-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        runtime
      </td>
      <td>
        <span><a href='/docs/apis/datastore-definitions/ifluiddatastoreruntime-interface'>IFluidDataStoreRuntime</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        storage
      </td>
      <td>
        <span><a href='/docs/apis/datastore-definitions/ichannelstorageservice-interface'>IChannelStorageService</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        serializer
      </td>
      <td>
        <span><a href='/docs/apis/shared-object-base/ifluidserializer-interface'>IFluidSerializer</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#load-returns}

**Return type:** Promise&lt;{         catchupOpsP: Promise&lt;[ISequencedDocumentMessage](/docs/apis/protocol-definitions/isequenceddocumentmessage-interface)\[\]&gt;;     }&gt;

### localReferencePositionToPosition {#localreferencepositiontoposition-method}

Resolves a `ReferencePosition` into a character position using this client's perspective.

#### Signature {#localreferencepositiontoposition-signature}

```typescript
localReferencePositionToPosition(lref: ReferencePosition): number;
```

#### Parameters {#localreferencepositiontoposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        lref
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/referenceposition-interface'>ReferencePosition</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#localreferencepositiontoposition-returns}

**Return type:** number

### localTransaction {#localtransaction-method}

#### Signature {#localtransaction-signature}

```typescript
localTransaction(groupOp: IMergeTreeGroupMsg): void;
```

#### Parameters {#localtransaction-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        groupOp
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreegroupmsg-interface'>IMergeTreeGroupMsg</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### peekPendingSegmentGroups {#peekpendingsegmentgroups-method}

The merge tree maintains a queue of segment groups for each local operation. These segment groups track segments modified by an operation. This method peeks the tail of that queue, and returns the segments groups there. It is used to get the segment group(s) for the previous operations.

#### Signature {#peekpendingsegmentgroups-signature}

```typescript
peekPendingSegmentGroups(count?: number): SegmentGroup | SegmentGroup[] | undefined;
```

#### Parameters {#peekpendingsegmentgroups-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        count
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The number segment groups to get peek from the tail of the queue. Default 1.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#peekpendingsegmentgroups-returns}

**Return type:** [SegmentGroup](/docs/apis/merge-tree/segmentgroup-interface) \| [SegmentGroup](/docs/apis/merge-tree/segmentgroup-interface)\[\] \| undefined

### posFromRelativePos {#posfromrelativepos-method}

Given a position specified relative to a marker id, lookup the marker and convert the position to a character position.

#### Signature {#posfromrelativepos-signature}

```typescript
posFromRelativePos(relativePos: IRelativePosition): number;
```

#### Parameters {#posfromrelativepos-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        relativePos
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/irelativeposition-interface'>IRelativePosition</a></span>
      </td>
      <td>
        Id of marker (may be indirect) and whether position is before or after marker.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#posfromrelativepos-returns}

**Return type:** number

### regeneratePendingOp {#regeneratependingop-method}

Given an pending operation and segment group, regenerate the op, so it can be resubmitted

#### Signature {#regeneratependingop-signature}

```typescript
regeneratePendingOp(resetOp: IMergeTreeOp, segmentGroup: SegmentGroup | SegmentGroup[]): IMergeTreeOp;
```

#### Parameters {#regeneratependingop-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        resetOp
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#imergetreeop-typealias'>IMergeTreeOp</a></span>
      </td>
      <td>
        The op to reset
      </td>
    </tr>
    <tr>
      <td>
        segmentGroup
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a> &#124; <a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a>[]</span>
      </td>
      <td>
        The segment group associated with the op
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#regeneratependingop-returns}

**Return type:** [IMergeTreeOp](/docs/apis/merge-tree#imergetreeop-typealias)

### removeLocalReferencePosition {#removelocalreferenceposition-method}

Removes a `LocalReferencePosition` from this client.

#### Signature {#removelocalreferenceposition-signature}

```typescript
removeLocalReferencePosition(lref: LocalReferencePosition): LocalReferencePosition | undefined;
```

#### Parameters {#removelocalreferenceposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        lref
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/localreferenceposition-interface'>LocalReferencePosition</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#removelocalreferenceposition-returns}

**Return type:** [LocalReferencePosition](/docs/apis/merge-tree/localreferenceposition-interface) \| undefined

### removeRangeLocal {#removerangelocal-method}

Removes the range

#### Signature {#removerangelocal-signature}

```typescript
removeRangeLocal(start: number, end: number): IMergeTreeRemoveMsg;
```

#### Parameters {#removerangelocal-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The inclusive start of the range to remove
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The exclusive end of the range to remove
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#removerangelocal-returns}

**Return type:** [IMergeTreeRemoveMsg](/docs/apis/merge-tree/imergetreeremovemsg-interface)

### resolveRemoteClientPosition {#resolveremoteclientposition-method}

Resolves a remote client's position against the local sequence and returns the remote client's position relative to the local sequence

#### Signature {#resolveremoteclientposition-signature}

```typescript
resolveRemoteClientPosition(remoteClientPosition: number, remoteClientRefSeq: number, remoteClientId: string): number | undefined;
```

#### Parameters {#resolveremoteclientposition-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        remoteClientPosition
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The remote client's position to resolve
      </td>
    </tr>
    <tr>
      <td>
        remoteClientRefSeq
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The reference sequence number of the remote client
      </td>
    </tr>
    <tr>
      <td>
        remoteClientId
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        The client id of the remote client
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#resolveremoteclientposition-returns}

**Return type:** number \| undefined

### rollback {#rollback-method}

Revert an op

#### Signature {#rollback-signature}

```typescript
rollback?(op: any, localOpMetadata: unknown): void;
```

#### Parameters {#rollback-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        op
      </td>
      <td>
        <span>any</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        localOpMetadata
      </td>
      <td>
        <span>unknown</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### serializeGCData {#serializegcdata-method}

Serializes the data required for garbage collection. The IFluidHandles stored in all segments that haven't been removed represent routes to other objects. We serialize the data in these segments using the passed in serializer which keeps track of all serialized handles.

#### Signature {#serializegcdata-signature}

```typescript
serializeGCData(handle: IFluidHandle, handleCollectingSerializer: IFluidSerializer): void;
```

#### Parameters {#serializegcdata-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        handle
      </td>
      <td>
        <span><a href='/docs/apis/core-interfaces/ifluidhandle-interface'>IFluidHandle</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        handleCollectingSerializer
      </td>
      <td>
        <span><a href='/docs/apis/shared-object-base/ifluidserializer-interface'>IFluidSerializer</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### startOrUpdateCollaboration {#startorupdatecollaboration-method}

#### Signature {#startorupdatecollaboration-signature}

```typescript
startOrUpdateCollaboration(longClientId: string | undefined, minSeq?: number, currentSeq?: number): void;
```

#### Parameters {#startorupdatecollaboration-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        longClientId
      </td>
      <td>
      </td>
      <td>
        <span>string &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        minSeq
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        currentSeq
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### summarize {#summarize-method}

#### Signature {#summarize-signature}

```typescript
summarize(runtime: IFluidDataStoreRuntime, handle: IFluidHandle, serializer: IFluidSerializer, catchUpMsgs: ISequencedDocumentMessage[]): ISummaryTreeWithStats;
```

#### Parameters {#summarize-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        runtime
      </td>
      <td>
        <span><a href='/docs/apis/datastore-definitions/ifluiddatastoreruntime-interface'>IFluidDataStoreRuntime</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        handle
      </td>
      <td>
        <span><a href='/docs/apis/core-interfaces/ifluidhandle-interface'>IFluidHandle</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        serializer
      </td>
      <td>
        <span><a href='/docs/apis/shared-object-base/ifluidserializer-interface'>IFluidSerializer</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        catchUpMsgs
      </td>
      <td>
        <span><a href='/docs/apis/protocol-definitions/isequenceddocumentmessage-interface'>ISequencedDocumentMessage</a>[]</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#summarize-returns}

**Return type:** [ISummaryTreeWithStats](/docs/apis/runtime-definitions/isummarytreewithstats-interface)

### updateConsensusProperty {#updateconsensusproperty-method}

#### Signature {#updateconsensusproperty-signature}

```typescript
updateConsensusProperty(op: IMergeTreeAnnotateMsg, msg: ISequencedDocumentMessage): void;
```

#### Parameters {#updateconsensusproperty-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        op
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeannotatemsg-interface'>IMergeTreeAnnotateMsg</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        msg
      </td>
      <td>
        <span><a href='/docs/apis/protocol-definitions/isequenceddocumentmessage-interface'>ISequencedDocumentMessage</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### updateMinSeq {#updateminseq-method}

#### Signature {#updateminseq-signature}

```typescript
updateMinSeq(minSeq: number): void;
```

#### Parameters {#updateminseq-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        minSeq
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### updateSeqNumbers {#updateseqnumbers-method}

#### Signature {#updateseqnumbers-signature}

```typescript
updateSeqNumbers(min: number, seq: number): void;
```

#### Parameters {#updateseqnumbers-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        min
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        seq
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### walkAllSegments {#walkallsegments-method}

#### Signature {#walkallsegments-signature}

```typescript
protected walkAllSegments<TClientData>(action: (segment: ISegment, accum?: TClientData) => boolean, accum?: TClientData): boolean;
```

#### Parameters {#walkallsegments-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        action
      </td>
      <td>
      </td>
      <td>
        <span>(segment: <a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a>, accum?: TClientData) =&gt; boolean</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        accum
      </td>
      <td>
        optional
      </td>
      <td>
        <span>TClientData</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#walkallsegments-returns}

**Return type:** boolean

### walkSegments {#walksegments-method}

#### Signature {#walksegments-signature}

```typescript
walkSegments<TClientData>(handler: ISegmentAction<TClientData>, start: number | undefined, end: number | undefined, accum: TClientData, splitRange?: boolean): void;
```

#### Parameters {#walksegments-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        handler
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegmentaction-interface'>ISegmentAction</a>&lt;TClientData&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        start
      </td>
      <td>
      </td>
      <td>
        <span>number &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
      </td>
      <td>
        <span>number &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        accum
      </td>
      <td>
      </td>
      <td>
        <span>TClientData</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        splitRange
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### walkSegments {#walksegments_1-method}

#### Signature {#walksegments_1-signature}

```typescript
walkSegments<undefined>(handler: ISegmentAction<undefined>, start?: number, end?: number, accum?: undefined, splitRange?: boolean): void;
```

#### Parameters {#walksegments_1-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        handler
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegmentaction-interface'>ISegmentAction</a>&lt;undefined&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        start
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        accum
      </td>
      <td>
        optional
      </td>
      <td>
        <span>undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        splitRange
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>
