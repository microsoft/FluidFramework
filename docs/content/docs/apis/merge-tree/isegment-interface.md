{
  "title": "ISegment Interface",
  "summary": "A segment representing a portion of the merge tree. Segments are leaf nodes of the merge tree and contain data.",
  "kind": "Interface",
  "members": {
    "MethodSignature": {
      "ack": "/docs/apis/merge-tree/isegment-interface#ack-methodsignature",
      "addProperties": "/docs/apis/merge-tree/isegment-interface#addproperties-methodsignature",
      "append": "/docs/apis/merge-tree/isegment-interface#append-methodsignature",
      "canAppend": "/docs/apis/merge-tree/isegment-interface#canappend-methodsignature",
      "clone": "/docs/apis/merge-tree/isegment-interface#clone-methodsignature",
      "splitAt": "/docs/apis/merge-tree/isegment-interface#splitat-methodsignature",
      "toJSONObject": "/docs/apis/merge-tree/isegment-interface#tojsonobject-methodsignature"
    },
    "PropertySignature": {
      "attribution": "/docs/apis/merge-tree/isegment-interface#attribution-propertysignature",
      "cachedLength": "/docs/apis/merge-tree/isegment-interface#cachedlength-propertysignature",
      "clientId": "/docs/apis/merge-tree/isegment-interface#clientid-propertysignature",
      "endpointType": "/docs/apis/merge-tree/isegment-interface#endpointtype-propertysignature",
      "localRefs": "/docs/apis/merge-tree/isegment-interface#localrefs-propertysignature",
      "localRemovedSeq": "/docs/apis/merge-tree/isegment-interface#localremovedseq-propertysignature",
      "localSeq": "/docs/apis/merge-tree/isegment-interface#localseq-propertysignature",
      "properties": "/docs/apis/merge-tree/isegment-interface#properties-propertysignature",
      "propertyManager": "/docs/apis/merge-tree/isegment-interface#propertymanager-propertysignature",
      "segmentGroups": "/docs/apis/merge-tree/isegment-interface#segmentgroups-propertysignature",
      "seq": "/docs/apis/merge-tree/isegment-interface#seq-propertysignature",
      "trackingCollection": "/docs/apis/merge-tree/isegment-interface#trackingcollection-propertysignature",
      "type": "/docs/apis/merge-tree/isegment-interface#type-propertysignature"
    }
  },
  "package": "@fluidframework/merge-tree",
  "unscopedPackageName": "merge-tree"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

A segment representing a portion of the merge tree. Segments are leaf nodes of the merge tree and contain data.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

## Signature {#isegment-signature}

```typescript
export interface ISegment extends IMergeNodeCommon, Partial<IRemovalInfo>, Partial<IMoveInfo>
```

**Extends:** [IMergeNodeCommon](/docs/apis/merge-tree/imergenodecommon-interface), Partial&lt;[IRemovalInfo](/docs/apis/merge-tree/iremovalinfo-interface)&gt;, Partial&lt;[IMoveInfo](/docs/apis/merge-tree/imoveinfo-interface)&gt;

## Properties

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Property
      </th>
      <th>
        Alerts
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#attribution-propertysignature'>attribution</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/iattributioncollection-interface'>IAttributionCollection</a>&lt;<a href='/docs/apis/runtime-definitions#attributionkey-typealias'>AttributionKey</a>&gt;</span>
      </td>
      <td>
        <p>
          Stores attribution keys associated with offsets of this segment. This data is only persisted if MergeTree's <code>attributions.track</code> flag is set to true. Pending segments (i.e. ones that only exist locally and haven't been acked by the server) also have <code>attribution === undefined</code> until ack.
        </p>
        <p>
          Keys can be used opaquely with an IAttributor or a container runtime that provides attribution.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#cachedlength-propertysignature'>cachedLength</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The length of the contents of the node.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#clientid-propertysignature'>clientId</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        Short clientId for the client that inserted this segment.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#endpointtype-propertysignature'>endpointType</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>, <code>readonly</code>
      </td>
      <td>
        <span>&quot;start&quot; &#124; &quot;end&quot;</span>
      </td>
      <td>
        <p>
          Whether or not this segment is a special segment denoting the start or end of the tree
        </p>
        <p>
          Endpoint segments are imaginary segments positioned immediately before or after the tree. These segments cannot be referenced by regular operations and exist primarily as a bucket for local references to slide onto during deletion of regular segments.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#localrefs-propertysignature'>localRefs</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/localreferencecollection-class'>LocalReferenceCollection</a></span>
      </td>
      <td>
        Local references added to this segment.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#localremovedseq-propertysignature'>localRemovedSeq</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        <p>
          Local seq at which this segment was removed. If this is defined, <code>removedSeq</code> will initially be set to UnassignedSequenceNumber. However, if another client concurrently removes the same segment, <code>removedSeq</code> will be updated to the seq at which that client removed this segment.
        </p>
        <p>
          Like <a href='/docs/apis/merge-tree/isegment-interface#localseq-propertysignature'>localSeq</a>, this field is cleared once the local removal of the segment is acked. See <a href='/docs/apis/merge-tree/collaborationwindow-class#localseq-property'>localSeq</a> for more information on the semantics of localSeq.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#localseq-propertysignature'>localSeq</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        <p>
          Local seq at which this segment was inserted. This is defined if and only if the insertion of the segment is pending ack, i.e. <code>seq</code> is UnassignedSequenceNumber. Once the segment is acked, this field is cleared.
        </p>
        <p>
          See <a href='/docs/apis/merge-tree/collaborationwindow-class#localseq-property'>localSeq</a> for more information on the semantics of localSeq.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#properties-propertysignature'>properties</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        Properties that have been added to this segment via annotation.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#propertymanager-propertysignature'>propertyManager</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/propertiesmanager-class'>PropertiesManager</a></span>
      </td>
      <td>
        Manages pending local state for properties on this segment.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#segmentgroups-propertysignature'>segmentGroups</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroupcollection-class'>SegmentGroupCollection</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#seq-propertysignature'>seq</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>optional</code>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        Seq at which this segment was inserted. If undefined, it is assumed the segment was inserted prior to the collab window's minimum sequence number.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#trackingcollection-propertysignature'>trackingCollection</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/trackinggroupcollection-class'>TrackingGroupCollection</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#type-propertysignature'>type</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Method
      </th>
      <th>
        Alerts
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#ack-methodsignature'>ack(segmentGroup, opArgs)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
        Acks the current segment against the segment group, op, and merge tree.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#addproperties-methodsignature'>addProperties(newProps, seq, collaborating, rollback)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        Add properties to this segment via annotation.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#append-methodsignature'>append(segment)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#canappend-methodsignature'>canAppend(segment)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#clone-methodsignature'>clone()</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#splitat-methodsignature'>splitAt(pos)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/merge-tree/isegment-interface#tojsonobject-methodsignature'>toJSONObject()</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span>any</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Property Details

### attribution (ALPHA) {#attribution-propertysignature}

Stores attribution keys associated with offsets of this segment. This data is only persisted if MergeTree's `attributions.track` flag is set to true. Pending segments (i.e. ones that only exist locally and haven't been acked by the server) also have `attribution === undefined` until ack.

Keys can be used opaquely with an IAttributor or a container runtime that provides attribution.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#attribution-signature}

```typescript
attribution?: IAttributionCollection<AttributionKey>;
```

#### Remarks {#attribution-remarks}

There are plans to make the shape of the data stored extensible in a couple ways:

1. Injection of custom attribution information associated with the segment (ex: copy-paste of content but keeping the old attribution information).

2. Storage of multiple "channels" of information (ex: track property changes separately from insertion, or only attribute certain property modifications, etc.)

### cachedLength (ALPHA) {#cachedlength-propertysignature}

The length of the contents of the node.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#cachedlength-signature}

```typescript
cachedLength: number;
```

### clientId (ALPHA) {#clientid-propertysignature}

Short clientId for the client that inserted this segment.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#clientid-signature}

```typescript
clientId: number;
```

### endpointType (ALPHA) {#endpointtype-propertysignature}

Whether or not this segment is a special segment denoting the start or end of the tree

Endpoint segments are imaginary segments positioned immediately before or after the tree. These segments cannot be referenced by regular operations and exist primarily as a bucket for local references to slide onto during deletion of regular segments.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#endpointtype-signature}

```typescript
readonly endpointType?: "start" | "end";
```

### localRefs (ALPHA) {#localrefs-propertysignature}

Local references added to this segment.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#localrefs-signature}

```typescript
localRefs?: LocalReferenceCollection;
```

### localRemovedSeq (ALPHA) {#localremovedseq-propertysignature}

Local seq at which this segment was removed. If this is defined, `removedSeq` will initially be set to UnassignedSequenceNumber. However, if another client concurrently removes the same segment, `removedSeq` will be updated to the seq at which that client removed this segment.

Like [localSeq](/docs/apis/merge-tree/isegment-interface#localseq-propertysignature), this field is cleared once the local removal of the segment is acked. See [localSeq](/docs/apis/merge-tree/collaborationwindow-class#localseq-property) for more information on the semantics of localSeq.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#localremovedseq-signature}

```typescript
localRemovedSeq?: number;
```

### localSeq (ALPHA) {#localseq-propertysignature}

Local seq at which this segment was inserted. This is defined if and only if the insertion of the segment is pending ack, i.e. `seq` is UnassignedSequenceNumber. Once the segment is acked, this field is cleared.

See [localSeq](/docs/apis/merge-tree/collaborationwindow-class#localseq-property) for more information on the semantics of localSeq.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#localseq-signature}

```typescript
localSeq?: number;
```

### properties (ALPHA) {#properties-propertysignature}

Properties that have been added to this segment via annotation.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#properties-signature}

```typescript
properties?: PropertySet;
```

### propertyManager (ALPHA) {#propertymanager-propertysignature}

Manages pending local state for properties on this segment.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#propertymanager-signature}

```typescript
propertyManager?: PropertiesManager;
```

### segmentGroups (ALPHA) {#segmentgroups-propertysignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#segmentgroups-signature}

```typescript
readonly segmentGroups: SegmentGroupCollection;
```

### seq (ALPHA) {#seq-propertysignature}

Seq at which this segment was inserted. If undefined, it is assumed the segment was inserted prior to the collab window's minimum sequence number.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#seq-signature}

```typescript
seq?: number;
```

### trackingCollection (ALPHA) {#trackingcollection-propertysignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#trackingcollection-signature}

```typescript
readonly trackingCollection: TrackingGroupCollection;
```

### type (ALPHA) {#type-propertysignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#type-signature}

```typescript
readonly type: string;
```

## Method Details

### ack (ALPHA) {#ack-methodsignature}

Acks the current segment against the segment group, op, and merge tree.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#ack-signature}

```typescript
ack(segmentGroup: SegmentGroup, opArgs: IMergeTreeDeltaOpArgs): boolean;
```

#### Parameters {#ack-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        segmentGroup
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/segmentgroup-interface'>SegmentGroup</a></span>
      </td>
      <td>
        Pending segment group associated with this op.
      </td>
    </tr>
    <tr>
      <td>
        opArgs
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreedeltaopargs-interface'>IMergeTreeDeltaOpArgs</a></span>
      </td>
      <td>
        Information about the op that was acked
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#ack-returns}

`true` if the op modifies the segment, otherwise `false`. The only current false case is overlapping remove, where a segment is removed by a previously sequenced operation before the current operation is acked.

**Return type:** boolean

#### Error Handling {#ack-throws}

- error if the segment state doesn't match segment group or op. E.g. if the segment group is not first in the pending queue, or an inserted segment does not have unassigned sequence number.

### addProperties (ALPHA) {#addproperties-methodsignature}

Add properties to this segment via annotation.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#addproperties-signature}

```typescript
addProperties(newProps: PropertySet, seq?: number, collaborating?: boolean, rollback?: PropertiesRollback): PropertySet;
```

#### Remarks {#addproperties-remarks}

This function should not be called directly. Properties should be added through the `annotateRange` functions.

#### Parameters {#addproperties-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        newProps
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        seq
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        collaborating
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        rollback
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/propertiesrollback-enum'>PropertiesRollback</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#addproperties-returns}

**Return type:** [PropertySet](/docs/apis/merge-tree#propertyset-typealias)

### append (ALPHA) {#append-methodsignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#append-signature}

```typescript
append(segment: ISegment): void;
```

#### Parameters {#append-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        segment
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### canAppend (ALPHA) {#canappend-methodsignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#canappend-signature}

```typescript
canAppend(segment: ISegment): boolean;
```

#### Parameters {#canappend-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        segment
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#canappend-returns}

**Return type:** boolean

### clone (ALPHA) {#clone-methodsignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#clone-signature}

```typescript
clone(): ISegment;
```

#### Returns {#clone-returns}

**Return type:** [ISegment](/docs/apis/merge-tree/isegment-interface)

### splitAt (ALPHA) {#splitat-methodsignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#splitat-signature}

```typescript
splitAt(pos: number): ISegment | undefined;
```

#### Parameters {#splitat-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#splitat-returns}

**Return type:** [ISegment](/docs/apis/merge-tree/isegment-interface) \| undefined

### toJSONObject (ALPHA) {#tojsonobject-methodsignature}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#tojsonobject-signature}

```typescript
toJSONObject(): any;
```

#### Returns {#tojsonobject-returns}

**Return type:** any
