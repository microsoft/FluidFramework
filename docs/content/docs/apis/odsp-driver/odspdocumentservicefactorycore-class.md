{
  "title": "OdspDocumentServiceFactoryCore Class",
  "summary": "Factory for creating the sharepoint document service. Use this if you want to use the sharepoint implementation.\n\nThis constructor should be used by environments that support dynamic imports and that wish to leverage code splitting as a means to keep bundles as small as possible.",
  "kind": "Class",
  "members": {
    "Constructor": {
      "(constructor)": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#_constructor_-constructor"
    },
    "Method": {
      "createContainer": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#createcontainer-method",
      "createDocumentService": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#createdocumentservice-method",
      "createDocumentServiceCore": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#createdocumentservicecore-method",
      "getRelayServiceSessionInfo": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#getrelayservicesessioninfo-method"
    },
    "Property": {
      "IRelaySessionAwareDriverFactory": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#irelaysessionawaredriverfactory-property",
      "persistedCache": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#persistedcache-property",
      "snapshotPrefetchResultCache": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#snapshotprefetchresultcache-property"
    }
  },
  "package": "@fluidframework/odsp-driver",
  "unscopedPackageName": "odsp-driver"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/odsp-driver](/docs/apis/odsp-driver) &gt; [OdspDocumentServiceFactoryCore](/docs/apis/odsp-driver/odspdocumentservicefactorycore-class)

Factory for creating the sharepoint document service. Use this if you want to use the sharepoint implementation.

This constructor should be used by environments that support dynamic imports and that wish to leverage code splitting as a means to keep bundles as small as possible.

## Signature {#odspdocumentservicefactorycore-signature}

```typescript
export declare class OdspDocumentServiceFactoryCore implements IDocumentServiceFactory, IRelaySessionAwareDriverFactory
```

**Implements:** [IDocumentServiceFactory](/docs/apis/driver-definitions/idocumentservicefactory-interface), [IRelaySessionAwareDriverFactory](/docs/apis/odsp-driver-definitions/irelaysessionawaredriverfactory-interface)

## Constructors

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Constructor
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#_constructor_-constructor'>(constructor)</a>
      </td>
      <td>
        Constructs a new instance of the <code>OdspDocumentServiceFactoryCore</code> class
      </td>
    </tr>
  </tbody>
</table>

## Properties

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Property
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#irelaysessionawaredriverfactory-property'>IRelaySessionAwareDriverFactory</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span>this</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#persistedcache-property'>persistedCache</a>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions/ipersistedcache-interface'>IPersistedCache</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#snapshotprefetchresultcache-property'>snapshotPrefetchResultCache</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span>import(&quot;@fluidframework/core-utils&quot;).<a href='/docs/apis/core-utils/promisecache-class'>PromiseCache</a>&lt;string, import(&quot;./odspCache&quot;).IPrefetchSnapshotContents&gt;</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Method
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#createcontainer-method'>createContainer</a>
      </td>
      <td>
        <span>Promise&lt;<a href='/docs/apis/driver-definitions/idocumentservice-interface'>IDocumentService</a>&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#createdocumentservice-method'>createDocumentService</a>
      </td>
      <td>
        <span>Promise&lt;<a href='/docs/apis/driver-definitions/idocumentservice-interface'>IDocumentService</a>&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#createdocumentservicecore-method'>createDocumentServiceCore</a>
      </td>
      <td>
        <span>Promise&lt;<a href='/docs/apis/driver-definitions/idocumentservice-interface'>IDocumentService</a>&gt;</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#getrelayservicesessioninfo-method'>getRelayServiceSessionInfo</a>
      </td>
      <td>
        <span>Promise&lt;<a href='/docs/apis/odsp-driver-definitions/isocketstoragediscovery-interface'>ISocketStorageDiscovery</a> &#124; undefined&gt;</span>
      </td>
      <td>
        This function would return info about relay service session only if this factory established (or attempted to establish) connection very recently. Otherwise, it will return undefined.
      </td>
    </tr>
  </tbody>
</table>

## Constructor Details

### (constructor) {#_constructor_-constructor}

Constructs a new instance of the `OdspDocumentServiceFactoryCore` class

#### Signature {#_constructor_-signature}

```typescript
constructor(getStorageToken: TokenFetcher<OdspResourceTokenFetchOptions>, getWebsocketToken: TokenFetcher<OdspResourceTokenFetchOptions> | undefined, persistedCache?: IPersistedCache, hostPolicy?: HostStoragePolicy);
```

#### Parameters {#_constructor_-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        getStorageToken
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions#tokenfetcher-typealias'>TokenFetcher</a>&lt;<a href='/docs/apis/odsp-driver-definitions/odspresourcetokenfetchoptions-interface'>OdspResourceTokenFetchOptions</a>&gt;</span>
      </td>
      <td>
        function that can provide the storage token for a given site. This is is also referred to as the &quot;Vroom&quot; token in SPO.
      </td>
    </tr>
    <tr>
      <td>
        getWebsocketToken
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions#tokenfetcher-typealias'>TokenFetcher</a>&lt;<a href='/docs/apis/odsp-driver-definitions/odspresourcetokenfetchoptions-interface'>OdspResourceTokenFetchOptions</a>&gt; &#124; undefined</span>
      </td>
      <td>
        function that can provide a token for accessing the web socket. This is also to as the &quot;Push&quot; token in SPO. If undefined then websocket token is expected to be returned with joinSession response payload.
      </td>
    </tr>
    <tr>
      <td>
        persistedCache
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions/ipersistedcache-interface'>IPersistedCache</a></span>
      </td>
      <td>
        PersistedCache provided by host for use in this session.
      </td>
    </tr>
    <tr>
      <td>
        hostPolicy
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions/hoststoragepolicy-interface'>HostStoragePolicy</a></span>
      </td>
      <td>
        Policy for storage provided by host.
      </td>
    </tr>
  </tbody>
</table>

## Property Details

### IRelaySessionAwareDriverFactory {#irelaysessionawaredriverfactory-property}

#### Signature {#irelaysessionawaredriverfactory-signature}

```typescript
get IRelaySessionAwareDriverFactory(): this;
```

### persistedCache {#persistedcache-property}

#### Signature {#persistedcache-signature}

```typescript
protected persistedCache: IPersistedCache;
```

### snapshotPrefetchResultCache {#snapshotprefetchresultcache-property}

#### Signature {#snapshotprefetchresultcache-signature}

```typescript
get snapshotPrefetchResultCache(): import("@fluidframework/core-utils").PromiseCache<string, import("./odspCache").IPrefetchSnapshotContents>;
```

## Method Details

### createContainer {#createcontainer-method}

#### Signature {#createcontainer-signature}

```typescript
createContainer(createNewSummary: ISummaryTree | undefined, createNewResolvedUrl: IResolvedUrl, logger?: ITelemetryBaseLogger, clientIsSummarizer?: boolean): Promise<IDocumentService>;
```

#### Parameters {#createcontainer-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        createNewSummary
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/protocol-definitions/isummarytree-interface'>ISummaryTree</a> &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        createNewResolvedUrl
      </td>
      <td>
      </td>
      <td>
        <span>IResolvedUrl</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ITelemetryBaseLogger</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        clientIsSummarizer
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createcontainer-returns}

**Return type:** Promise&lt;[IDocumentService](/docs/apis/driver-definitions/idocumentservice-interface)&gt;

### createDocumentService {#createdocumentservice-method}

#### Signature {#createdocumentservice-signature}

```typescript
createDocumentService(resolvedUrl: IResolvedUrl, logger?: ITelemetryBaseLogger, clientIsSummarizer?: boolean): Promise<IDocumentService>;
```

#### Parameters {#createdocumentservice-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        resolvedUrl
      </td>
      <td>
      </td>
      <td>
        <span>IResolvedUrl</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ITelemetryBaseLogger</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        clientIsSummarizer
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createdocumentservice-returns}

**Return type:** Promise&lt;[IDocumentService](/docs/apis/driver-definitions/idocumentservice-interface)&gt;

### createDocumentServiceCore {#createdocumentservicecore-method}

#### Signature {#createdocumentservicecore-signature}

```typescript
protected createDocumentServiceCore(resolvedUrl: IResolvedUrl, odspLogger: ITelemetryLogger, cacheAndTrackerArg?: ICacheAndTracker, clientIsSummarizer?: boolean): Promise<IDocumentService>;
```

#### Parameters {#createdocumentservicecore-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        resolvedUrl
      </td>
      <td>
      </td>
      <td>
        <span>IResolvedUrl</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        odspLogger
      </td>
      <td>
      </td>
      <td>
        <span>ITelemetryLogger</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        cacheAndTrackerArg
      </td>
      <td>
        optional
      </td>
      <td>
        <span>ICacheAndTracker</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        clientIsSummarizer
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createdocumentservicecore-returns}

**Return type:** Promise&lt;[IDocumentService](/docs/apis/driver-definitions/idocumentservice-interface)&gt;

### getRelayServiceSessionInfo {#getrelayservicesessioninfo-method}

This function would return info about relay service session only if this factory established (or attempted to establish) connection very recently. Otherwise, it will return undefined.

#### Signature {#getrelayservicesessioninfo-signature}

```typescript
getRelayServiceSessionInfo(resolvedUrl: IResolvedUrl): Promise<ISocketStorageDiscovery | undefined>;
```

#### Parameters {#getrelayservicesessioninfo-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        resolvedUrl
      </td>
      <td>
        <span>IResolvedUrl</span>
      </td>
      <td>
        resolved url for container
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getrelayservicesessioninfo-returns}

- Current join session response stored in cache. Undefined if not present.

**Return type:** Promise&lt;[ISocketStorageDiscovery](/docs/apis/odsp-driver-definitions/isocketstoragediscovery-interface) \| undefined&gt;
