{
  "title": "OdspDocumentServiceFactoryCore Class",
  "summary": "Factory for creating the sharepoint document service. Use this if you want to use the sharepoint implementation.\n\nThis constructor should be used by environments that support dynamic imports and that wish to leverage code splitting as a means to keep bundles as small as possible.",
  "kind": "Class",
  "members": {
    "Constructor": {
      "(constructor)": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#_constructor_-constructor"
    },
    "Property": {
      "IRelaySessionAwareDriverFactory": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#irelaysessionawaredriverfactory-property",
      "persistedCache": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#persistedcache-property",
      "snapshotPrefetchResultCache": "/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#snapshotprefetchresultcache-property"
    }
  },
  "package": "@fluidframework/odsp-driver",
  "unscopedPackageName": "odsp-driver"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

Factory for creating the sharepoint document service. Use this if you want to use the sharepoint implementation.

This constructor should be used by environments that support dynamic imports and that wish to leverage code splitting as a means to keep bundles as small as possible.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

## Signature {#odspdocumentservicefactorycore-signature}

```typescript
export declare class OdspDocumentServiceFactoryCore implements IDocumentServiceFactory, IRelaySessionAwareDriverFactory
```

**Implements:** [IDocumentServiceFactory](/docs/apis/driver-definitions/idocumentservicefactory-interface), [IRelaySessionAwareDriverFactory](/docs/apis/odsp-driver-definitions/irelaysessionawaredriverfactory-interface)

## Constructors

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Constructor
      </th>
      <th>
        Alerts
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#_constructor_-constructor'>(constructor)(getStorageToken, getWebsocketToken, persistedCache, hostPolicy)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        Constructs a new instance of the <code>OdspDocumentServiceFactoryCore</code> class
      </td>
    </tr>
  </tbody>
</table>

## Properties

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Property
      </th>
      <th>
        Alerts
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#irelaysessionawaredriverfactory-property'>IRelaySessionAwareDriverFactory</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span>this</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#persistedcache-property'>persistedCache</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions/ipersistedcache-interface'>IPersistedCache</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/odsp-driver/odspdocumentservicefactorycore-class#snapshotprefetchresultcache-property'>snapshotPrefetchResultCache</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span>import(&quot;@fluidframework/core-utils&quot;).<a href='/docs/apis/core-utils/promisecache-class'>PromiseCache</a>&lt;string, import(&quot;./odspCache&quot;).<a href='/docs/apis/odsp-driver/iprefetchsnapshotcontents-interface'>IPrefetchSnapshotContents</a>&gt;</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Constructor Details

### (constructor) (ALPHA) {#_constructor_-constructor}

Constructs a new instance of the `OdspDocumentServiceFactoryCore` class

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#_constructor_-signature}

```typescript
constructor(getStorageToken: TokenFetcher<OdspResourceTokenFetchOptions>, getWebsocketToken: TokenFetcher<OdspResourceTokenFetchOptions> | undefined, persistedCache?: IPersistedCache, hostPolicy?: HostStoragePolicy);
```

#### Parameters {#_constructor_-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        getStorageToken
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions#tokenfetcher-typealias'>TokenFetcher</a>&lt;<a href='/docs/apis/odsp-driver-definitions/odspresourcetokenfetchoptions-interface'>OdspResourceTokenFetchOptions</a>&gt;</span>
      </td>
      <td>
        function that can provide the storage token for a given site. This is is also referred to as the &quot;Vroom&quot; token in SPO.
      </td>
    </tr>
    <tr>
      <td>
        getWebsocketToken
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions#tokenfetcher-typealias'>TokenFetcher</a>&lt;<a href='/docs/apis/odsp-driver-definitions/odspresourcetokenfetchoptions-interface'>OdspResourceTokenFetchOptions</a>&gt; &#124; undefined</span>
      </td>
      <td>
        function that can provide a token for accessing the web socket. This is also to as the &quot;Push&quot; token in SPO. If undefined then websocket token is expected to be returned with joinSession response payload.
      </td>
    </tr>
    <tr>
      <td>
        persistedCache
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions/ipersistedcache-interface'>IPersistedCache</a></span>
      </td>
      <td>
        PersistedCache provided by host for use in this session.
      </td>
    </tr>
    <tr>
      <td>
        hostPolicy
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/odsp-driver-definitions/hoststoragepolicy-interface'>HostStoragePolicy</a></span>
      </td>
      <td>
        Policy for storage provided by host.
      </td>
    </tr>
  </tbody>
</table>

## Property Details

### IRelaySessionAwareDriverFactory (ALPHA) {#irelaysessionawaredriverfactory-property}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#irelaysessionawaredriverfactory-signature}

```typescript
get IRelaySessionAwareDriverFactory(): this;
```

### persistedCache (ALPHA) {#persistedcache-property}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#persistedcache-signature}

```typescript
protected persistedCache: IPersistedCache;
```

### snapshotPrefetchResultCache (ALPHA) {#snapshotprefetchresultcache-property}

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#snapshotprefetchresultcache-signature}

```typescript
get snapshotPrefetchResultCache(): import("@fluidframework/core-utils").PromiseCache<string, import("./odspCache").IPrefetchSnapshotContents>;
```
