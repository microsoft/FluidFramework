{
  "title": "@fluidframework/id-compressor Package",
  "kind": "Package",
  "members": {
    "Function": {
      "createIdCompressor": "/docs/apis/id-compressor#createidcompressor_1-function",
      "createSessionId": "/docs/apis/id-compressor#createsessionid-function",
      "deserializeIdCompressor": "/docs/apis/id-compressor#deserializeidcompressor_1-function"
    },
    "Class": {
      "IdCompressor": "/docs/apis/id-compressor/idcompressor-class"
    },
    "Interface": {
      "IdCreationRange": "/docs/apis/id-compressor/idcreationrange-interface",
      "IIdCompressor": "/docs/apis/id-compressor/iidcompressor-interface",
      "IIdCompressorCore": "/docs/apis/id-compressor/iidcompressorcore-interface"
    },
    "TypeAlias": {
      "OpSpaceCompressedId": "/docs/apis/id-compressor#opspacecompressedid-typealias",
      "SerializedIdCompressor": "/docs/apis/id-compressor#serializedidcompressor-typealias",
      "SerializedIdCompressorWithNoSession": "/docs/apis/id-compressor#serializedidcompressorwithnosession-typealias",
      "SerializedIdCompressorWithOngoingSession": "/docs/apis/id-compressor#serializedidcompressorwithongoingsession-typealias",
      "SessionId": "/docs/apis/id-compressor#sessionid-typealias",
      "SessionSpaceCompressedId": "/docs/apis/id-compressor#sessionspacecompressedid-typealias",
      "StableId": "/docs/apis/id-compressor#stableid-typealias"
    }
  },
  "package": "@fluidframework/id-compressor",
  "unscopedPackageName": "id-compressor"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

## Interfaces

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Interface
      </th>
      <th>
        Alerts
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor/idcreationrange-interface'>IdCreationRange</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <p>
          Data describing a range of session-local IDs (from a remote or local session).
        </p>
        <p>
          A range is composed of local IDs that were generated.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a>
      </td>
      <td>
      </td>
      <td>
        <p>
          A distributed UUID generator and compressor.
        </p>
        <p>
          Generates arbitrary non-colliding v4 UUIDs, called stable IDs, for multiple &quot;sessions&quot; (which can be distributed across the network), providing each session with the ability to map these UUIDs to <code>numbers</code>.
        </p>
        <p>
          A session is a unique identifier that denotes a single compressor. New IDs are created through a single compressor API which should then sent in ranges to the server for total ordering (and are subsequently relayed to other clients). When a new ID is created it is said to be created by the compressor's &quot;local&quot; session.
        </p>
        <p>
          For each stable ID created, two numeric IDs are provided by the compressor:
        </p>
        <p>
          1. A session-local ID, which is stable for the lifetime of the session (which could be longer than that of the compressor object, as it may be serialized for offline usage). Available as soon as the stable ID is allocated. These IDs are session-unique and are thus only safely usable within the scope of the compressor that created it.
        </p>
        <p>
          2. A final ID, which is stable across serialization and deserialization of an IdCompressor. Available as soon as the range containing the corresponding session-local ID is totally ordered (via consensus) with respect to other sessions' allocations. Final IDs are known to and publicly usable by any compressor that has received them.
        </p>
        <p>
          Compressors will allocate UUIDs in non-random ways to reduce entropy allowing for optimized storage of the data needed to map the UUIDs to the numbers.
        </p>
        <p>
          The following invariants are upheld by IdCompressor:
        </p>
        <p>
          1. Session-local IDs will always decompress to the same UUIDs for the lifetime of the session.
        </p>
        <p>
          2. Final IDs will always decompress to the same UUIDs.
        </p>
        <p>
          3. After a server-processed range of session-local IDs (from any session) is received by a compressor, any of those session-local IDs may be translated by the compressor into the corresponding final ID. For any given session-local ID, this translation will always yield the same final ID.
        </p>
        <p>
          4. A UUID will always compress into the same session-local ID for the lifetime of the session.
        </p>
        <p>
          Session-local IDs are sent across the wire in efficiently-represented ranges. These ranges are created by querying the compressor, and *must* be ordered (i.e. sent to the server) in the order they are created in order to preserve the above invariants.
        </p>
        <p>
          Session-local IDs can be used immediately after creation, but will eventually (after being sequenced) have a corresponding final ID. This could make reasoning about equality of those two forms difficult. For example, if a cache is keyed off of a session-local ID but is later queried using the final ID (which is semantically equal, as it decompresses to the same UUID/string) it will produce a cache miss. In order to make using collections of both remotely created and locally created IDs easy, regardless of whether the session-local IDs have been finalized, the compressor defines two &quot;spaces&quot; of IDs:
        </p>
        <p>
          1. Session space: in this space, all IDs are normalized to their &quot;most local form&quot;. This means that all IDs created by the local session will be in local form, regardless of if they have been finalized. Remotely created IDs, which could only have been received after finalizing and will never have a local form for the compressor, will of course be final IDs. This space should be used with consumer APIs and data structures, as the lifetime of the IDs is guaranteed to be the same as the compressor object. Care must be taken to not use these IDs across compressor objects, as the local IDs are specific to the compressor that created them.
        </p>
        <p>
          2. Op space: in this space, all IDs are normalized to their &quot;most final form&quot;. This means that all IDs except session-local IDs that have not yet been finalized will be in final ID form. This space is useful for serialization in ops (e.g. references), as other clients that receive them need not do any work to normalize them to *their* session-space in the common case. Note that IDs in op space may move out of Op space over time, namely, when a session-local ID in this space becomes finalized, and thereafter has a &quot;more final form&quot;. Consequentially, it may be useful to restrict parameters of a persisted type to this space (to optimize perf), but it is potentially incorrect to use this type for a runtime variable. This is an asymmetry that does not affect session space, as local IDs are always as &quot;local as possible&quot;.
        </p>
        <p>
          These two spaces naturally define a rule: consumers of compressed IDs should use session-space IDs, but serialized forms such as ops should use op-space IDs.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor/iidcompressorcore-interface'>IIdCompressorCore</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Classes

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Class
      </th>
      <th>
        Alerts
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor/idcompressor-class'>IdCompressor</a>
      </td>
      <td>
        <code>ALPHA</code>, <code>DEPRECATED</code>
      </td>
      <td>
        See <a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a> and <a href='/docs/apis/id-compressor/iidcompressorcore-interface'>IIdCompressorCore</a>
      </td>
    </tr>
  </tbody>
</table>

## Types

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        TypeAlias
      </th>
      <th>
        Alerts
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#opspacecompressedid-typealias'>OpSpaceCompressedId</a>
      </td>
      <td>
      </td>
      <td>
        A compressed ID that has been normalized into &quot;op space&quot;. Serialized/persisted structures (e.g. ops) should use op-space IDs as a performance optimization, as they require less normalizing when received by a remote client due to the fact that op space for a given compressor is session space for all other compressors.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#serializedidcompressor-typealias'>SerializedIdCompressor</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        The serialized contents of an IdCompressor, suitable for persistence in a summary.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#serializedidcompressorwithnosession-typealias'>SerializedIdCompressorWithNoSession</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        The serialized contents of an IdCompressor, suitable for persistence in a summary.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#serializedidcompressorwithongoingsession-typealias'>SerializedIdCompressorWithOngoingSession</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        The serialized contents of an IdCompressor, suitable for persistence in a summary.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#sessionid-typealias'>SessionId</a>
      </td>
      <td>
      </td>
      <td>
        A StableId which is suitable for use as a session identifier
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#sessionspacecompressedid-typealias'>SessionSpaceCompressedId</a>
      </td>
      <td>
      </td>
      <td>
        A compressed ID that has been normalized into &quot;session space&quot; (see <code>IdCompressor</code> for more). Consumer-facing APIs and data structures should use session-space IDs as their lifetime and equality is stable and tied to the scope of the session (i.e. compressor) that produced them.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#stableid-typealias'>StableId</a>
      </td>
      <td>
      </td>
      <td>
        A version 4, variant 1 uuid (https://datatracker.ietf.org/doc/html/rfc4122). A 128-bit Universally Unique IDentifier. Represented here with a string of the form xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx, where x is a lowercase hex digit.
      </td>
    </tr>
  </tbody>
</table>

## Functions

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Function
      </th>
      <th>
        Alerts
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#createidcompressor-function'>createIdCompressor(logger)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a> &amp; <a href='/docs/apis/id-compressor/iidcompressorcore-interface'>IIdCompressorCore</a></span>
      </td>
      <td>
        Create a new <a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#createidcompressor_1-function'>createIdCompressor(sessionId, logger)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a> &amp; <a href='/docs/apis/id-compressor/iidcompressorcore-interface'>IIdCompressorCore</a></span>
      </td>
      <td>
        Create a new <a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#createsessionid-function'>createSessionId()</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor#sessionid-typealias'>SessionId</a></span>
      </td>
      <td>
        Generate a random session ID
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#deserializeidcompressor-function'>deserializeIdCompressor(serialized)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a> &amp; <a href='/docs/apis/id-compressor/iidcompressorcore-interface'>IIdCompressorCore</a></span>
      </td>
      <td>
        Deserializes the supplied state into an ID compressor.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/id-compressor#deserializeidcompressor_1-function'>deserializeIdCompressor(serialized, newSessionId)</a>
      </td>
      <td>
        <code>ALPHA</code>
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor/iidcompressor-interface'>IIdCompressor</a> &amp; <a href='/docs/apis/id-compressor/iidcompressorcore-interface'>IIdCompressorCore</a></span>
      </td>
      <td>
        Deserializes the supplied state into an ID compressor.
      </td>
    </tr>
  </tbody>
</table>

## Type Details

### OpSpaceCompressedId {#opspacecompressedid-typealias}

A compressed ID that has been normalized into "op space". Serialized/persisted structures (e.g. ops) should use op-space IDs as a performance optimization, as they require less normalizing when received by a remote client due to the fact that op space for a given compressor is session space for all other compressors.

#### Signature {#opspacecompressedid-signature}

```typescript
export type OpSpaceCompressedId = number & {
    readonly OpNormalized: "9209432d-a959-4df7-b2ad-767ead4dbcae";
};
```

### SerializedIdCompressor (ALPHA) {#serializedidcompressor-typealias}

The serialized contents of an IdCompressor, suitable for persistence in a summary.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#serializedidcompressor-signature}

```typescript
export type SerializedIdCompressor = string & {
    readonly _serializedIdCompressor: "8c73c57c-1cf4-4278-8915-6444cb4f6af5";
};
```

### SerializedIdCompressorWithNoSession (ALPHA) {#serializedidcompressorwithnosession-typealias}

The serialized contents of an IdCompressor, suitable for persistence in a summary.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#serializedidcompressorwithnosession-signature}

```typescript
export type SerializedIdCompressorWithNoSession = SerializedIdCompressor & {
    readonly _noLocalState: "3aa2e1e8-cc28-4ea7-bc1a-a11dc3f26dfb";
};
```

### SerializedIdCompressorWithOngoingSession (ALPHA) {#serializedidcompressorwithongoingsession-typealias}

The serialized contents of an IdCompressor, suitable for persistence in a summary.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#serializedidcompressorwithongoingsession-signature}

```typescript
export type SerializedIdCompressorWithOngoingSession = SerializedIdCompressor & {
    readonly _hasLocalState: "1281acae-6d14-47e7-bc92-71c8ee0819cb";
};
```

### SessionId {#sessionid-typealias}

A StableId which is suitable for use as a session identifier

#### Signature {#sessionid-signature}

```typescript
export type SessionId = StableId & {
    readonly SessionId: "4498f850-e14e-4be9-8db0-89ec00997e58";
};
```

### SessionSpaceCompressedId {#sessionspacecompressedid-typealias}

A compressed ID that has been normalized into "session space" (see `IdCompressor` for more). Consumer-facing APIs and data structures should use session-space IDs as their lifetime and equality is stable and tied to the scope of the session (i.e. compressor) that produced them.

#### Signature {#sessionspacecompressedid-signature}

```typescript
export type SessionSpaceCompressedId = number & {
    readonly SessionUnique: "cea55054-6b82-4cbf-ad19-1fa645ea3b3e";
};
```

### StableId {#stableid-typealias}

A version 4, variant 1 uuid (https://datatracker.ietf.org/doc/html/rfc4122). A 128-bit Universally Unique IDentifier. Represented here with a string of the form xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx, where x is a lowercase hex digit.

#### Signature {#stableid-signature}

```typescript
export type StableId = string & {
    readonly StableId: "53172b0d-a3d5-41ea-bd75-b43839c97f5a";
};
```

## Function Details

### createIdCompressor (ALPHA) {#createidcompressor-function}

Create a new [IIdCompressor](/docs/apis/id-compressor/iidcompressor-interface).

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#createidcompressor-signature}

```typescript
export declare function createIdCompressor(logger?: ITelemetryBaseLogger): IIdCompressor & IIdCompressorCore;
```

#### Parameters {#createidcompressor-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/core-interfaces/itelemetrybaselogger-interface'>ITelemetryBaseLogger</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createidcompressor-returns}

**Return type:** [IIdCompressor](/docs/apis/id-compressor/iidcompressor-interface) &amp; [IIdCompressorCore](/docs/apis/id-compressor/iidcompressorcore-interface)

### createIdCompressor (ALPHA) {#createidcompressor_1-function}

Create a new [IIdCompressor](/docs/apis/id-compressor/iidcompressor-interface).

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#createidcompressor_1-signature}

```typescript
export declare function createIdCompressor(sessionId: SessionId, logger?: ITelemetryBaseLogger): IIdCompressor & IIdCompressorCore;
```

#### Parameters {#createidcompressor_1-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        sessionId
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor#sessionid-typealias'>SessionId</a></span>
      </td>
      <td>
        The seed ID for the compressor.
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/core-interfaces/itelemetrybaselogger-interface'>ITelemetryBaseLogger</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#createidcompressor_1-returns}

**Return type:** [IIdCompressor](/docs/apis/id-compressor/iidcompressor-interface) &amp; [IIdCompressorCore](/docs/apis/id-compressor/iidcompressorcore-interface)

### createSessionId (ALPHA) {#createsessionid-function}

Generate a random session ID

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#createsessionid-signature}

```typescript
export declare function createSessionId(): SessionId;
```

#### Returns {#createsessionid-returns}

**Return type:** [SessionId](/docs/apis/id-compressor#sessionid-typealias)

### deserializeIdCompressor (ALPHA) {#deserializeidcompressor-function}

Deserializes the supplied state into an ID compressor.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#deserializeidcompressor-signature}

```typescript
export declare function deserializeIdCompressor(serialized: SerializedIdCompressorWithOngoingSession): IIdCompressor & IIdCompressorCore;
```

#### Parameters {#deserializeidcompressor-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        serialized
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor#serializedidcompressorwithongoingsession-typealias'>SerializedIdCompressorWithOngoingSession</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#deserializeidcompressor-returns}

**Return type:** [IIdCompressor](/docs/apis/id-compressor/iidcompressor-interface) &amp; [IIdCompressorCore](/docs/apis/id-compressor/iidcompressorcore-interface)

### deserializeIdCompressor (ALPHA) {#deserializeidcompressor_1-function}

Deserializes the supplied state into an ID compressor.

WARNING: This API is provided as an alpha preview and may change without notice. Use at your own risk.

#### Signature {#deserializeidcompressor_1-signature}

```typescript
export declare function deserializeIdCompressor(serialized: SerializedIdCompressorWithNoSession, newSessionId: SessionId): IIdCompressor & IIdCompressorCore;
```

#### Parameters {#deserializeidcompressor_1-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        serialized
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor#serializedidcompressorwithnosession-typealias'>SerializedIdCompressorWithNoSession</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        newSessionId
      </td>
      <td>
        <span><a href='/docs/apis/id-compressor#sessionid-typealias'>SessionId</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#deserializeidcompressor_1-returns}

**Return type:** [IIdCompressor](/docs/apis/id-compressor/iidcompressor-interface) &amp; [IIdCompressorCore](/docs/apis/id-compressor/iidcompressorcore-interface)
