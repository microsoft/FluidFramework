{
  "title": "SharedString Class",
  "summary": "The Shared String is a specialized data structure for handling collaborative text. It is based on a more general Sequence data structure but has additional features that make working with text easier.\n\nIn addition to text, a Shared String can also contain markers. Markers can be used to store metadata at positions within the text, like the details of an image or Fluid object that should be rendered with the text.",
  "kind": "Class",
  "members": {
    "Constructor": {
      "(constructor)": "/docs/apis/sequence/sharedstring-class#_constructor_-constructor"
    },
    "Method": {
      "annotateMarker": "/docs/apis/sequence/sharedstring-class#annotatemarker-method",
      "annotateMarkerNotifyConsensus": "/docs/apis/sequence/sharedstring-class#annotatemarkernotifyconsensus-method",
      "create": "/docs/apis/sequence/sharedstring-class#create-method",
      "findTile": "/docs/apis/sequence/sharedstring-class#findtile-method",
      "getFactory": "/docs/apis/sequence/sharedstring-class#getfactory-method",
      "getMarkerFromId": "/docs/apis/sequence/sharedstring-class#getmarkerfromid-method",
      "getText": "/docs/apis/sequence/sharedstring-class#gettext-method",
      "getTextRangeWithMarkers": "/docs/apis/sequence/sharedstring-class#gettextrangewithmarkers-method",
      "getTextWithPlaceholders": "/docs/apis/sequence/sharedstring-class#gettextwithplaceholders-method",
      "insertMarker": "/docs/apis/sequence/sharedstring-class#insertmarker-method",
      "insertMarkerRelative": "/docs/apis/sequence/sharedstring-class#insertmarkerrelative-method",
      "insertText": "/docs/apis/sequence/sharedstring-class#inserttext-method",
      "insertTextRelative": "/docs/apis/sequence/sharedstring-class#inserttextrelative-method",
      "removeText": "/docs/apis/sequence/sharedstring-class#removetext-method",
      "replaceText": "/docs/apis/sequence/sharedstring-class#replacetext-method",
      "rollback": "/docs/apis/sequence/sharedstring-class#rollback-method"
    },
    "Property": {
      "id": "/docs/apis/sequence/sharedstring-class#id-property",
      "ISharedString": "/docs/apis/sequence/sharedstring-class#isharedstring-property"
    }
  },
  "package": "@fluidframework/sequence",
  "unscopedPackageName": "sequence"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/sequence](/docs/apis/sequence) &gt; [SharedString](/docs/apis/sequence/sharedstring-class)

The Shared String is a specialized data structure for handling collaborative text. It is based on a more general Sequence data structure but has additional features that make working with text easier.

In addition to text, a Shared String can also contain markers. Markers can be used to store metadata at positions within the text, like the details of an image or Fluid object that should be rendered with the text.

## Signature {#sharedstring-signature}

```typescript
export declare class SharedString extends SharedSegmentSequence<SharedStringSegment> implements ISharedString
```

**Extends:** [SharedSegmentSequence](/docs/apis/sequence/sharedsegmentsequence-class)&lt;[SharedStringSegment](/docs/apis/sequence#sharedstringsegment-typealias)&gt;

**Implements:** [ISharedString](/docs/apis/sequence/isharedstring-interface)

## Constructors

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Constructor
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#_constructor_-constructor'>(constructor)</a>
      </td>
      <td>
        Constructs a new instance of the <code>SharedString</code> class
      </td>
    </tr>
  </tbody>
</table>

## Static Methods

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Method
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#create-method'>create</a>
      </td>
      <td>
        <span><a href='/docs/apis/sequence/sharedstring-class'>SharedString</a></span>
      </td>
      <td>
        Create a new shared string.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#getfactory-method'>getFactory</a>
      </td>
      <td>
        <span><a href='/docs/apis/sequence/sharedstringfactory-class'>SharedStringFactory</a></span>
      </td>
      <td>
        Get a factory for SharedString to register with the data store.
      </td>
    </tr>
  </tbody>
</table>

## Properties

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Property
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#id-property'>id</a>
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#isharedstring-property'>ISharedString</a>
      </td>
      <td>
        <code>readonly</code>
      </td>
      <td>
        <span><a href='/docs/apis/sequence/isharedstring-interface'>ISharedString</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Method
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#annotatemarker-method'>annotateMarker</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Annotates the marker with the provided properties.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#annotatemarkernotifyconsensus-method'>annotateMarkerNotifyConsensus</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Annotates the marker with the provided properties and calls the callback on consensus.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#findtile-method'>findTile</a>
      </td>
      <td>
        <span>{         tile: <a href='/docs/apis/merge-tree/referenceposition-interface'>ReferencePosition</a>;         pos: number;     } &#124; undefined</span>
      </td>
      <td>
        Finds the nearest reference with ReferenceType.Tile to <code>startPos</code> in the direction dictated by <code>tilePrecedesPos</code>. Note that Markers receive <code>ReferenceType.Tile</code> by default.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#getmarkerfromid-method'>getMarkerFromId</a>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/isegment-interface'>ISegment</a> &#124; undefined</span>
      </td>
      <td>
        Looks up and returns a <code>Marker</code> using its id. Returns <code>undefined</code> if there is no marker with the provided id in this <code>SharedString</code>.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#gettext-method'>getText</a>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        Retrieve text from the SharedString in string format.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#gettextrangewithmarkers-method'>getTextRangeWithMarkers</a>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#gettextwithplaceholders-method'>getTextWithPlaceholders</a>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        Adds spaces for markers and handles, so that position calculations account for them.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#insertmarker-method'>insertMarker</a>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeinsertmsg-interface'>IMergeTreeInsertMsg</a> &#124; undefined</span>
      </td>
      <td>
        Inserts a marker at the position.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#insertmarkerrelative-method'>insertMarkerRelative</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Inserts a marker at a relative position.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#inserttext-method'>insertText</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Inserts the text at the position.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#inserttextrelative-method'>insertTextRelative</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Inserts the text at the position.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#removetext-method'>removeText</a>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/imergetreeremovemsg-interface'>IMergeTreeRemoveMsg</a></span>
      </td>
      <td>
        Removes the text in the given range.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#replacetext-method'>replaceText</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Replaces a range with the provided text.
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/sequence/sharedstring-class#rollback-method'>rollback</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
        Revert an op
      </td>
    </tr>
  </tbody>
</table>

## Constructor Details

### (constructor) {#_constructor_-constructor}

Constructs a new instance of the `SharedString` class

#### Signature {#_constructor_-signature}

```typescript
constructor(document: IFluidDataStoreRuntime, id: string, attributes: IChannelAttributes);
```

#### Parameters {#_constructor_-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        document
      </td>
      <td>
        <span><a href='/docs/apis/datastore-definitions/ifluiddatastoreruntime-interface'>IFluidDataStoreRuntime</a></span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        id
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        attributes
      </td>
      <td>
        <span><a href='/docs/apis/datastore-definitions/ichannelattributes-interface'>IChannelAttributes</a></span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Property Details

### id {#id-property}

#### Signature {#id-signature}

```typescript
id: string;
```

### ISharedString {#isharedstring-property}

#### Signature {#isharedstring-signature}

```typescript
get ISharedString(): ISharedString;
```

## Method Details

### annotateMarker {#annotatemarker-method}

Annotates the marker with the provided properties.

#### Signature {#annotatemarker-signature}

```typescript
annotateMarker(marker: Marker, props: PropertySet, combiningOp?: ICombiningOp): void;
```

#### Parameters {#annotatemarker-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        marker
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/marker-class'>Marker</a></span>
      </td>
      <td>
        The marker to annotate
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties to annotate the marker with
      </td>
    </tr>
    <tr>
      <td>
        combiningOp
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/icombiningop-interface'>ICombiningOp</a></span>
      </td>
      <td>
        Optional. Specifies how to combine values for the property, such as &quot;incr&quot; for increment.
      </td>
    </tr>
  </tbody>
</table>

### annotateMarkerNotifyConsensus {#annotatemarkernotifyconsensus-method}

Annotates the marker with the provided properties and calls the callback on consensus.

#### Signature {#annotatemarkernotifyconsensus-signature}

```typescript
annotateMarkerNotifyConsensus(marker: Marker, props: PropertySet, callback: (m: Marker) => void): void;
```

#### Parameters {#annotatemarkernotifyconsensus-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        marker
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/marker-class'>Marker</a></span>
      </td>
      <td>
        The marker to annotate
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties to annotate the marker with
      </td>
    </tr>
    <tr>
      <td>
        callback
      </td>
      <td>
        <span>(m: <a href='/docs/apis/merge-tree/marker-class'>Marker</a>) =&gt; void</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### create {#create-method}

Create a new shared string.

#### Signature {#create-signature}

```typescript
static create(runtime: IFluidDataStoreRuntime, id?: string): SharedString;
```

#### Parameters {#create-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        runtime
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/datastore-definitions/ifluiddatastoreruntime-interface'>IFluidDataStoreRuntime</a></span>
      </td>
      <td>
        data store runtime the new shared string belongs to
      </td>
    </tr>
    <tr>
      <td>
        id
      </td>
      <td>
        optional
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        optional name of the shared string
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#create-returns}

newly create shared string (but not attached yet)

**Return type:** [SharedString](/docs/apis/sequence/sharedstring-class)

### findTile {#findtile-method}

Finds the nearest reference with ReferenceType.Tile to `startPos` in the direction dictated by `tilePrecedesPos`. Note that Markers receive `ReferenceType.Tile` by default.

#### Signature {#findtile-signature}

```typescript
findTile(startPos: number | undefined, tileLabel: string, preceding?: boolean): {
        tile: ReferencePosition;
        pos: number;
    } | undefined;
```

#### Parameters {#findtile-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        startPos
      </td>
      <td>
      </td>
      <td>
        <span>number &#124; undefined</span>
      </td>
      <td>
        Position at which to start the search
      </td>
    </tr>
    <tr>
      <td>
        tileLabel
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        Label of the tile to search for
      </td>
    </tr>
    <tr>
      <td>
        preceding
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
        Whether the desired tile comes before (true) or after (false) <code>startPos</code>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#findtile-returns}

**Return type:** {         tile: [ReferencePosition](/docs/apis/merge-tree/referenceposition-interface);         pos: number;     } \| undefined

### getFactory {#getfactory-method}

Get a factory for SharedString to register with the data store.

#### Signature {#getfactory-signature}

```typescript
static getFactory(): SharedStringFactory;
```

#### Returns {#getfactory-returns}

a factory that creates and load SharedString

**Return type:** [SharedStringFactory](/docs/apis/sequence/sharedstringfactory-class)

### getMarkerFromId {#getmarkerfromid-method}

Looks up and returns a `Marker` using its id. Returns `undefined` if there is no marker with the provided id in this `SharedString`.

#### Signature {#getmarkerfromid-signature}

```typescript
getMarkerFromId(id: string): ISegment | undefined;
```

#### Parameters {#getmarkerfromid-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        id
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#getmarkerfromid-returns}

**Return type:** [ISegment](/docs/apis/merge-tree/isegment-interface) \| undefined

### getText {#gettext-method}

Retrieve text from the SharedString in string format.

#### Signature {#gettext-signature}

```typescript
getText(start?: number, end?: number): string;
```

#### Parameters {#gettext-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The starting index of the text to retrieve, or 0 if omitted.
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The ending index of the text to retrieve, or the end of the string if omitted
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#gettext-returns}

The requested text content as a string.

**Return type:** string

### getTextRangeWithMarkers {#gettextrangewithmarkers-method}

#### Signature {#gettextrangewithmarkers-signature}

```typescript
getTextRangeWithMarkers(start: number, end: number): string;
```

#### Parameters {#gettextrangewithmarkers-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#gettextrangewithmarkers-returns}

**Return type:** string

### getTextWithPlaceholders {#gettextwithplaceholders-method}

Adds spaces for markers and handles, so that position calculations account for them.

#### Signature {#gettextwithplaceholders-signature}

```typescript
getTextWithPlaceholders(start?: number, end?: number): string;
```

#### Parameters {#gettextwithplaceholders-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        optional
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#gettextwithplaceholders-returns}

**Return type:** string

### insertMarker {#insertmarker-method}

Inserts a marker at the position.

#### Signature {#insertmarker-signature}

```typescript
insertMarker(pos: number, refType: ReferenceType, props?: PropertySet): IMergeTreeInsertMsg | undefined;
```

#### Parameters {#insertmarker-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The position to insert the marker at
      </td>
    </tr>
    <tr>
      <td>
        refType
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#referencetype-enum'>ReferenceType</a></span>
      </td>
      <td>
        The reference type of the marker
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties of the marker
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#insertmarker-returns}

**Return type:** [IMergeTreeInsertMsg](/docs/apis/merge-tree/imergetreeinsertmsg-interface) \| undefined

### insertMarkerRelative {#insertmarkerrelative-method}

Inserts a marker at a relative position.

#### Signature {#insertmarkerrelative-signature}

```typescript
insertMarkerRelative(relativePos1: IRelativePosition, refType: ReferenceType, props?: PropertySet): void;
```

#### Parameters {#insertmarkerrelative-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        relativePos1
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/irelativeposition-interface'>IRelativePosition</a></span>
      </td>
      <td>
        The relative position to insert the marker at
      </td>
    </tr>
    <tr>
      <td>
        refType
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#referencetype-enum'>ReferenceType</a></span>
      </td>
      <td>
        The reference type of the marker
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties of the marker
      </td>
    </tr>
  </tbody>
</table>

### insertText {#inserttext-method}

Inserts the text at the position.

#### Signature {#inserttext-signature}

```typescript
insertText(pos: number, text: string, props?: PropertySet): void;
```

#### Parameters {#inserttext-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        pos
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The position to insert the text at
      </td>
    </tr>
    <tr>
      <td>
        text
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        The text to insert
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties of the text
      </td>
    </tr>
  </tbody>
</table>

### insertTextRelative {#inserttextrelative-method}

Inserts the text at the position.

#### Signature {#inserttextrelative-signature}

```typescript
insertTextRelative(relativePos1: IRelativePosition, text: string, props?: PropertySet): void;
```

#### Parameters {#inserttextrelative-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        relativePos1
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree/irelativeposition-interface'>IRelativePosition</a></span>
      </td>
      <td>
        The relative position to insert the text at
      </td>
    </tr>
    <tr>
      <td>
        text
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        The text to insert
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        The properties of text
      </td>
    </tr>
  </tbody>
</table>

### removeText {#removetext-method}

Removes the text in the given range.

#### Signature {#removetext-signature}

```typescript
removeText(start: number, end: number): IMergeTreeRemoveMsg;
```

#### Parameters {#removetext-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The inclusive start of the range to remove
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The exclusive end of the range to replace
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#removetext-returns}

the message sent.

**Return type:** [IMergeTreeRemoveMsg](/docs/apis/merge-tree/imergetreeremovemsg-interface)

### replaceText {#replacetext-method}

Replaces a range with the provided text.

#### Signature {#replacetext-signature}

```typescript
replaceText(start: number, end: number, text: string, props?: PropertySet): void;
```

#### Parameters {#replacetext-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        start
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The inclusive start of the range to replace
      </td>
    </tr>
    <tr>
      <td>
        end
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        The exclusive end of the range to replace
      </td>
    </tr>
    <tr>
      <td>
        text
      </td>
      <td>
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        The text to replace the range with
      </td>
    </tr>
    <tr>
      <td>
        props
      </td>
      <td>
        optional
      </td>
      <td>
        <span><a href='/docs/apis/merge-tree#propertyset-typealias'>PropertySet</a></span>
      </td>
      <td>
        Optional. The properties of the replacement text
      </td>
    </tr>
  </tbody>
</table>

### rollback {#rollback-method}

Revert an op

#### Signature {#rollback-signature}

```typescript
protected rollback(content: any, localOpMetadata: unknown): void;
```

#### Parameters {#rollback-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        content
      </td>
      <td>
        <span>any</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        localOpMetadata
      </td>
      <td>
        <span>unknown</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>
