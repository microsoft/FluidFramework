{
  "title": "SampledTelemetryHelper Class",
  "summary": "Helper class that executes a specified code block and writes an _@fluidframework/core-interfaces\\#ITelemetryPerformanceEvent_ to a specified logger every time a specified number of executions is reached (or when the class is disposed). The `duration` field in the telemetry event is the duration of the latest execution (sample) of the specified function. See the documentation of the `includeAggregateMetrics` parameter for additional details that can be included.",
  "kind": "Class",
  "members": {
    "Constructor": {
      "(constructor)": "/docs/apis/telemetry-utils/sampledtelemetryhelper-class#_constructor_-constructor"
    },
    "Method": {
      "dispose": "/docs/apis/telemetry-utils/sampledtelemetryhelper-class#dispose-method",
      "measure": "/docs/apis/telemetry-utils/sampledtelemetryhelper-class#measure-method"
    },
    "Property": {
      "disposed": "/docs/apis/telemetry-utils/sampledtelemetryhelper-class#disposed-property"
    }
  },
  "package": "@fluidframework/telemetry-utils",
  "unscopedPackageName": "telemetry-utils"
}

[//]: # (Do not edit this file. It is automatically generated by @fluidtools/api-markdown-documenter.)

[Packages](/docs/apis/) &gt; [@fluidframework/telemetry-utils](/docs/apis/telemetry-utils) &gt; [SampledTelemetryHelper](/docs/apis/telemetry-utils/sampledtelemetryhelper-class)

Helper class that executes a specified code block and writes an _@fluidframework/core-interfaces\#ITelemetryPerformanceEvent_ to a specified logger every time a specified number of executions is reached (or when the class is disposed). The `duration` field in the telemetry event is the duration of the latest execution (sample) of the specified function. See the documentation of the `includeAggregateMetrics` parameter for additional details that can be included.

## Signature {#sampledtelemetryhelper-signature}

```typescript
export declare class SampledTelemetryHelper implements IDisposable
```

**Implements:** IDisposable

## Constructors

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Constructor
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/telemetry-utils/sampledtelemetryhelper-class#_constructor_-constructor'>(constructor)</a>
      </td>
      <td>
        Constructs a new instance of the <code>SampledTelemetryHelper</code> class
      </td>
    </tr>
  </tbody>
</table>

## Properties

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Property
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/telemetry-utils/sampledtelemetryhelper-class#disposed-property'>disposed</a>
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Methods

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Method
      </th>
      <th>
        Return Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href='/docs/apis/telemetry-utils/sampledtelemetryhelper-class#dispose-method'>dispose</a>
      </td>
      <td>
        <span>void</span>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        <a href='/docs/apis/telemetry-utils/sampledtelemetryhelper-class#measure-method'>measure</a>
      </td>
      <td>
        <span>T</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

## Constructor Details

### (constructor) {#_constructor_-constructor}

Constructs a new instance of the `SampledTelemetryHelper` class

#### Signature {#_constructor_-signature}

```typescript
constructor(eventBase: ITelemetryGenericEvent, logger: ITelemetryLoggerExt, sampleThreshold: number, includeAggregateMetrics?: boolean, perBucketProperties?: Map<string, ITelemetryProperties>);
```

#### Parameters {#_constructor_-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        eventBase
      </td>
      <td>
      </td>
      <td>
        <span>ITelemetryGenericEvent</span>
      </td>
      <td>
        Custom properties to include in the telemetry performance event when it is written.
      </td>
    </tr>
    <tr>
      <td>
        logger
      </td>
      <td>
      </td>
      <td>
        <span><a href='/docs/apis/telemetry-utils/itelemetryloggerext-interface'>ITelemetryLoggerExt</a></span>
      </td>
      <td>
        The logger to use to write the telemetry performance event.
      </td>
    </tr>
    <tr>
      <td>
        sampleThreshold
      </td>
      <td>
      </td>
      <td>
        <span>number</span>
      </td>
      <td>
        Telemetry performance events will be generated every time we hit this many executions of the code block.
      </td>
    </tr>
    <tr>
      <td>
        includeAggregateMetrics
      </td>
      <td>
        optional
      </td>
      <td>
        <span>boolean</span>
      </td>
      <td>
        If set to <code>true</code>, the telemetry performance event will include aggregated metrics (total duration, min duration, max duration) for all the executions in between generated events.
      </td>
    </tr>
    <tr>
      <td>
        perBucketProperties
      </td>
      <td>
        optional
      </td>
      <td>
        <span>Map&lt;string, ITelemetryProperties&gt;</span>
      </td>
      <td>
        Map of strings that represent different buckets (which can be specified when calling the 'measure' method), to properties which should be added to the telemetry event for that bucket. If a bucket being measured does not have an entry in this map, no additional properties will be added to its telemetry events. The following keys are reserved for use by this class: &quot;duration&quot;, &quot;count&quot;, &quot;totalDuration&quot;, &quot;minDuration&quot;, &quot;maxDuration&quot;. If any of them is specified as a key in one of the ITelemetryProperties objects in this map, that key-value pair will be ignored.
      </td>
    </tr>
  </tbody>
</table>

## Property Details

### disposed {#disposed-property}

#### Signature {#disposed-signature}

```typescript
disposed: boolean;
```

## Method Details

### dispose {#dispose-method}

#### Signature {#dispose-signature}

```typescript
dispose(error?: Error | undefined): void;
```

#### Parameters {#dispose-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        error
      </td>
      <td>
        optional
      </td>
      <td>
        <span>Error &#124; undefined</span>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

### measure {#measure-method}

#### Signature {#measure-signature}

```typescript
measure<T>(codeToMeasure: () => T, bucket?: string): T;
```

#### Parameters {#measure-parameters}

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>
        Parameter
      </th>
      <th>
        Modifiers
      </th>
      <th>
        Type
      </th>
      <th>
        Description
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        codeToMeasure
      </td>
      <td>
      </td>
      <td>
        <span>() =&gt; T</span>
      </td>
      <td>
        The code to be executed and measured.
      </td>
    </tr>
    <tr>
      <td>
        bucket
      </td>
      <td>
        optional
      </td>
      <td>
        <span>string</span>
      </td>
      <td>
        A key to track executions of the code block separately. Each different value of this parameter has a separate set of executions and metrics tracked by the class. If no such distinction needs to be made, do not provide a value.
      </td>
    </tr>
  </tbody>
</table>

#### Returns {#measure-returns}

Whatever the passed-in code block returns.

**Return type:** T
